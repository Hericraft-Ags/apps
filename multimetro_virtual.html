<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Multímetro - Aprende Electrónica</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
            font-size: 3.2rem;
            font-weight: 800;
            margin-bottom: 15px;
            text-shadow: 3px 3px 8px rgba(0,0,0,0.4);
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
        }

        .header h1::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(3px 3px 8px rgba(0,0,0,0.4));
        }

        .header p {
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
            font-size: 1.3rem;
            font-weight: 400;
            opacity: 0.95;
            line-height: 1.5;
            max-width: 800px;
            margin: 0 auto;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        .instructions {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            color: white;
            backdrop-filter: blur(10px);
        }

        .step {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }

        .step-number {
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .step.completed .step-number {
            background: #27ae60;
        }

        .step.active .step-number {
            background: #e74c3c;
            animation: pulse 1s infinite;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .multimeter-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .multimeter {
            width: 100%;
            max-width: 420px;
            margin: 0 auto;
            background: linear-gradient(145deg, #34495e, #2c3e50);
            border-radius: 20px;
            padding: 25px;
            position: relative;
            box-shadow: 
                inset 0 2px 4px rgba(255,255,255,0.1),
                inset 0 -2px 4px rgba(0,0,0,0.3),
                0 8px 20px rgba(0,0,0,0.4);
            border: 2px solid #4a5568;
        }

        .multimeter::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            pointer-events: none;
        }

        .multimeter-brand {
            text-align: center;
            color: #ecf0f1;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        .display-section {
            background: linear-gradient(145deg, #1a1a1a, #000);
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 20px;
            border: 2px solid #333;
            box-shadow: 
                inset 0 2px 4px rgba(0,0,0,0.8),
                0 2px 4px rgba(255,255,255,0.1);
        }

        .display {
            background: #000;
            color: #00ff41;
            font-family: 'Courier New', monospace;
            font-size: 2.2rem;
            text-align: right;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid #333;
            text-shadow: 0 0 8px #00ff41;
            position: relative;
        }

        .display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, rgba(0,255,65,0.1) 0%, transparent 50%);
            border-radius: 8px;
            pointer-events: none;
        }

        .display-indicators {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #666;
            font-size: 10px;
            padding: 0 5px;
        }

        .unit-display {
            color: #00ff41;
            font-weight: bold;
            font-size: 12px;
        }

        .selector-area {
            position: relative;
            margin-top: 15%;
            margin-bottom: 15%;
        }

        .selector {
            width: 140px;
            height: 140px;
            background: radial-gradient(circle, #4a5568 0%, #2d3748 70%);
            border-radius: 50%;
            margin: 0 auto;
            position: relative;
            cursor: pointer;
            border: 4px solid #1a202c;
            box-shadow: 
                inset 0 2px 4px rgba(255,255,255,0.1),
                inset 0 -2px 8px rgba(0,0,0,0.5),
                0 4px 8px rgba(0,0,0,0.3);
        }

        .selector::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #2d3748, #1a202c);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid #4a5568;
        }

        .selector-pointer {
            width: 3px;
            height: 55px;
            background: linear-gradient(180deg, #e53e3e, #c53030);
            position: absolute;
            top: 15px;
            left: 50%;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(0deg);
            transition: transform 0.3s ease;
            border-radius: 2px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        .selector-labels {
            position: absolute;
            width: 220px;
            height: 220px;
            top: -40px;
            left: -40px;
        }

        .label {
            position: absolute;
            color: #ecf0f1;
            font-size: 11px;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0,0,0,0.8);
            background: rgba(0,0,0,0.3);
            padding: 2px 4px;
            border-radius: 3px;
        }

        .function-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 20px 0;
        }

        .function-btn {
            background: linear-gradient(145deg, #4a5568, #2d3748);
            border: 1px solid #1a202c;
            border-radius: 6px;
            color: #ecf0f1;
            font-size: 10px;
            font-weight: bold;
            padding: 8px 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-shadow: 0 1px 2px rgba(0,0,0,0.8);
        }

        .function-btn:hover {
            background: linear-gradient(145deg, #5a6578, #3d4758);
            transform: translateY(-1px);
        }

        .function-btn:active {
            transform: translateY(0);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
        }

        .ports-section {
            background: linear-gradient(145deg, #2d3748, #1a202c);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            border: 1px solid #4a5568;
        }

        .ports-label {
            color: #a0aec0;
            font-size: 10px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ports {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .port-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .port {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 3px solid #1a202c;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 
                inset 0 2px 4px rgba(0,0,0,0.5),
                0 2px 4px rgba(255,255,255,0.1);
        }

        .port.com { 
            background: radial-gradient(circle, #2d3748, #000);
        }
        .port.v { 
            background: radial-gradient(circle, #e53e3e, #c53030);
        }
        .port.a { 
            background: radial-gradient(circle, #ed8936, #dd6b20);
        }

        .port.connected {
            box-shadow: 
                0 0 15px currentColor,
                inset 0 2px 4px rgba(0,0,0,0.5);
            transform: scale(1.1);
        }

        .port-label {
            color: #a0aec0;
            font-size: 9px;
            font-weight: bold;
            text-align: center;
        }

        .probes-section {
            margin-top: 20px;
        }

        .probes-label {
            color: #a0aec0;
            font-size: 10px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .probes {
            display: flex;
            justify-content: center;
            gap: 25px;
        }

        .probe {
            width: 80px;
            height: 25px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0,0,0,0.8);
            border: 2px solid rgba(255,255,255,0.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .probe.red { 
            background: linear-gradient(145deg, #e53e3e, #c53030);
            color: white;
        }
        .probe.black { 
            background: linear-gradient(145deg, #2d3748, #1a202c);
            color: #ecf0f1;
        }

        .probe::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 50%;
            width: 6px;
            height: 6px;
            background: #718096;
            border-radius: 50%;
            transform: translateY(-50%);
            border: 1px solid #4a5568;
        }

        .probe:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .control-panel {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .exercise-section {
            margin-bottom: 30px;
        }

        .exercise-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .circuit {
            background: #ecf0f1;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
            position: relative;
            min-height: 250px;
            overflow: hidden;
        }

        .circuit svg {
            display: block;
            margin: 0 auto;
            max-width: 100%;
            height: auto;
        }

        .component {
            display: inline-block;
            margin: 10px;
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .battery { background: #f39c12; color: white; }
        .resistor { background: #e67e22; color: white; }
        .led { background: #e74c3c; color: white; }
        .capacitor { background: #9b59b6; color: white; }

        .component:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .connection-panel {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 2px solid #e9ecef;
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        }

        .connection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .connection-header h4 {
            color: #2c3e50;
            margin: 0;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .connection-status-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #f8f9fa;
            padding: 8px 16px;
            border-radius: 25px;
            border: 2px solid #dee2e6;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #6c757d;
            animation: pulse-dot 2s infinite;
        }

        .connection-status-badge.connected .status-dot {
            background: #28a745;
        }

        .connection-status-badge.partial .status-dot {
            background: #ffc107;
        }

        .probe-status-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            margin-bottom: 30px;
        }

        .probe-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .probe-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, #dee2e6, transparent);
        }

        .red-probe-card::before {
            background: linear-gradient(90deg, transparent, #e74c3c, transparent);
        }

        .black-probe-card::before {
            background: linear-gradient(90deg, transparent, #2c3e50, transparent);
        }

        .probe-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .probe-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .probe-icon-large {
            font-size: 2rem;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #f8f9fa;
            border: 3px solid #e9ecef;
        }

        .red-probe-card .probe-icon-large {
            background: #ffebee;
            border-color: #ffcdd2;
        }

        .black-probe-card .probe-icon-large {
            background: #f5f5f5;
            border-color: #e0e0e0;
        }

        .probe-info {
            flex: 1;
        }

        .probe-info h5 {
            margin: 0 0 5px 0;
            color: #2c3e50;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .probe-port {
            color: #6c757d;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .probe-status-icon {
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }

        .probe-status-text {
            color: #495057;
            font-size: 0.9rem;
            margin-bottom: 15px;
            min-height: 20px;
        }

        .probe-progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 3px;
        }

        .red-progress {
            background: linear-gradient(90deg, #e74c3c, #c0392b);
        }

        .black-progress {
            background: linear-gradient(90deg, #2c3e50, #1a252f);
        }

        .connection-arrow {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #6c757d;
        }

        .arrow-line {
            width: 2px;
            height: 30px;
            background: #dee2e6;
            margin-bottom: 5px;
        }

        .arrow-head {
            font-size: 1.2rem;
            color: #6c757d;
        }

        .connection-instructions-modern {
            background: linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 100%);
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #2196f3;
        }

        .instructions-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }

        .instructions-icon {
            font-size: 1.3rem;
        }

        .instructions-header h5 {
            margin: 0;
            color: #2c3e50;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .instruction-steps {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .instruction-step {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .instruction-step.active {
            border-color: #2196f3;
            background: #f0f8ff;
            transform: scale(1.02);
        }

        .instruction-step.completed {
            border-color: #28a745;
            background: #f0fff4;
        }

        .step-circle {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #6c757d;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .instruction-step.active .step-circle {
            background: #2196f3;
            animation: pulse-circle 1.5s infinite;
        }

        .instruction-step.completed .step-circle {
            background: #28a745;
        }

        .step-content {
            flex: 1;
        }

        .step-content strong {
            color: #2c3e50;
            display: block;
            margin-bottom: 3px;
            font-size: 0.95rem;
        }

        .step-content p {
            margin: 0;
            color: #495057;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .highlight-red {
            color: #e74c3c;
            font-weight: bold;
        }

        .highlight-black {
            color: #2c3e50;
            font-weight: bold;
        }

        .step-status {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .instruction-step.active .step-status {
            animation: pulse-status 1s infinite;
        }

        .instruction-step.completed .step-status::before {
            content: '✅';
        }

        .visual-guide {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(33, 150, 243, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(33, 150, 243, 0.2);
        }

        .guide-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .guide-text {
            color: #1565c0;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .guide-text strong {
            color: #0d47a1;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes pulse-circle {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes pulse-status {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* Estilos para el botón de verificación prominente */
        .btn-verify-large {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            border: none;
            border-radius: 15px;
            color: white;
            padding: 15px 60px;
            cursor: pointer;
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
            font-weight: 600;
            font-size: 1.1rem;
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 400px;
            max-width: 90%;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
        }

        .btn-verify-large::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-verify-large:hover::before {
            left: 100%;
        }

        .btn-verify-large:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(39, 174, 96, 0.4);
            background: linear-gradient(135deg, #229954 0%, #27ae60 100%);
        }

        .btn-verify-large:active {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.3);
        }

        .verify-icon {
            font-size: 1.5rem;
        }

        .verify-text {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .verify-subtitle {
            font-size: 0.85rem;
            opacity: 0.9;
            font-weight: 400;
        }

        /* Estilos para la sección de botones de ayuda */
        .help-buttons-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid #dee2e6;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .help-buttons-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .help-btn {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            text-align: left;
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
            position: relative;
            overflow: hidden;
        }

        .help-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, #dee2e6, transparent);
            transition: all 0.3s ease;
        }

        .help-btn.educational::before {
            background: linear-gradient(90deg, transparent, #9b59b6, transparent);
        }

        .help-btn.glossary::before {
            background: linear-gradient(90deg, transparent, #16a085, transparent);
        }

        .help-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #3498db;
        }

        .help-btn.educational:hover {
            border-color: #9b59b6;
            background: linear-gradient(135deg, #f8f4ff 0%, #ffffff 100%);
        }

        .help-btn.glossary:hover {
            border-color: #16a085;
            background: linear-gradient(135deg, #f0fffe 0%, #ffffff 100%);
        }

        .help-btn.multimeter-guide::before {
            background: linear-gradient(90deg, transparent, #e67e22, transparent);
        }

        .help-btn.multimeter-guide:hover {
            border-color: #e67e22;
            background: linear-gradient(135deg, #fef9f3 0%, #ffffff 100%);
        }

        .help-btn.multimeter-guide:hover .help-btn-icon {
            background: #fdeee4;
            border-color: #f39c12;
        }

        .help-btn-icon {
            font-size: 2.5rem;
            flex-shrink: 0;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 50%;
            border: 3px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .help-btn.educational:hover .help-btn-icon {
            background: #f3e5f5;
            border-color: #ce93d8;
        }

        .help-btn.glossary:hover .help-btn-icon {
            background: #e0f2f1;
            border-color: #4db6ac;
        }

        .help-btn-content {
            flex: 1;
        }

        .help-btn-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .help-btn-subtitle {
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.3;
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            text-align: center;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .feedback.show {
            opacity: 1;
        }

        .feedback.success {
            background: #d5f4e6;
            color: #27ae60;
            border: 2px solid #27ae60;
        }

        .feedback.error {
            background: #fdf2f2;
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }

        /* Estilos del Glosario y Modales */
        .glossary-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            overflow-y: auto;
        }

        .glossary-content {
            background: white;
            margin: 20px auto;
            max-width: 1200px;
            border-radius: 20px;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .glossary-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .glossary-header h2 {
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .glossary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            padding: 30px;
        }

        .component-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid #ecf0f1;
            transition: all 0.3s ease;
        }

        .component-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            border-color: #3498db;
        }

        .component-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .component-icon {
            font-size: 2rem;
            margin-right: 15px;
        }

        .component-title {
            color: #2c3e50;
            font-size: 1.3rem;
            font-weight: bold;
            margin: 0;
        }

        .component-subtitle {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin: 5px 0 0 0;
        }

        .component-visual {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .component-symbol {
            text-align: center;
        }

        .component-symbol h4 {
            color: #2c3e50;
            margin: 0 0 10px 0;
            font-size: 0.9rem;
        }

        .symbol-svg {
            width: 80px;
            height: 60px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .component-image {
            text-align: center;
        }

        .component-image h4 {
            color: #2c3e50;
            margin: 0 0 10px 0;
            font-size: 0.9rem;
        }

        .image-container {
            width: 80px;
            height: 60px;
            background: #ecf0f1;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .component-definition {
            color: #34495e;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .component-specs {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .component-specs h4 {
            color: #2c3e50;
            margin: 0 0 10px 0;
            font-size: 1rem;
        }

        .specs-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .specs-list li {
            color: #34495e;
            margin: 5px 0;
            padding-left: 15px;
            position: relative;
        }

        .specs-list li::before {
            content: '•';
            color: #3498db;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        /* Estilos específicos para el selector de ejercicios */
        .exercise-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid #ecf0f1;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .exercise-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            border-color: #3498db;
        }

        .exercise-card.completed {
            border-color: #27ae60;
            background: linear-gradient(135deg, #d5f4e6 0%, #ffffff 100%);
        }

        .exercise-card.current {
            border-color: #e74c3c;
            background: linear-gradient(135deg, #fdf2f2 0%, #ffffff 100%);
        }

        .exercise-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .exercise-number {
            background: #3498db;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .exercise-card.completed .exercise-number {
            background: #27ae60;
        }

        .exercise-card.current .exercise-number {
            background: #e74c3c;
        }

        .exercise-title {
            color: #2c3e50;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 0;
        }

        .exercise-objective {
            color: #34495e;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .exercise-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .exercise-detail {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .exercise-detail strong {
            color: #2c3e50;
        }

        .exercise-status {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
        }

        /* Estilos para puntos de medición interactivos */
        .measurement-point .point-circle {
            transition: all 0.3s ease;
        }

        .measurement-point:hover .point-circle {
            fill: #2980b9;
            stroke-width: 6;
            r: 18;
            filter: drop-shadow(0 0 10px rgba(52, 152, 219, 0.6));
        }

        .measurement-point.red-ready .point-circle {
            fill: #e74c3c;
            stroke: #c0392b;
            stroke-width: 6;
            animation: pulse-red 1s infinite;
            filter: drop-shadow(0 0 15px rgba(231, 76, 60, 0.8));
        }

        .measurement-point.black-ready .point-circle {
            fill: #2c3e50;
            stroke: #1a252f;
            stroke-width: 6;
            animation: pulse-black 1s infinite;
            filter: drop-shadow(0 0 15px rgba(44, 62, 80, 0.8));
        }

        .measurement-point.red-connected .point-circle {
            fill: #e74c3c;
            stroke: #c0392b;
            stroke-width: 8;
            filter: drop-shadow(0 0 20px rgba(231, 76, 60, 1));
        }

        .measurement-point.black-connected .point-circle {
            fill: #2c3e50;
            stroke: #1a252f;
            stroke-width: 8;
            filter: drop-shadow(0 0 20px rgba(44, 62, 80, 1));
        }

        .measurement-point.red-ready .point-text,
        .measurement-point.red-connected .point-text {
            fill: white;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
        }

        .measurement-point.black-ready .point-text,
        .measurement-point.black-connected .point-text {
            fill: white;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
        }

        @keyframes pulse-red {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes pulse-black {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes pulse {
            0% { 
                transform: scale(1); 
                text-shadow: 0 0 8px #00ff41;
            }
            50% { 
                transform: scale(1.05); 
                text-shadow: 0 0 15px #00ff41, 0 0 25px #00ff41;
            }
            100% { 
                transform: scale(1); 
                text-shadow: 0 0 8px #00ff41;
            }
        }

        .component-updating {
            animation: component-glow 0.6s ease-in-out;
        }

        @keyframes component-glow {
            0% { 
                filter: brightness(1);
                transform: scale(1);
            }
            50% { 
                filter: brightness(1.3) drop-shadow(0 0 10px rgba(52, 152, 219, 0.8));
                transform: scale(1.02);
            }
            100% { 
                filter: brightness(1);
                transform: scale(1);
            }
        }

        /* Animaciones para el modal de maestría */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-20px);
            }
            60% {
                transform: translateY(-10px);
            }
        }

        @keyframes glow {
            0% {
                box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
                transform: scale(1);
            }
            100% {
                box-shadow: 0 15px 40px rgba(255, 215, 0, 0.6);
                transform: scale(1.05);
            }
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(30px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes confetti {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes rotate {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        @keyframes twinkle {
            0%, 100% { 
                opacity: 0.5; 
                transform: translateX(-50%) scale(1); 
            }
            50% { 
                opacity: 1; 
                transform: translateX(-50%) scale(1.2); 
            }
        }

        /* Efectos de confeti mejorados */
        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            background: #FFD700;
            animation: confetti 4s linear infinite;
            z-index: 10000;
            border-radius: 50%;
        }

        .confetti:nth-child(odd) {
            background: #FF6B6B;
            animation-delay: -0.5s;
            width: 8px;
            height: 8px;
        }

        .confetti:nth-child(even) {
            background: #4ECDC4;
            animation-delay: -1s;
            width: 10px;
            height: 10px;
        }

        .confetti:nth-child(3n) {
            background: #45B7D1;
            animation-delay: -1.5s;
            width: 14px;
            height: 14px;
        }

        .confetti:nth-child(4n) {
            background: #96CEB4;
            animation-delay: -2s;
            width: 6px;
            height: 6px;
        }

        .confetti:nth-child(5n) {
            background: #FFEAA7;
            animation-delay: -2.5s;
            width: 16px;
            height: 16px;
        }

        @media (max-width: 1110px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .multimeter {
                max-width: 300px;
            }
            
            .circuit {
                padding: 15px;
                min-height: 200px;
            }

            .glossary-grid {
                grid-template-columns: 1fr;
                padding: 15px;
            }

            .component-card, .exercise-card {
                margin: 10px 0;
            }

            .exercise-details {
                grid-template-columns: 1fr;
            }

            /* Estilos móviles para botones mejorados */
            .btn-verify-large {
                width: 350px;
                max-width: 95%;
                padding: 12px 40px;
                font-size: 1rem;
            }

            .verify-icon {
                font-size: 1.3rem;
            }

            .verify-text {
                font-size: 1rem;
            }

            .verify-subtitle {
                font-size: 0.8rem;
            }

            .help-buttons-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .help-btn {
                padding: 15px;
                gap: 12px;
            }

            .help-btn-icon {
                width: 50px;
                height: 50px;
                font-size: 2rem;
            }

            .help-btn-title {
                font-size: 1rem;
            }

            .help-btn-subtitle {
                font-size: 0.85rem;
            }

            .probe-status-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .connection-arrow {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="position: absolute; top: 20px; right: 20px; z-index: 1000;">
                <button id="language-toggle" onclick="toggleLanguage()" style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); border: none; border-radius: 25px; color: white; padding: 12px 20px; font-size: 14px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3); transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 16px;">🌐</span>
                    <span id="language-text">English</span>
                </button>
            </div>
            <h1 id="main-title">⚡ Simulador de Multímetro Digital</h1>
            <p id="main-subtitle">Domina las mediciones eléctricas con nuestro laboratorio virtual interactivo. Aprende voltaje, corriente, resistencia y más con componentes reales.</p>
        </div>

        <div class="main-content">
            <div class="multimeter-section">
                <h2 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">Tu Multímetro Virtual</h2>
                
                <div class="multimeter">
                    <div class="multimeter-brand">Multímetro Hericraft</div>
                    
                    <div class="display-section">
                        <div class="display" id="display">0.00</div>
                        <div class="display-indicators">
                            <span>AUTO</span>
                            <span>HOLD</span>
                            <span class="unit-display" id="unit-display">V</span>
                        </div>
                    </div>

                    <div class="function-buttons">
                        <button class="function-btn" onclick="toggleHold()" id="hold-btn">HOLD</button>
                        <button class="function-btn" onclick="toggleAuto()" id="auto-btn">AUTO</button>
                        <button class="function-btn" onclick="toggleBacklight()" id="light-btn">LIGHT</button>
                        <button class="function-btn" onclick="resetDisplay()" id="reset-btn">RESET</button>
                    </div>
                    
                    <div class="selector-area">
                        <div class="selector" id="selector" onclick="rotateSelector(event)">
                            <div class="selector-pointer" id="pointer"></div>
                            <div class="selector-labels">
                                <!-- OFF - 0° (arriba) -->
                                <div class="label" style="top: -5px; left: 50%; transform: translateX(-50%);">OFF</div>
                                <!-- V~ - 45° (arriba-derecha) -->
                                <div class="label" style="top: 20px; right: 20px;">V~</div>
                                <!-- mA - 90° (derecha) -->
                                <div class="label" style="top: 50%; right: -5px; transform: translateY(-50%);">mA</div>
                                <!-- A - 135° (abajo-derecha) -->
                                <div class="label" style="bottom: 20px; right: 20px;">A</div>
                                <!-- µF - 180° (abajo) -->
                                <div class="label" style="bottom: -5px; left: 50%; transform: translateX(-50%);">µF</div>
                                <!-- Ω - 225° (abajo-izquierda) -->
                                <div class="label" style="bottom: 20px; left: 20px;">Ω</div>
                                <!-- ♪ - 270° (izquierda) -->
                                <div class="label" style="top: 50%; left: -5px; transform: translateY(-50%);">♪</div>
                                <!-- S - 315° (arriba-izquierda) -->
                                <div class="label" style="top: 20px; left: 20px;">S</div>
                            </div>
                        </div>
                    </div>

                    <div class="ports-section">
                        <div class="ports-label">Puertos de Conexión</div>
                        <div class="ports">
                            <div class="port-container">
                                <div class="port com" id="port-com" title="${translations[currentLanguage].comPortTooltip}"></div>
                                <div class="port-label">COM</div>
                            </div>
                            <div class="port-container">
                                <div class="port v" id="port-v" title="${translations[currentLanguage].vPortTooltip}"></div>
                                <div class="port-label">VΩmA</div>
                            </div>
                            <div class="port-container">
                                <div class="port a" id="port-a" title="${translations[currentLanguage].aPortTooltip}"></div>
                                <div class="port-label">10A</div>
                            </div>
                        </div>
                    </div>

                    <div class="probes-section">
                        <div class="probes-label">Puntas de Prueba</div>
                        <div class="probes">
                            <div class="probe black" id="probe-black" onclick="selectProbe('black')" title="${translations[currentLanguage].blackProbeTooltip}">COM</div>
                            <div class="probe red" id="probe-red" onclick="selectProbe('red')" title="${translations[currentLanguage].redProbeTooltip}">+</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="control-panel">
                <div class="exercise-section">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h3 style="margin: 0;"><span id="exercise-label">🎯 Ejercicio:</span> <span id="exercise-title">Medir Voltaje de Batería</span></h3>
                        <button onclick="showExerciseSelector()" id="select-exercise-btn" style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; font-weight: bold; font-size: 14px; display: flex; align-items: center; gap: 8px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);">
                            📋 <span id="select-exercise-text">Seleccionar Ejercicio</span>
                        </button>
                    </div>
                    
                    <div style="background: #e8f4fd; padding: 15px; border-radius: 10px; margin: 15px 0; border-left: 4px solid #3498db;">
                        <strong><span id="objective-label">📖 Objetivo:</span></strong> <span id="exercise-objective">Mide cuántos voltios produce la batería</span><br>
                        <strong><span id="mode-label">🔧 Modo necesario:</span></strong> <span id="exercise-mode">Voltaje (V)</span><br>
                        <strong><span id="connection-label">📍 Conexión:</span></strong> <span id="exercise-connection">Conecta las puntas en los extremos de la batería (puntos 1 y 2)</span>
                    </div>
                    
                    <div class="circuit" id="circuit">
                        <!-- Los componentes se mostrarán dinámicamente según el ejercicio -->
                    </div>
                    
                    <div style="background: #fff3cd; padding: 10px; border-radius: 8px; margin: 10px 0; font-size: 0.9rem;">
                        <strong><span id="hint-label">💡 Pista:</span></strong> <span id="exercise-hint">Para medir voltaje, conecta el multímetro en paralelo (al lado) del componente</span>
                    </div>

                    <!-- Botón de verificación prominente -->
                    <div style="text-align: center; margin: 25px 0;">
                        <button class="btn-verify-large" onclick="checkMeasurement()">
                            <span class="verify-icon">✅</span>
                            <div style="display: flex; flex-direction: column; align-items: center;">
                                <span class="verify-text" id="verify-text">Verificar Medición</span>
                                <span class="verify-subtitle" id="verify-subtitle">Comprobar si la conexión es correcta</span>
                            </div>
                        </button>
                    </div>

                    <div class="feedback" id="feedback"></div>

                    <!-- Panel educativo detallado -->
                    <div id="educational-panel" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; margin: 15px 0; display: none;">
                        <h4 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center;">
                            <span style="font-size: 1.5rem; margin-right: 10px;">🎓</span>
                            <span id="concept-title">Conceptos de Corriente Eléctrica</span>
                        </h4>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                <h5 style="color: #ffd700; margin-bottom: 8px;" id="concept-what-is-title">🔬 ¿Qué es?</h5>
                                <p id="concept-definition" style="margin: 0; font-size: 0.9rem; line-height: 1.4;"></p>
                            </div>
                            
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                <h5 style="color: #ffd700; margin-bottom: 8px;" id="concept-analogy-title">🌊 Analogía</h5>
                                <p id="concept-analogy" style="margin: 0; font-size: 0.9rem; line-height: 1.4;"></p>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                <h5 style="color: #ffd700; margin-bottom: 8px;" id="concept-units-title">📏 Unidades</h5>
                                <p id="concept-units" style="margin: 0; font-size: 0.9rem; line-height: 1.4;"></p>
                            </div>
                            
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                <h5 style="color: #ffd700; margin-bottom: 8px;" id="concept-measurement-title">🔧 Cómo medir</h5>
                                <p id="concept-measurement" style="margin: 0; font-size: 0.9rem; line-height: 1.4;"></p>
                            </div>
                        </div>
                        
                        <div style="background: rgba(255,0,0,0.2); padding: 15px; border-radius: 10px; border-left: 4px solid #ff6b6b; margin-bottom: 15px;">
                            <h5 style="color: #ffcccb; margin-bottom: 8px;" id="concept-safety-title">⚠️ Seguridad</h5>
                            <p id="concept-safety" style="margin: 0; font-size: 0.9rem; line-height: 1.4; font-weight: bold;"></p>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                <h5 style="color: #ffd700; margin-bottom: 8px;" id="concept-calculation-title">🧮 Cálculo</h5>
                                <p id="concept-calculation" style="margin: 0; font-size: 0.9rem; line-height: 1.4; font-family: 'Courier New', monospace;"></p>
                            </div>
                            
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                                <h5 style="color: #ffd700; margin-bottom: 8px;" id="concept-realworld-title">🌍 Mundo real</h5>
                                <p id="concept-realworld" style="margin: 0; font-size: 0.9rem; line-height: 1.4;"></p>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 15px;">
                            <button onclick="toggleEducationalPanel()" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-weight: bold;" id="hide-explanation-btn">
                                <span id="hide-explanation-text">Ocultar Explicación</span>
                            </button>
                        </div>
                    </div>

                    <div class="connection-panel">
                        <div class="connection-header">
                            <h4>🔌 Estado de Conexión del Multímetro</h4>
                            <div class="connection-status-badge" id="connection-badge">
                                <span class="status-dot"></span>
                                <span class="status-text">Desconectado</span>
                            </div>
                        </div>
                        
                        <div class="probe-status-grid">
                            <div class="probe-card red-probe-card">
                                <div class="probe-card-header">
                                    <div class="probe-icon-large">🔴</div>
                                    <div class="probe-info">
                                        <h5>Punta Roja (+)</h5>
                                        <span class="probe-port">Puerto VΩmA</span>
                                    </div>
                                    <div class="probe-status-icon" id="red-status-icon">⭕</div>
                                </div>
                                <div class="probe-status-text">
                                    <span id="red-probe-status">Haz clic en la punta roja del multímetro</span>
                                </div>
                                <div class="probe-progress-bar">
                                    <div class="progress-fill red-progress" id="red-progress"></div>
                                </div>
                            </div>
                            
                            <div class="connection-arrow">
                                <div class="arrow-line"></div>
                                <div class="arrow-head">▶</div>
                            </div>
                            
                            <div class="probe-card black-probe-card">
                                <div class="probe-card-header">
                                    <div class="probe-icon-large">⚫</div>
                                    <div class="probe-info">
                                        <h5>Punta Negra (-)</h5>
                                        <span class="probe-port">Puerto COM</span>
                                    </div>
                                    <div class="probe-status-icon" id="black-status-icon">⭕</div>
                                </div>
                                <div class="probe-status-text">
                                    <span id="black-probe-status">Esperando conexión de punta roja</span>
                                </div>
                                <div class="probe-progress-bar">
                                    <div class="progress-fill black-progress" id="black-progress"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="connection-instructions-modern">
                            <div class="instructions-header">
                                <span class="instructions-icon">📋</span>
                                <h5>Guía de Conexión Paso a Paso</h5>
                            </div>
                            
                            <div class="instruction-steps">
                                <div class="instruction-step" id="instruction-1">
                                    <div class="step-circle">1</div>
                                    <div class="step-content">
                                        <strong>Selecciona la punta roja</strong>
                                        <p>Haz clic en la punta roja del multímetro</p>
                                    </div>
                                    <div class="step-status">⏳</div>
                                </div>
                                
                                <div class="instruction-step" id="instruction-2">
                                    <div class="step-circle">2</div>
                                    <div class="step-content">
                                        <strong>Conecta al punto del circuito</strong>
                                        <p>Los puntos se volverán <span class="highlight-red">rojos y pulsarán</span> - haz clic en uno</p>
                                    </div>
                                    <div class="step-status">⏳</div>
                                </div>
                                
                                <div class="instruction-step" id="instruction-3">
                                    <div class="step-circle">3</div>
                                    <div class="step-content">
                                        <strong>Selecciona la punta negra</strong>
                                        <p>Haz clic en la punta negra del multímetro</p>
                                    </div>
                                    <div class="step-status">⏳</div>
                                </div>
                                
                                <div class="instruction-step" id="instruction-4">
                                    <div class="step-circle">4</div>
                                    <div class="step-content">
                                        <strong>Completa la conexión</strong>
                                        <p>Los puntos se volverán <span class="highlight-black">negros y pulsarán</span> - haz clic en otro</p>
                                    </div>
                                    <div class="step-status">⏳</div>
                                </div>
                            </div>
                            
                            <div class="visual-guide">
                                <div class="guide-icon">💡</div>
                                <div class="guide-text">
                                    <strong>Guía Visual:</strong> Los puntos de medición cambiarán de color automáticamente para guiarte en cada paso del proceso de conexión.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Panel de información de componentes actuales -->
                    <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 15px; padding: 20px; margin: 15px 0; border: 2px solid #dee2e6;">
                        <h4 style="color: #2c3e50; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.2rem;">🔧</span>
                            Componentes Actuales del Circuito
                        </h4>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: white; padding: 12px; border-radius: 10px; border-left: 4px solid #3498db;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                                    <span style="font-size: 1.1rem;">🔋</span>
                                    <strong style="color: #2c3e50;">Batería:</strong>
                                </div>
                                <div id="current-battery-info" style="font-size: 0.9rem; color: #34495e;">
                                    9V - 9.00V
                                </div>
                            </div>
                            
                            <div style="background: white; padding: 12px; border-radius: 10px; border-left: 4px solid #e67e22;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                                    <span style="font-size: 1.1rem;">🔧</span>
                                    <strong style="color: #2c3e50;">Resistor:</strong>
                                </div>
                                <div id="current-resistor-info" style="font-size: 0.9rem; color: #34495e;">
                                    100Ω - 5%
                                </div>
                            </div>
                            
                            <div style="background: white; padding: 12px; border-radius: 10px; border-left: 4px solid #3498db;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                                    <span style="font-size: 1.1rem;">💡</span>
                                    <strong style="color: #2c3e50;">LED:</strong>
                                </div>
                                <div id="current-led-info" style="font-size: 0.9rem; color: #34495e;">
                                    LED Rojo - 2.1V
                                </div>
                            </div>
                            
                            <div style="background: white; padding: 12px; border-radius: 10px; border-left: 4px solid #9b59b6;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                                    <span style="font-size: 1.1rem;">⚡</span>
                                    <strong style="color: #2c3e50;">Condensador:</strong>
                                </div>
                                <div id="current-capacitor-info" style="font-size: 0.9rem; color: #34495e;">
                                    100µF - 25V
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(52, 152, 219, 0.1); padding: 10px; border-radius: 8px; margin-top: 15px; text-align: center;">
                            <small style="color: #2980b9; font-weight: bold;">
                                💡 Consejo: Haz clic en cualquier componente del circuito para cambiar sus valores y ver cómo afecta las mediciones
                            </small>
                        </div>
                    </div>



                    <!-- Botones de ayuda secundarios -->
                    <div class="help-buttons-section">
                        <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center; font-size: 1.1rem;">
                            📚 Recursos de Aprendizaje
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                            <button class="help-btn educational" onclick="showEducationalContent()">
                                <div class="help-btn-icon">🎓</div>
                                <div class="help-btn-content">
                                    <div class="help-btn-title" id="detailed-explanation-title">Explicación Detallada</div>
                                    <div class="help-btn-subtitle" id="concepts-theory-subtitle">Conceptos y teoría</div>
                                </div>
                            </button>
                            <button class="help-btn glossary" onclick="showGlossary()">
                                <div class="help-btn-icon">📖</div>
                                <div class="help-btn-content">
                                    <div class="help-btn-title" id="technical-glossary-title">Glosario Técnico</div>
                                    <div class="help-btn-subtitle" id="components-terms-subtitle">Componentes y términos</div>
                                </div>
                            </button>
                            <button class="help-btn multimeter-guide" onclick="showMultimeterGuide()">
                                <div class="help-btn-icon">🔧</div>
                                <div class="help-btn-content">
                                    <div class="help-btn-title" id="multimeter-parts-title">Partes del Multímetro</div>
                                    <div class="help-btn-subtitle" id="functions-components-subtitle">Funciones y componentes</div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal del Glosario -->
        <div id="glossary-modal" class="glossary-modal">
            <div class="glossary-content">
                <div class="glossary-header">
                    <h2>
                        <span id="glossary-modal-title">📚 Glosario de Componentes Electrónicos</span>
                        <button class="close-btn" onclick="closeGlossary()">×</button>
                    </h2>
                    <p style="margin: 10px 0 0 0; opacity: 0.9;" id="glossary-modal-subtitle">Aprende sobre los componentes básicos de la electrónica</p>
                </div>
                
                <div class="glossary-grid" id="glossary-content">
                    <!-- El contenido se generará dinámicamente -->
                </div>
            </div>
        </div>

        <!-- Modal del Selector de Ejercicios -->
        <div id="exercise-selector-modal" class="glossary-modal">
            <div class="glossary-content">
                <div class="glossary-header">
                    <h2>
                        <span id="exercise-selector-modal-title">🎯 Seleccionar Ejercicio</span>
                        <button class="close-btn" onclick="closeExerciseSelector()">×</button>
                    </h2>
                    <p style="margin: 10px 0 0 0; opacity: 0.9;" id="exercise-selector-modal-subtitle">Elige el ejercicio que quieres realizar</p>
                </div>
                
                <div class="glossary-grid" id="exercise-selector-content">
                    <!-- El contenido se generará dinámicamente -->
                </div>
            </div>
        </div>

        <!-- Modal de Guía del Multímetro -->
        <div id="multimeter-guide-modal" class="glossary-modal">
            <div class="glossary-content">
                <div class="glossary-header">
                    <h2>
                        <span id="multimeter-guide-modal-title">🔧 Partes y Funciones del Multímetro</span>
                        <button class="close-btn" onclick="closeMultimeterGuide()">×</button>
                    </h2>
                    <p style="margin: 10px 0 0 0; opacity: 0.9;" id="multimeter-guide-modal-subtitle">Aprende sobre cada componente y función de tu multímetro digital</p>
                </div>
                
                <div style="padding: 30px;" id="multimeter-guide-content">
                    <!-- El contenido se generará dinámicamente -->
                </div>
            </div>
        </div>

        <!-- Modal de Celebración de Maestría -->
        <div id="mastery-modal" class="glossary-modal" style="background: rgba(0,0,0,0.95); z-index: 9999;">
            <div class="glossary-content" style="max-width: 900px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; box-shadow: 0 30px 80px rgba(0,0,0,0.8); border-radius: 25px; position: relative; overflow: hidden;">
                
                <!-- Efectos de fondo animados -->
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><circle cx=\"20\" cy=\"20\" r=\"2\" fill=\"%23FFD700\" opacity=\"0.6\"><animate attributeName=\"opacity\" values=\"0.6;1;0.6\" dur=\"2s\" repeatCount=\"indefinite\"/></circle><circle cx=\"80\" cy=\"30\" r=\"1.5\" fill=\"%23FFF\" opacity=\"0.4\"><animate attributeName=\"opacity\" values=\"0.4;0.8;0.4\" dur=\"3s\" repeatCount=\"indefinite\"/></circle><circle cx=\"60\" cy=\"70\" r=\"2.5\" fill=\"%23FFD700\" opacity=\"0.5\"><animate attributeName=\"opacity\" values=\"0.5;1;0.5\" dur=\"2.5s\" repeatCount=\"indefinite\"/></circle><circle cx=\"30\" cy=\"80\" r=\"1\" fill=\"%23FFF\" opacity=\"0.3\"><animate attributeName=\"opacity\" values=\"0.3;0.7;0.3\" dur=\"4s\" repeatCount=\"indefinite\"/></circle></svg>') repeat; opacity: 0.4;"></div>
                
                <!-- Rayos de luz de fondo -->
                <div style="position: absolute; top: 50%; left: 50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%); transform: translate(-50%, -50%) rotate(0deg); animation: rotate 20s linear infinite;"></div>
                
                <div style="text-align: center; padding: 60px 40px; color: white; position: relative; z-index: 10;">
                    
                    <!-- Título principal con efectos -->
                    <div style="margin-bottom: 30px;">
                        <div style="font-size: 10rem; margin-bottom: 20px; animation: bounce 2s infinite; text-shadow: 0 0 40px rgba(255, 215, 0, 1), 0 0 80px rgba(255, 215, 0, 0.5); filter: drop-shadow(0 10px 20px rgba(0,0,0,0.5));">🏆</div>
                        
                        <h1 style="font-size: 3.5rem; font-weight: 900; margin-bottom: 20px; text-shadow: 4px 4px 8px rgba(0,0,0,0.7); background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700, #FF8C00); background-size: 300% 300%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; animation: gradientShift 3s ease-in-out infinite;" id="mastery-congratulations">
                            ¡FELICITACIONES!
                        </h1>
                        
                        <div style="font-size: 1.2rem; color: #FFD700; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); margin-bottom: 30px; animation: fadeInUp 1s ease-out 0.5s both;" id="mastery-achieved">
                            🎉 ¡HAS ALCANZADO LA MAESTRÍA! 🎉
                        </div>
                    </div>
                    
                    <!-- Insignia principal del maestro -->
                    <div style="display: flex; justify-content: center; margin: 40px 0;">
                        <div style="position: relative;">
                            <!-- Círculo exterior con brillo -->
                            <div style="width: 200px; height: 200px; border-radius: 50%; background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FF8C00 100%); display: flex; align-items: center; justify-content: center; box-shadow: 0 0 50px rgba(255, 215, 0, 0.8), 0 0 100px rgba(255, 215, 0, 0.4), inset 0 5px 15px rgba(255,255,255,0.3); animation: glow 2s ease-in-out infinite alternate; position: relative;">
                                
                                <!-- Anillo interior -->
                                <div style="width: 160px; height: 160px; border-radius: 50%; background: linear-gradient(135deg, #FF8C00 0%, #FFD700 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: inset 0 5px 15px rgba(0,0,0,0.3); border: 3px solid rgba(255,255,255,0.5);">
                                    
                                    <!-- Símbolo del multímetro -->
                                    <div style="font-size: 4rem; margin-bottom: 8px; color: #8B4513; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); animation: pulse 2s ease-in-out infinite;">⚡</div>
                                    
                                    <!-- Texto de maestro -->
                                    <div style="color: #8B4513; font-weight: 900; font-size: 1rem; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); letter-spacing: 1px;">MAESTRO</div>
                                    <div style="color: #8B4513; font-weight: 700; font-size: 0.7rem; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); margin-top: 2px;">MULTÍMETRO</div>
                                </div>
                                
                                <!-- Estrellas decorativas alrededor -->
                                <div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); font-size: 2rem; color: #FFD700; animation: twinkle 1.5s ease-in-out infinite;">⭐</div>
                                <div style="position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); font-size: 2rem; color: #FFD700; animation: twinkle 1.5s ease-in-out infinite 0.5s;">⭐</div>
                                <div style="position: absolute; left: -10px; top: 50%; transform: translateY(-50%); font-size: 2rem; color: #FFD700; animation: twinkle 1.5s ease-in-out infinite 1s;">⭐</div>
                                <div style="position: absolute; right: -10px; top: 50%; transform: translateY(-50%); font-size: 2rem; color: #FFD700; animation: twinkle 1.5s ease-in-out infinite 1.5s;">⭐</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mensaje principal -->
                    <div style="background: rgba(255,255,255,0.15); border-radius: 25px; padding: 35px; margin: 40px 0; backdrop-filter: blur(15px); border: 2px solid rgba(255,255,255,0.3); box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                        <h2 style="font-size: 2.5rem; margin-bottom: 20px; color: #FFD700; text-shadow: 3px 3px 6px rgba(0,0,0,0.5); animation: fadeInUp 1s ease-out 1s both;" id="mastery-master-title">
                            🎓 MAESTRO DEL MULTÍMETRO 🎓
                        </h2>
                        <p style="font-size: 1.4rem; line-height: 1.6; margin-bottom: 25px; text-shadow: 2px 2px 4px rgba(0,0,0,0.4); animation: fadeInUp 1s ease-out 1.2s both;" id="mastery-message">
                            Has completado exitosamente todos los ejercicios y dominado las técnicas fundamentales de medición eléctrica.
                        </p>
                        <p style="font-size: 1.2rem; opacity: 0.95; text-shadow: 1px 1px 3px rgba(0,0,0,0.4); animation: fadeInUp 1s ease-out 1.4s both;" id="mastery-skills">
                            Ahora posees las habilidades para medir voltaje, corriente, resistencia, capacitancia y continuidad con confianza y precisión profesional.
                        </p>
                    </div>
                    
                    <!-- Logros desbloqueados -->
                    <div style="background: rgba(255,215,0,0.15); border-radius: 20px; padding: 30px; margin: 30px 0; border: 2px solid rgba(255,215,0,0.4); animation: fadeInUp 1s ease-out 1.6s both;">
                        <h3 style="color: #FFD700; margin-bottom: 20px; font-size: 1.5rem; display: flex; align-items: center; justify-content: center; gap: 10px;">
                            <span style="font-size: 2rem;">🏅</span>
                            Habilidades Dominadas
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; text-align: left;">
                            <div style="display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 10px;">
                                <span style="font-size: 1.5rem;">⚡</span>
                                <span style="font-size: 1rem; font-weight: bold;">Medición de Voltaje</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 10px;">
                                <span style="font-size: 1.5rem;">🌊</span>
                                <span style="font-size: 1rem; font-weight: bold;">Medición de Corriente</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 10px;">
                                <span style="font-size: 1.5rem;">🔧</span>
                                <span style="font-size: 1rem; font-weight: bold;">Medición de Resistencia</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 10px;">
                                <span style="font-size: 1.5rem;">⚡</span>
                                <span style="font-size: 1rem; font-weight: bold;">Medición de Capacitancia</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 10px;">
                                <span style="font-size: 1.5rem;">🔊</span>
                                <span style="font-size: 1rem; font-weight: bold;">Verificación de Continuidad</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Estadísticas finales -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 25px; margin: 40px 0; animation: fadeInUp 1s ease-out 1.8s both;">
                        <div style="background: rgba(255,255,255,0.2); padding: 25px; border-radius: 20px; backdrop-filter: blur(10px); border: 2px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 3rem; color: #FFD700; margin-bottom: 10px;">📊</div>
                            <div style="font-size: 2rem; font-weight: bold; margin: 10px 0;" id="mastery-exercises">6</div>
                            <div style="font-size: 1rem; opacity: 0.9;">Ejercicios Completados</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 25px; border-radius: 20px; backdrop-filter: blur(10px); border: 2px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 3rem; color: #FFD700; margin-bottom: 10px;">🎯</div>
                            <div style="font-size: 2rem; font-weight: bold; margin: 10px 0;">100%</div>
                            <div style="font-size: 1rem; opacity: 0.9;">Precisión Alcanzada</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 25px; border-radius: 20px; backdrop-filter: blur(10px); border: 2px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 3rem; color: #FFD700; margin-bottom: 10px;">⚡</div>
                            <div style="font-size: 2rem; font-weight: bold; margin: 10px 0;">5</div>
                            <div style="font-size: 1rem; opacity: 0.9;">Técnicas Dominadas</div>
                        </div>
                    </div>
                    
                    <!-- Mensaje motivacional -->
                    <div style="background: rgba(255,215,0,0.2); border-radius: 20px; padding: 30px; margin: 40px 0; border: 3px solid rgba(255,215,0,0.5); animation: fadeInUp 1s ease-out 2s both;">
                        <h3 style="color: #FFD700; margin-bottom: 15px; font-size: 1.4rem; display: flex; align-items: center; justify-content: center; gap: 10px;" id="mastery-continue-learning">
                            <span style="font-size: 2rem;">🌟</span>
                            ¡Continúa tu Aprendizaje!
                        </h3>
                        <p style="margin: 0; font-size: 1.1rem; line-height: 1.6; opacity: 0.95;" id="mastery-next-steps">
                            Ahora que dominas el multímetro, estás listo para explorar proyectos más avanzados de electrónica. 
                            Puedes aplicar estos conocimientos en reparaciones, diseño de circuitos y diagnóstico de problemas eléctricos.
                        </p>
                    </div>
                    
                    <!-- Botones de acción mejorados -->
                    <div style="display: flex; gap: 25px; justify-content: center; margin-top: 50px; animation: fadeInUp 1s ease-out 2.2s both;">
                        <button onclick="closeMasteryModal()" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); border: none; border-radius: 30px; color: white; padding: 18px 35px; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 8px 25px rgba(39, 174, 96, 0.4); transition: all 0.3s ease; display: flex; align-items: center; gap: 10px;" id="mastery-continue-btn">
                            <span style="font-size: 1.5rem;">🎉</span>
                            <span id="mastery-continue-text">¡Genial! Continuar</span>
                        </button>
                        <button onclick="resetAllProgress()" style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); border: none; border-radius: 30px; color: white; padding: 18px 35px; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4); transition: all 0.3s ease; display: flex; align-items: center; gap: 10px;" id="mastery-reset-btn">
                            <span style="font-size: 1.5rem;">🔄</span>
                            <span id="mastery-reset-text">Reiniciar Ejercicios</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        let currentMode = 'off';
        let selectedPoints = [];
        let currentExercise = 0;
        let probeConnections = { red: null, black: null };
        let currentBattery = 0;
        let currentCapacitor = 0;
        let currentResistor = 0;
        let currentLED = 0;
        let connectionState = 'idle'; // 'idle', 'red-selected', 'red-connected', 'black-selected'
        let completedExercises = new Set(); // Seguimiento de ejercicios completados
        let currentLanguage = 'es'; // Sistema de idiomas

        // Base de datos de traducciones
        const translations = {
            es: {
                // Títulos principales
                mainTitle: "⚡ Simulador de Multímetro Digital",
                mainSubtitle: "Domina las mediciones eléctricas con nuestro laboratorio virtual interactivo. Aprende voltaje, corriente, resistencia y más con componentes reales.",
                
                // Multímetro
                multimeterTitle: "Tu Multímetro Virtual",
                multimeterBrand: "Multímetro Hericraft",
                portsLabel: "Puertos de Conexión",
                probesLabel: "Puntas de Prueba",
                
                // Etiquetas de puertos
                comPort: "COM",
                vPort: "VΩmA", 
                aPort: "10A",
                comProbe: "COM",
                positiveProbe: "+",
                
                // Tooltips de puertos
                comTooltip: "COM (Común)",
                vTooltip: "Voltaje/Resistencia",
                aTooltip: "Amperaje Alto",
                blackProbeTooltip: "Punta negra (COM)",
                redProbeTooltip: "Punta roja",
                
                // Botones del multímetro
                holdButton: "HOLD",
                autoButton: "AUTO", 
                lightButton: "LIGHT",
                resetButton: "RESET",
                
                // Modos del multímetro
                modeVoltage: "Voltaje (V)",
                modeCurrent: "Corriente (mA)",
                modeCurrentA: "Corriente (A)",
                modeCapacitance: "Capacitancia (µF)",
                modeResistance: "Resistencia (Ω)",
                modeConductance: "Conductancia (mS)",
                modeContinuity: "Continuidad (♪)",
                modeOff: "Apagado",
                
                // Botones del multímetro
                holdActivated: "🔒 HOLD activado - Lectura congelada",
                holdDeactivated: "🔓 HOLD desactivado - Lectura en tiempo real",
                autoActivated: "🤖 AUTO activado - Rango automático",
                autoDeactivated: "📏 AUTO desactivado - Rango manual",
                backlightOn: "💡 Retroiluminación activada",
                backlightOff: "🌙 Retroiluminación desactivada",
                multimeterReset: "🔄 Multímetro reiniciado",
                
                // Ejercicios
                exerciseTitle: "🎯 Ejercicio:",
                selectExercise: "📋 Seleccionar Ejercicio",
                objective: "📖 Objetivo:",
                modeNeeded: "🔧 Modo necesario:",
                connection: "📍 Conexión:",
                hint: "💡 Pista:",
                
                // Estados de conexión
                connectionTitle: "🔌 Estado de Conexión del Multímetro",
                disconnected: "Desconectado",
                partiallyConnected: "Parcialmente Conectado",
                fullyConnected: "Completamente Conectado",
                redProbe: "Punta Roja (+)",
                blackProbe: "Punta Negra (-)",
                redPort: "Puerto VΩmA",
                blackPort: "Puerto COM",
                
                // Mensajes de estado de puntas
                redProbeSelected: "Seleccionada - Haz clic en un punto del circuito",
                blackProbeSelected: "Seleccionada - Haz clic en un punto del circuito",
                redProbeConnected: "Conectada al punto",
                blackProbeConnected: "Conectada al punto",
                redProbeClick: "Haz clic en la punta roja del multímetro",
                blackProbeClick: "Haz clic en la punta negra del multímetro",
                waitingRedProbe: "Esperando conexión de punta roja",
                
                // Mensajes de feedback
                redProbeConnectedMsg: "🔴 Punta roja conectada al punto",
                blackProbeConnectedMsg: "⚫ Punta negra conectada al punto",
                selectProbeFirst: "⚠️ Primero selecciona una punta del multímetro (roja o negra)",
                modeSelected: "🔧 Modo seleccionado:",
                
                // Mensajes de verificación
                connectBothProbes: "❌ Debes conectar ambas puntas del multímetro antes de verificar.",
                incorrectMode: "❌ Modo incorrecto. Necesitas usar el modo",
                incorrectConnection: "❌ Conexión incorrecta",
                connectedPoints: "Conectaste los puntos",
                needPoints: "pero necesitas conectar los puntos",
                
                // Mensajes de progreso
                progress: "📊 Progreso:",
                exercisesCompleted: "ejercicios completados",
                congratulationsAll: "🎉 ¡Felicitaciones! Has completado todos los ejercicios",
                nextExercise: "🎯 Avanzando al siguiente ejercicio:",
                masteryUnlocked: "🏆 ¡Maestría desbloqueada! Has completado todos los ejercicios.",
                languageChanged: "🌐 Idioma cambiado a Español",
                
                // Mensajes de reinicio
                confirmReset: "¿Estás seguro de que quieres reiniciar todo el progreso? Se perderán todos los ejercicios completados.",
                progressReset: "🔄 Progreso reiniciado - Comenzando desde el primer ejercicio",
                
                // Instrucciones
                instructionsTitle: "Guía de Conexión Paso a Paso",
                step1: "Selecciona la punta roja",
                step1Desc: "Haz clic en la punta roja del multímetro",
                step2: "Conecta al punto del circuito",
                step2Desc: "Los puntos se volverán rojos y pulsarán - haz clic en uno",
                step3: "Selecciona la punta negra",
                step3Desc: "Haz clic en la punta negra del multímetro",
                step4: "Completa la conexión",
                step4Desc: "Los puntos se volverán negros y pulsarán - haz clic en otro",
                
                // Botones de ayuda
                learningResources: "📚 Recursos de Aprendizaje",
                detailedExplanation: "Explicación Detallada",
                conceptsTheory: "Conceptos y teoría",
                technicalGlossary: "Glosario Técnico",
                componentsTerms: "Componentes y términos",
                multimeterParts: "Partes del Multímetro",
                functionsComponents: "Funciones y componentes",
                
                // Verificación
                verifyMeasurement: "Verificar Medición",
                checkConnection: "Comprobar si la conexión es correcta",
                
                // Componentes actuales
                currentComponents: "Componentes Actuales del Circuito",
                battery: "Batería:",
                resistor: "Resistor:",
                led: "LED:",
                capacitor: "Condensador:",
                componentTip: "💡 Consejo: Haz clic en cualquier componente del circuito para cambiar sus valores y ver cómo afecta las mediciones",
                
                // Ejercicios específicos
                exercises: [
                    {
                        title: "Medir Voltaje de Batería",
                        objective: "Mide cuántos voltios produce la batería y aprende conceptos fundamentales",
                        mode: "Voltaje (V)",
                        connection: "Conecta las puntas en los extremos de la batería (puntos 1 y 2)",
                        hint: "Para medir voltaje, conecta el multímetro en paralelo (al lado) del componente"
                    },
                    {
                        title: "Medir Resistencia del Resistor",
                        objective: "Mide el valor de la resistencia y aprende sobre la Ley de Ohm",
                        mode: "Resistencia (Ω)",
                        connection: "Conecta las puntas en los extremos del resistor (puntos 1 y 2)",
                        hint: "Para medir resistencia, el componente debe estar desconectado del circuito"
                    },
                    {
                        title: "Medir Corriente en el Circuito",
                        objective: "Mide cuánta corriente fluye por el LED y aprende conceptos fundamentales",
                        mode: "Corriente (A)",
                        connection: "Conecta las puntas donde pasa la corriente (puntos 2 y 3)",
                        hint: "Para medir corriente, el multímetro debe estar en serie (en el camino) de la corriente"
                    },
                    {
                        title: "Medir Voltaje del LED",
                        objective: "Mide la caída de voltaje a través del LED cuando está encendido",
                        mode: "Voltaje (V)",
                        connection: "Conecta las puntas en los extremos del LED (puntos 2 y 3)",
                        hint: "El LED consume voltaje cuando está encendido - esto se llama 'caída de voltaje'"
                    },
                    {
                        title: "Medir Capacitancia",
                        objective: "Mide el valor del condensador y aprende sobre almacenamiento de energía",
                        mode: "Capacitancia (µF)",
                        connection: "Conecta las puntas en los terminales del condensador (puntos 1 y 2)",
                        hint: "Los condensadores almacenan energía eléctrica - descárgalo antes de medir"
                    },
                    {
                        title: "Verificar Continuidad",
                        objective: "Verifica si hay un camino continuo para la corriente eléctrica",
                        mode: "Continuidad (♪)",
                        connection: "Conecta las puntas en los extremos del resistor (puntos 1 y 2)",
                        hint: "La continuidad verifica si la electricidad puede fluir entre dos puntos"
                    }
                ],
                
                // Mensajes dinámicos
                measurementUpdated: "Medición actualizada",
                continuityDetected: "🔊 Continuidad detectada - ¡Pitido!",
                
                // Tooltips de componentes
                batteryTooltip: "Haz clic para cambiar el tipo de batería",
                resistorTooltip: "Haz clic para cambiar el valor del resistor",
                ledTooltip: "Haz clic para cambiar el color del LED",
                capacitorTooltip: "Haz clic para cambiar el tipo de condensador",
                
                // Tooltips de puertos y puntas
                comPortTooltip: "COM (Común)",
                vPortTooltip: "Voltaje/Resistencia",
                aPortTooltip: "Amperaje Alto",
                blackProbeTooltip: "Punta negra (COM)",
                redProbeTooltip: "Punta roja",
                
                // Modal de maestría
                masteryModalTitle: "¡FELICITACIONES!",
                masteryAchieved: "🎉 ¡HAS ALCANZADO LA MAESTRÍA! 🎉",
                masteryMasterTitle: "🎓 MAESTRO DEL MULTÍMETRO 🎓",
                masteryMessage: "Has completado exitosamente todos los ejercicios y dominado las técnicas fundamentales de medición eléctrica.",
                masterySkills: "Ahora posees las habilidades para medir voltaje, corriente, resistencia, capacitancia y continuidad con confianza y precisión profesional.",
                masterySkillsAchieved: "Habilidades Dominadas",
                masteryVoltage: "Medición de Voltaje",
                masteryCurrent: "Medición de Corriente", 
                masteryResistance: "Medición de Resistencia",
                masteryCapacitance: "Medición de Capacitancia",
                masteryContinuity: "Verificación de Continuidad",
                masteryExercisesCompleted: "Ejercicios Completados",
                masteryPrecisionAchieved: "Precisión Alcanzada",
                masteryTechniquesMastered: "Técnicas Dominadas",
                masteryContinueLearning: "¡Continúa tu Aprendizaje!",
                masteryNextSteps: "Ahora que dominas el multímetro, estás listo para explorar proyectos más avanzados de electrónica. Puedes aplicar estos conocimientos en reparaciones, diseño de circuitos y diagnóstico de problemas eléctricos.",
                masteryContinueBtn: "¡Genial! Continuar",
                masteryResetBtn: "Reiniciar Ejercicios",
                
                // Modales
                glossaryModalTitle: "📚 Glosario de Componentes Electrónicos",
                glossaryModalSubtitle: "Aprende sobre los componentes básicos de la electrónica",
                exerciseSelectorModalTitle: "🎯 Seleccionar Ejercicio",
                exerciseSelectorModalSubtitle: "Elige el ejercicio que quieres realizar",
                multimeterGuideModalTitle: "🔧 Partes y Funciones del Multímetro",
                multimeterGuideModalSubtitle: "Aprende sobre cada componente y función de tu multímetro digital",
                closeButton: "×",
                
                // Panel educativo
                educationalPanelTitle: "Conceptos de",
                whatIs: "🔬 ¿Qué es?",
                analogy: "🌊 Analogía",
                units: "📏 Unidades", 
                howToMeasure: "🔧 Cómo medir",
                safety: "⚠️ Seguridad",
                calculation: "🧮 Cálculo",
                realWorld: "🌍 Mundo real",
                hideExplanation: "Ocultar Explicación",
                
                // Textos de botones
                selectExerciseBtn: "Seleccionar Ejercicio",
                verifyMeasurementBtn: "Verificar Medición",
                checkConnectionBtn: "Comprobar si la conexión es correcta",
                detailedExplanationBtn: "Explicación Detallada",
                conceptsTheoryBtn: "Conceptos y teoría",
                technicalGlossaryBtn: "Glosario Técnico",
                componentsTermsBtn: "Componentes y términos",
                multimeterPartsBtn: "Partes del Multímetro",
                functionsComponentsBtn: "Funciones y componentes",
                masteryContinueBtn: "¡Genial! Continuar",
                masteryResetBtn: "Reiniciar Ejercicios",
                
                // Guía visual
                visualGuide: "Guía Visual:",
                visualGuideText: "Los puntos de medición cambiarán de color automáticamente para guiarte en cada paso del proceso de conexión.",
                
                // Visual guide
                visualGuide: "Visual Guide:",
                visualGuideText: "Measurement points will automatically change color to guide you through each step of the connection process.",
                
                // Multimeter guide
                multimeterGuide: {
                    whatIsTitle: "What is a Multimeter?",
                    whatIsDescription: "Un multímetro es un instrumento de medición electrónico que combina varias funciones en un solo dispositivo. Es la herramienta más importante para cualquier persona que trabaje con electricidad y electrónica, desde técnicos profesionales hasta estudiantes y aficionados.",
                    mainPartsTitle: "Partes Principales del Multímetro",
                    functionLabel: "Función",
                    featuresLabel: "Características",
                    
                    display: {
                        title: "Pantalla Digital (Display)",
                        subtitle: "Muestra las mediciones",
                        function: "Muestra el valor numérico de la medición actual con hasta 4 dígitos de precisión.",
                        features: [
                            "Display LCD con retroiluminación opcional",
                            "Indicadores de unidades (V, A, Ω, µF, etc.)",
                            "Símbolos de estado (AUTO, HOLD, batería baja)",
                            "Indicador de polaridad (+ / -)"
                        ]
                    },
                    
                    selector: {
                        title: "Selector Rotatorio",
                        subtitle: "Selecciona el modo de medición",
                        function: "Permite seleccionar qué tipo de medición realizar y el rango apropiado.",
                        positionsLabel: "Posiciones principales",
                        positions: [
                            "Apagado (ahorra batería)",
                            "Voltaje AC (corriente alterna)",
                            "Voltaje DC (corriente continua)",
                            "Corriente (amperios)",
                            "Resistencia (ohmios)",
                            "Continuidad (pitido)",
                            "Capacitancia (microfaradios)"
                        ]
                    },
                    
                    ports: {
                        title: "Puertos de Conexión",
                        subtitle: "Donde se conectan las puntas",
                        function: "Conectores donde se insertan las puntas de prueba según el tipo de medición.",
                        typicalLabel: "Puertos típicos",
                        black: "Negro",
                        red: "Rojo",
                        types: [
                            "Común/negativo - siempre conectar punta negra",
                            "Para voltaje, resistencia y corriente baja",
                            "Para corrientes altas (hasta 10 amperios)",
                            "Para sonda de temperatura (algunos modelos)"
                        ]
                    },
                    
                    probes: {
                        title: "Puntas de Prueba",
                        subtitle: "Cables de conexión",
                        function: "Cables flexibles que conectan el multímetro con los puntos de medición del circuito.",
                        redLabel: "Punta Roja (+)",
                        blackLabel: "Punta Negra (-)",
                        insulationLabel: "Aislamiento",
                        interchangeableLabel: "Puntas intercambiables",
                        features: [
                            "Positivo, se conecta al puerto VΩmA o 10A",
                            "Negativo/común, siempre al puerto COM",
                            "Protección hasta 1000V típicamente",
                            "Aguja, gancho, pinza cocodrilo"
                        ]
                    },
                    
                    buttons: {
                        title: "Botones de Función",
                        subtitle: "Controles adicionales",
                        function: "Botones que activan funciones especiales y configuraciones del multímetro.",
                        commonLabel: "Botones comunes",
                        common: [
                            "Congela la lectura en pantalla",
                            "Selección automática de rango",
                            "Activa/desactiva retroiluminación",
                            "Reinicia el multímetro",
                            "Registra valores mínimos y máximos"
                        ]
                    },
                    
                    battery: {
                        title: "Compartimento de Batería",
                        subtitle: "Fuente de energía",
                        function: "Aloja la batería que alimenta el multímetro para su funcionamiento.",
                        typicalLabel: "Batería típica",
                        durationLabel: "Duración",
                        indicatorLabel: "Indicador",
                        autoOffLabel: "Auto-apagado",
                        features: [
                            "9V alcalina o AA/AAA",
                            "200-1000 horas según uso",
                            "Símbolo de batería baja en pantalla",
                            "Se apaga automáticamente para ahorrar energía"
                        ]
                    },
                    
                    mainFunctionsTitle: "Funciones Principales de Medición",
                    
                    voltage: {
                        title: "Medición de Voltaje (V)",
                        whatLabel: "¿Qué mide?",
                        what: "La diferencia de potencial eléctrico entre dos puntos.",
                        howLabel: "Cómo conectar:",
                        how: "En paralelo (al lado) del componente o fuente.",
                        rangesLabel: "Rangos típicos:",
                        ranges: "200mV, 2V, 20V, 200V, 1000V",
                        applicationsLabel: "Aplicaciones:",
                        applications: "Verificar baterías, fuentes de alimentación, caídas de voltaje."
                    },
                    
                    current: {
                        title: "Medición de Corriente (A)",
                        whatLabel: "¿Qué mide?",
                        what: "El flujo de electrones a través de un conductor.",
                        howLabel: "Cómo conectar:",
                        how: "En serie (interrumpiendo) el circuito.",
                        rangesLabel: "Rangos típicos:",
                        ranges: "200µA, 2mA, 20mA, 200mA, 10A",
                        applicationsLabel: "Aplicaciones:",
                        applications: "Verificar consumo de dispositivos, detectar cortocircuitos.",
                        unit: "Amperios"
                    },
                    
                    resistance: {
                        title: "Medición de Resistencia (Ω)",
                        whatLabel: "¿Qué mide?",
                        what: "La oposición al flujo de corriente eléctrica.",
                        howLabel: "Cómo conectar:",
                        how: "Con el componente desconectado del circuito.",
                        rangesLabel: "Rangos típicos:",
                        ranges: "200Ω, 2kΩ, 20kΩ, 200kΩ, 2MΩ",
                        applicationsLabel: "Aplicaciones:",
                        applications: "Verificar resistores, detectar circuitos abiertos.",
                        unit: "Ohmios"
                    },
                    
                    continuity: {
                        title: "Prueba de Continuidad (♪)",
                        whatLabel: "¿Qué verifica?",
                        what: "Si existe un camino conductor entre dos puntos.",
                        howLabel: "Cómo funciona:",
                        how: "Emite un pitido si hay continuidad (resistencia baja).",
                        thresholdLabel: "Umbral típico:",
                        threshold: "Pitido si resistencia < 50Ω",
                        applicationsLabel: "Aplicaciones:",
                        applications: "Verificar cables, fusibles, conexiones soldadas.",
                        unit: "Pitido"
                    },
                    
                    capacitance: {
                        title: "Medición de Capacitancia (µF)",
                        whatLabel: "¿Qué mide?",
                        what: "La capacidad de almacenar carga eléctrica.",
                        howLabel: "Cómo conectar:",
                        how: "Con el condensador desconectado y descargado.",
                        rangesLabel: "Rangos típicos:",
                        ranges: "2nF, 20nF, 200nF, 2µF, 20µF, 200µF",
                        applicationsLabel: "Aplicaciones:",
                        applications: "Verificar condensadores en fuentes de alimentación, filtros.",
                        unit: "Faradios"
                    },
                    
                    safetyTitle: "Consejos de Seguridad Importantes",
                    safety: {
                        connections: {
                            title: "Conexiones Correctas",
                            tips: [
                                "Siempre conecta la punta negra al puerto COM",
                                "Usa el puerto correcto según la medición",
                                "Para corrientes >200mA, usa el puerto 10A",
                                "Nunca midas corriente en paralelo"
                            ]
                        },
                        highVoltage: {
                            title: "Voltajes Altos",
                            tips: [
                                "Nunca toques cables pelados",
                                "Usa puntas con aislamiento adecuado",
                                "Verifica el rango antes de medir",
                                "Ten cuidado con voltajes >50V"
                            ]
                        },
                        maintenance: {
                            title: "Mantenimiento",
                            tips: [
                                "Apaga el multímetro después de usar",
                                "Reemplaza la batería cuando sea necesario",
                                "Guarda las puntas en lugar seguro",
                                "Calibra periódicamente si es profesional"
                            ]
                        }
                    },
                    
                    practicalTitle: "Consejos Prácticos para Mejores Mediciones",
                    practical: {
                        precision: {
                            title: "Precisión",
                            tips: [
                                "Usa el rango más pequeño posible",
                                "Espera a que la lectura se estabilice",
                                "Mantén buena conexión con las puntas",
                                "Evita interferencias electromagnéticas"
                            ]
                        },
                        technique: {
                            title: "Técnica",
                            tips: [
                                "Limpia los puntos de contacto",
                                "Usa la función HOLD para lecturas difíciles",
                                "Verifica la polaridad en DC",
                                "Descarga condensadores antes de medir"
                            ]
                        },
                        interpretation: {
                            title: "Interpretación",
                            tips: [
                                "Entiende las unidades mostradas",
                                "Considera la tolerancia de componentes",
                                "Compara con valores esperados",
                                "Documenta mediciones importantes"
                            ]
                        }
                    }
                }
            },
            en: {
                // Main titles
                mainTitle: "⚡ Digital Multimeter Simulator",
                mainSubtitle: "Master electrical measurements with our interactive virtual laboratory. Learn voltage, current, resistance and more with real components.",
                
                // Multimeter
                multimeterTitle: "Your Virtual Multimeter",
                multimeterBrand: "Hericraft Multimeter",
                portsLabel: "Connection Ports",
                probesLabel: "Test Probes",
                
                // Port labels
                comPort: "COM",
                vPort: "VΩmA", 
                aPort: "10A",
                comProbe: "COM",
                positiveProbe: "+",
                
                // Port tooltips
                comTooltip: "COM (Common)",
                vTooltip: "Voltage/Resistance",
                aTooltip: "High Amperage",
                blackProbeTooltip: "Black probe (COM)",
                redProbeTooltip: "Red probe",
                
                // Multimeter buttons
                holdButton: "HOLD",
                autoButton: "AUTO", 
                lightButton: "LIGHT",
                resetButton: "RESET",
                
                // Multimeter modes
                modeVoltage: "Voltage (V)",
                modeCurrent: "Current (mA)",
                modeCurrentA: "Current (A)",
                modeCapacitance: "Capacitance (µF)",
                modeResistance: "Resistance (Ω)",
                modeConductance: "Conductance (mS)",
                modeContinuity: "Continuity (♪)",
                modeOff: "Off",
                
                // Multimeter buttons
                holdActivated: "🔒 HOLD activated - Reading frozen",
                holdDeactivated: "🔓 HOLD deactivated - Real-time reading",
                autoActivated: "🤖 AUTO activated - Automatic range",
                autoDeactivated: "📏 AUTO deactivated - Manual range",
                backlightOn: "💡 Backlight activated",
                backlightOff: "🌙 Backlight deactivated",
                multimeterReset: "🔄 Multimeter reset",
                
                // Exercises
                exerciseTitle: "🎯 Exercise:",
                selectExercise: "📋 Select Exercise",
                objective: "📖 Objective:",
                modeNeeded: "🔧 Required mode:",
                connection: "📍 Connection:",
                hint: "💡 Hint:",
                
                // Connection states
                connectionTitle: "🔌 Multimeter Connection Status",
                disconnected: "Disconnected",
                partiallyConnected: "Partially Connected",
                fullyConnected: "Fully Connected",
                redProbe: "Red Probe (+)",
                blackProbe: "Black Probe (-)",
                redPort: "VΩmA Port",
                blackPort: "COM Port",
                
                // Probe status messages
                redProbeSelected: "Selected - Click on a circuit point",
                blackProbeSelected: "Selected - Click on a circuit point",
                redProbeConnected: "Connected to point",
                blackProbeConnected: "Connected to point",
                redProbeClick: "Click on the red probe of the multimeter",
                blackProbeClick: "Click on the black probe of the multimeter",
                waitingRedProbe: "Waiting for red probe connection",
                
                // Feedback messages
                redProbeConnectedMsg: "🔴 Red probe connected to point",
                blackProbeConnectedMsg: "⚫ Black probe connected to point",
                selectProbeFirst: "⚠️ First select a multimeter probe (red or black)",
                modeSelected: "🔧 Mode selected:",
                
                // Verification messages
                connectBothProbes: "❌ You must connect both multimeter probes before verifying.",
                incorrectMode: "❌ Incorrect mode. You need to use mode",
                incorrectConnection: "❌ Incorrect connection",
                connectedPoints: "You connected points",
                needPoints: "but you need to connect points",
                
                // Progress messages
                progress: "📊 Progress:",
                exercisesCompleted: "exercises completed",
                congratulationsAll: "🎉 Congratulations! You have completed all exercises",
                nextExercise: "🎯 Advancing to next exercise:",
                masteryUnlocked: "🏆 Mastery unlocked! You have completed all exercises.",
                languageChanged: "🌐 Language changed to English",
                
                // Reset messages
                confirmReset: "Are you sure you want to reset all progress? All completed exercises will be lost.",
                progressReset: "🔄 Progress reset - Starting from the first exercise",
                
                // Instructions
                instructionsTitle: "Step-by-Step Connection Guide",
                step1: "Select the red probe",
                step1Desc: "Click on the red probe of the multimeter",
                step2: "Connect to circuit point",
                step2Desc: "Points will turn red and pulse - click on one",
                step3: "Select the black probe",
                step3Desc: "Click on the black probe of the multimeter",
                step4: "Complete the connection",
                step4Desc: "Points will turn black and pulse - click on another",
                
                // Help buttons
                learningResources: "📚 Learning Resources",
                detailedExplanation: "Detailed Explanation",
                conceptsTheory: "Concepts and theory",
                technicalGlossary: "Technical Glossary",
                componentsTerms: "Components and terms",
                multimeterParts: "Multimeter Parts",
                functionsComponents: "Functions and components",
                
                // Verification
                verifyMeasurement: "Verify Measurement",
                checkConnection: "Check if the connection is correct",
                
                // Current components
                currentComponents: "Current Circuit Components",
                battery: "Battery:",
                resistor: "Resistor:",
                led: "LED:",
                capacitor: "Capacitor:",
                componentTip: "💡 Tip: Click on any circuit component to change its values and see how it affects measurements",
                
                // Specific exercises
                exercises: [
                    {
                        title: "Measure Battery Voltage",
                        objective: "Measure how many volts the battery produces and learn fundamental concepts",
                        mode: "Voltage (V)",
                        connection: "Connect the probes to the battery terminals (points 1 and 2)",
                        hint: "To measure voltage, connect the multimeter in parallel (alongside) the component"
                    },
                    {
                        title: "Measure Resistor Resistance",
                        objective: "Measure the resistance value and learn about Ohm's Law",
                        mode: "Resistance (Ω)",
                        connection: "Connect the probes to the resistor terminals (points 1 and 2)",
                        hint: "To measure resistance, the component must be disconnected from the circuit"
                    },
                    {
                        title: "Measure Circuit Current",
                        objective: "Measure how much current flows through the LED and learn fundamental concepts",
                        mode: "Current (A)",
                        connection: "Connect the probes where current flows (points 2 and 3)",
                        hint: "To measure current, the multimeter must be in series (in the path) of the current"
                    },
                    {
                        title: "Measure LED Voltage",
                        objective: "Measure the voltage drop across the LED when it's on",
                        mode: "Voltage (V)",
                        connection: "Connect the probes to the LED terminals (points 2 and 3)",
                        hint: "The LED consumes voltage when it's on - this is called 'voltage drop'"
                    },
                    {
                        title: "Measure Capacitance",
                        objective: "Measure the capacitor value and learn about energy storage",
                        mode: "Capacitance (µF)",
                        connection: "Connect the probes to the capacitor terminals (points 1 and 2)",
                        hint: "Capacitors store electrical energy - discharge it before measuring"
                    },
                    {
                        title: "Check Continuity",
                        objective: "Verify if there's a continuous path for electrical current",
                        mode: "Continuity (♪)",
                        connection: "Connect the probes to the resistor terminals (points 1 and 2)",
                        hint: "Continuity checks if electricity can flow between two points"
                    }
                ],
                
                // Dynamic messages
                measurementUpdated: "Measurement updated",
                continuityDetected: "🔊 Continuity detected - Beep!",
                
                // Component tooltips
                batteryTooltip: "Click to change battery type",
                resistorTooltip: "Click to change resistor value",
                ledTooltip: "Click to change LED color",
                capacitorTooltip: "Click to change capacitor type",
                
                // Port and probe tooltips
                comPortTooltip: "COM (Common)",
                vPortTooltip: "Voltage/Resistance",
                aPortTooltip: "High Amperage",
                blackProbeTooltip: "Black probe (COM)",
                redProbeTooltip: "Red probe",
                
                // Mastery modal
                masteryModalTitle: "CONGRATULATIONS!",
                masteryAchieved: "🎉 YOU'VE ACHIEVED MASTERY! 🎉",
                masteryMasterTitle: "🎓 MULTIMETER MASTER 🎓",
                masteryMessage: "You have successfully completed all exercises and mastered the fundamental techniques of electrical measurement.",
                masterySkills: "You now possess the skills to measure voltage, current, resistance, capacitance and continuity with confidence and professional precision.",
                masterySkillsAchieved: "Skills Mastered",
                masteryVoltage: "Voltage Measurement",
                masteryCurrent: "Current Measurement", 
                masteryResistance: "Resistance Measurement",
                masteryCapacitance: "Capacitance Measurement",
                masteryContinuity: "Continuity Verification",
                masteryExercisesCompleted: "Exercises Completed",
                masteryPrecisionAchieved: "Precision Achieved",
                masteryTechniquesMastered: "Techniques Mastered",
                masteryContinueLearning: "Continue Your Learning!",
                masteryNextSteps: "Now that you master the multimeter, you're ready to explore more advanced electronics projects. You can apply this knowledge in repairs, circuit design and electrical troubleshooting.",
                masteryContinueBtn: "Great! Continue",
                masteryResetBtn: "Reset Exercises",
                
                // Modals
                glossaryModalTitle: "📚 Electronic Components Glossary",
                glossaryModalSubtitle: "Learn about basic electronics components",
                exerciseSelectorModalTitle: "🎯 Select Exercise",
                exerciseSelectorModalSubtitle: "Choose the exercise you want to perform",
                multimeterGuideModalTitle: "🔧 Multimeter Parts and Functions",
                multimeterGuideModalSubtitle: "Learn about each component and function of your digital multimeter",
                closeButton: "×",
                
                // Educational panel
                educationalPanelTitle: "Concepts of",
                whatIs: "🔬 What is it?",
                analogy: "🌊 Analogy",
                units: "📏 Units", 
                howToMeasure: "🔧 How to measure",
                safety: "⚠️ Safety",
                calculation: "🧮 Calculation",
                realWorld: "🌍 Real world",
                hideExplanation: "Hide Explanation",
                
                // Button texts
                selectExerciseBtn: "Select Exercise",
                verifyMeasurementBtn: "Verify Measurement",
                checkConnectionBtn: "Check if the connection is correct",
                detailedExplanationBtn: "Detailed Explanation",
                conceptsTheoryBtn: "Concepts and theory",
                technicalGlossaryBtn: "Technical Glossary",
                componentsTermsBtn: "Components and terms",
                multimeterPartsBtn: "Multimeter Parts",
                functionsComponentsBtn: "Functions and components",
                masteryContinueBtn: "Great! Continue",
                masteryResetBtn: "Reset Exercises",
                
                // Multimeter guide
                multimeterGuide: {
                    whatIsTitle: "What is a Multimeter?",
                    whatIsDescription: "A multimeter is an electronic measuring instrument that combines several functions in a single device. It is the most important tool for anyone working with electricity and electronics, from professional technicians to students and hobbyists.",
                    mainPartsTitle: "Main Parts of the Multimeter",
                    functionLabel: "Function",
                    featuresLabel: "Features",
                    
                    display: {
                        title: "Digital Display",
                        subtitle: "Shows measurements",
                        function: "Displays the numerical value of the current measurement with up to 4 digits of precision.",
                        features: [
                            "LCD display with optional backlight",
                            "Unit indicators (V, A, Ω, µF, etc.)",
                            "Status symbols (AUTO, HOLD, low battery)",
                            "Polarity indicator (+ / -)"
                        ]
                    },
                    
                    selector: {
                        title: "Rotary Selector",
                        subtitle: "Selects measurement mode",
                        function: "Allows you to select what type of measurement to perform and the appropriate range.",
                        positionsLabel: "Main positions",
                        positions: [
                            "Off (saves battery)",
                            "AC Voltage (alternating current)",
                            "DC Voltage (direct current)",
                            "Current (amperes)",
                            "Resistance (ohms)",
                            "Continuity (beep)",
                            "Capacitance (microfarads)"
                        ]
                    },
                    
                    ports: {
                        title: "Connection Ports",
                        subtitle: "Where probes connect",
                        function: "Connectors where test probes are inserted according to the type of measurement.",
                        typicalLabel: "Typical ports",
                        black: "Black",
                        red: "Red",
                        types: [
                            "Common/negative - always connect black probe",
                            "For voltage, resistance and low current",
                            "For high currents (up to 10 amperes)",
                            "For temperature probe (some models)"
                        ]
                    },
                    
                    probes: {
                        title: "Test Probes",
                        subtitle: "Connection cables",
                        function: "Flexible cables that connect the multimeter to the circuit measurement points.",
                        redLabel: "Red Probe (+)",
                        blackLabel: "Black Probe (-)",
                        insulationLabel: "Insulation",
                        interchangeableLabel: "Interchangeable tips",
                        features: [
                            "Positive, connects to VΩmA or 10A port",
                            "Negative/common, always to COM port",
                            "Protection up to 1000V typically",
                            "Needle, hook, alligator clip"
                        ]
                    },
                    
                    buttons: {
                        title: "Function Buttons",
                        subtitle: "Additional controls",
                        function: "Buttons that activate special functions and multimeter settings.",
                        commonLabel: "Common buttons",
                        common: [
                            "Freezes the reading on screen",
                            "Automatic range selection",
                            "Activates/deactivates backlight",
                            "Resets the multimeter",
                            "Records minimum and maximum values"
                        ]
                    },
                    
                    battery: {
                        title: "Battery Compartment",
                        subtitle: "Power source",
                        function: "Houses the battery that powers the multimeter for operation.",
                        typicalLabel: "Typical battery",
                        durationLabel: "Duration",
                        indicatorLabel: "Indicator",
                        autoOffLabel: "Auto-off",
                        features: [
                            "9V alkaline or AA/AAA",
                            "200-1000 hours depending on use",
                            "Low battery symbol on display",
                            "Automatically turns off to save energy"
                        ]
                    },
                    
                    mainFunctionsTitle: "Main Measurement Functions",
                    
                    voltage: {
                        title: "Voltage Measurement (V)",
                        whatLabel: "What does it measure?",
                        what: "The electrical potential difference between two points.",
                        howLabel: "How to connect:",
                        how: "In parallel (alongside) the component or source.",
                        rangesLabel: "Typical ranges:",
                        ranges: "200mV, 2V, 20V, 200V, 1000V",
                        applicationsLabel: "Applications:",
                        applications: "Check batteries, power supplies, voltage drops."
                    },
                    
                    current: {
                        title: "Current Measurement (A)",
                        whatLabel: "What does it measure?",
                        what: "The flow of electrons through a conductor.",
                        howLabel: "How to connect:",
                        how: "In series (interrupting) the circuit.",
                        rangesLabel: "Typical ranges:",
                        ranges: "200µA, 2mA, 20mA, 200mA, 10A",
                        applicationsLabel: "Applications:",
                        applications: "Check device consumption, detect short circuits.",
                        unit: "Amperes"
                    },
                    
                    resistance: {
                        title: "Resistance Measurement (Ω)",
                        whatLabel: "What does it measure?",
                        what: "The opposition to electrical current flow.",
                        howLabel: "How to connect:",
                        how: "With the component disconnected from the circuit.",
                        rangesLabel: "Typical ranges:",
                        ranges: "200Ω, 2kΩ, 20kΩ, 200kΩ, 2MΩ",
                        applicationsLabel: "Applications:",
                        applications: "Check resistors, detect open circuits.",
                        unit: "Ohms"
                    },
                    
                    continuity: {
                        title: "Continuity Test (♪)",
                        whatLabel: "What does it verify?",
                        what: "If there is a conductive path between two points.",
                        howLabel: "How it works:",
                        how: "Emits a beep if there is continuity (low resistance).",
                        thresholdLabel: "Typical threshold:",
                        threshold: "Beep if resistance < 50Ω",
                        applicationsLabel: "Applications:",
                        applications: "Check cables, fuses, soldered connections.",
                        unit: "Beep"
                    },
                    
                    capacitance: {
                        title: "Capacitance Measurement (µF)",
                        whatLabel: "What does it measure?",
                        what: "The ability to store electrical charge.",
                        howLabel: "How to connect:",
                        how: "With the capacitor disconnected and discharged.",
                        rangesLabel: "Typical ranges:",
                        ranges: "2nF, 20nF, 200nF, 2µF, 20µF, 200µF",
                        applicationsLabel: "Applications:",
                        applications: "Check capacitors in power supplies, filters.",
                        unit: "Farads"
                    },
                    
                    safetyTitle: "Important Safety Tips",
                    safety: {
                        connections: {
                            title: "Correct Connections",
                            tips: [
                                "Always connect the black probe to COM port",
                                "Use the correct port according to measurement",
                                "For currents >200mA, use the 10A port",
                                "Never measure current in parallel"
                            ]
                        },
                        highVoltage: {
                            title: "High Voltages",
                            tips: [
                                "Never touch bare wires",
                                "Use probes with adequate insulation",
                                "Check the range before measuring",
                                "Be careful with voltages >50V"
                            ]
                        },
                        maintenance: {
                            title: "Maintenance",
                            tips: [
                                "Turn off the multimeter after use",
                                "Replace the battery when necessary",
                                "Store probes in a safe place",
                                "Calibrate periodically if professional"
                            ]
                        }
                    },
                    
                    practicalTitle: "Practical Tips for Better Measurements",
                    practical: {
                        precision: {
                            title: "Precision",
                            tips: [
                                "Use the smallest possible range",
                                "Wait for the reading to stabilize",
                                "Maintain good connection with probes",
                                "Avoid electromagnetic interference"
                            ]
                        },
                        technique: {
                            title: "Technique",
                            tips: [
                                "Clean contact points",
                                "Use HOLD function for difficult readings",
                                "Check polarity in DC",
                                "Discharge capacitors before measuring"
                            ]
                        },
                        interpretation: {
                            title: "Interpretation",
                            tips: [
                                "Understand the units displayed",
                                "Consider component tolerance",
                                "Compare with expected values",
                                "Document important measurements"
                            ]
                        }
                    }
                }
            }
        };

        const batteries = [
            { name: "9V", voltage: 9.00, width: 60, height: 40, type: "rectangular", color: "#2c3e50" },
            { name: "AA 1.5V", voltage: 1.50, width: 50, height: 35, type: "cylindrical", color: "#34495e" },
            { name: "Coche 12V", voltage: 12.00, width: 70, height: 45, type: "car", color: "#1a252f" },
            { name: "3.7V Li-ion", voltage: 3.70, width: 65, height: 42, type: "lithium", color: "#2980b9" },
            { name: "6V Linterna", voltage: 6.00, width: 55, height: 38, type: "lantern", color: "#8e44ad" }
        ];

        const resistors = [
            { name: "100Ω", resistance: 100, tolerance: "5%", power: "1/4W", colors: ["#8B4513", "#000000", "#8B4513", "#FFD700"] },
            { name: "220Ω", resistance: 220, tolerance: "5%", power: "1/4W", colors: ["#FF0000", "#FF0000", "#8B4513", "#FFD700"] },
            { name: "1kΩ", resistance: 1000, tolerance: "5%", power: "1/4W", colors: ["#8B4513", "#000000", "#FF0000", "#FFD700"] },
            { name: "4.7kΩ", resistance: 4700, tolerance: "5%", power: "1/4W", colors: ["#FFFF00", "#9370DB", "#FF0000", "#FFD700"] },
            { name: "10kΩ", resistance: 10000, tolerance: "5%", power: "1/4W", colors: ["#8B4513", "#000000", "#FFA500", "#FFD700"] }
        ];

        const leds = [
            { name: "LED Rojo", color: "#ff6b6b", voltage: 2.1, wavelength: "630nm", current: 20 },
            { name: "LED Verde", color: "#51cf66", voltage: 2.2, wavelength: "525nm", current: 20 },
            { name: "LED Azul", color: "#339af0", voltage: 3.2, wavelength: "470nm", current: 20 },
            { name: "LED Amarillo", color: "#ffd43b", voltage: 2.0, wavelength: "590nm", current: 20 },
            { name: "LED Blanco", color: "#f8f9fa", voltage: 3.3, wavelength: "Full", current: 20 },
            { name: "LED Naranja", color: "#ff922b", voltage: 2.0, wavelength: "605nm", current: 20 }
        ];

        const capacitors = [
            { name: "100µF", capacitance: 100e-6, voltage: "25V", width: 50, height: 45, type: "electrolytic", color: "#9b59b6" },
            { name: "10nF", capacitance: 10e-9, voltage: "50V", width: 45, height: 40, type: "ceramic", color: "#e67e22" },
            { name: "1mF", capacitance: 1e-3, voltage: "16V", width: 55, height: 50, type: "film", color: "#3498db" },
            { name: "470µF", capacitance: 470e-6, voltage: "35V", width: 52, height: 48, type: "electrolytic", color: "#8e44ad" },
            { name: "22pF", capacitance: 22e-12, voltage: "100V", width: 40, height: 35, type: "ceramic", color: "#f39c12" }
        ];

        // Base de datos del glosario de componentes electrónicos
        const componentsGlossary = {
            es: [
                {
                    name: "Resistor",
                    subtitle: "Resistencia Eléctrica",
                    icon: "🔧",
                    emoji: "⚡",
                    definition: "Un resistor (o resistencia) es un componente electrónico pasivo que se opone al flujo de corriente eléctrica. Su función principal es limitar, controlar o dividir la corriente en un circuito. Cuando la corriente pasa a través de un resistor, parte de la energía eléctrica se convierte en calor. Los resistores son fundamentales en casi todos los circuitos electrónicos para proteger componentes sensibles, establecer niveles de voltaje y controlar la corriente.",
                    symbol: `<svg width="80" height="50" viewBox="0 0 80 50">
                        <!-- Cuerpo del resistor -->
                        <rect x="20" y="20" width="40" height="12" fill="#d4af37" stroke="#b8860b" stroke-width="2" rx="3"/>
                        <!-- Bandas de colores (código de resistencia) -->
                        <rect x="24" y="18" width="3" height="16" fill="#8B4513"/>
                        <rect x="30" y="18" width="3" height="16" fill="#000000"/>
                        <rect x="36" y="18" width="3" height="16" fill="#8B4513"/>
                        <rect x="50" y="18" width="2" height="16" fill="#FFD700"/>
                        <!-- Terminales -->
                        <line x1="0" y1="26" x2="20" y2="26" stroke="#95a5a6" stroke-width="3"/>
                        <line x1="60" y1="26" x2="80" y2="26" stroke="#95a5a6" stroke-width="3"/>
                        <!-- Etiqueta -->
                        <text x="40" y="45" text-anchor="middle" font-size="10" fill="#2c3e50" font-weight="bold">R</text>
                    </svg>`,
                    specs: [
                        "Unidad de medida: Ohmios (Ω), kiloohmios (kΩ), megaohmios (MΩ)",
                        "Valores estándar: 1Ω a 100MΩ (serie E12, E24, E96)",
                        "Potencia nominal: 1/8W, 1/4W, 1/2W, 1W, 2W, 5W, 10W, 25W+",
                        "Tolerancia: ±0.1%, ±0.5%, ±1%, ±2%, ±5%, ±10%, ±20%",
                        "Tipos: Carbón, película metálica, wirewound, SMD",
                        "Coeficiente de temperatura: 50-500 ppm/°C",
                        "Código de colores: 4, 5 o 6 bandas para identificación",
                        "Aplicaciones: Limitación de corriente, divisores de voltaje, pull-up/pull-down"
                    ]
                },
                {
                    name: "Condensador",
                    subtitle: "Capacitor - Almacenador de Energía",
                    icon: "⚡",
                    emoji: "🔋",
                    definition: "Un condensador (también llamado capacitor) es un componente electrónico que almacena energía eléctrica en forma de campo eléctrico entre dos placas conductoras separadas por un material aislante llamado dieléctrico. Puede cargarse rápidamente cuando se aplica voltaje y descargarse cuando se necesita energía. Los condensadores son esenciales para filtrar señales, estabilizar voltajes, acoplar señales AC y proporcionar energía instantánea en circuitos.",
                    symbol: `<svg width="80" height="50" viewBox="0 0 80 50">
                        <!-- Placas del condensador -->
                        <line x1="30" y1="12" x2="30" y2="38" stroke="#2c3e50" stroke-width="4"/>
                        <line x1="50" y1="12" x2="50" y2="38" stroke="#2c3e50" stroke-width="4"/>
                        <!-- Terminales -->
                        <line x1="0" y1="25" x2="30" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <line x1="50" y1="25" x2="80" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <!-- Indicador de polaridad (para electrolíticos) -->
                        <text x="22" y="20" text-anchor="middle" font-size="12" fill="#e74c3c" font-weight="bold">+</text>
                        <text x="58" y="20" text-anchor="middle" font-size="12" fill="#2c3e50" font-weight="bold">-</text>
                        <!-- Etiqueta -->
                        <text x="40" y="45" text-anchor="middle" font-size="10" fill="#2c3e50" font-weight="bold">C</text>
                    </svg>`,
                    specs: [
                        "Unidad de medida: Faradios (F), microfaradios (µF), nanofaradios (nF), picofaradios (pF)",
                        "Valores típicos: 1pF a 100,000µF (0.1F)",
                        "Voltaje de trabajo: 6.3V, 10V, 16V, 25V, 50V, 100V, 400V, 1000V+",
                        "Tipos principales: Cerámico, electrolítico, tántalo, film (poliéster, polipropileno)",
                        "Tolerancia: ±1%, ±5%, ±10%, ±20%, -20%/+80%",
                        "Temperatura de operación: -55°C a +125°C (según tipo)",
                        "ESR (Resistencia Serie Equivalente): 0.01Ω a 10Ω",
                        "Polaridad: Polarizados (electrolíticos) y no polarizados (cerámicos, film)",
                        "Aplicaciones: Filtros, acoplamiento AC, fuentes de alimentación, temporizadores"
                    ]
                },
                {
                    name: "LED",
                    subtitle: "Diodo Emisor de Luz",
                    icon: "💡",
                    emoji: "🌟",
                    definition: "Un LED (Light Emitting Diode) es un dispositivo semiconductor que convierte energía eléctrica directamente en luz visible mediante un proceso llamado electroluminiscencia. A diferencia de las bombillas incandescentes que producen luz por calentamiento, los LEDs son extremadamente eficientes y duraderos. Solo permiten el paso de corriente en una dirección (del ánodo al cátodo) y requieren una corriente limitada para funcionar correctamente sin dañarse.",
                    symbol: `<svg width="80" height="50" viewBox="0 0 80 50">
                        <!-- Cuerpo del diodo -->
                        <polygon points="25,18 40,25 25,32" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                        <line x1="40" y1="18" x2="40" y2="32" stroke="#2c3e50" stroke-width="3"/>
                        <!-- Terminales -->
                        <line x1="0" y1="25" x2="25" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <line x1="40" y1="25" x2="80" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <!-- Rayos de luz -->
                        <path d="M 45 15 L 52 8 M 50 8 L 52 8 L 52 10" stroke="#f39c12" stroke-width="2" fill="none"/>
                        <path d="M 48 18 L 55 11 M 53 11 L 55 11 L 55 13" stroke="#f39c12" stroke-width="2" fill="none"/>
                        <path d="M 45 35 L 52 42 M 50 42 L 52 42 L 52 40" stroke="#f39c12" stroke-width="2" fill="none"/>
                        <path d="M 48 32 L 55 39 M 53 39 L 55 39 L 55 37" stroke="#f39c12" stroke-width="2" fill="none"/>
                        <!-- Etiquetas de terminales -->
                        <text x="15" y="20" text-anchor="middle" font-size="8" fill="#e74c3c" font-weight="bold">A</text>
                        <text x="65" y="20" text-anchor="middle" font-size="8" fill="#2c3e50" font-weight="bold">K</text>
                        <!-- Etiqueta -->
                        <text x="40" y="45" text-anchor="middle" font-size="10" fill="#2c3e50" font-weight="bold">LED</text>
                    </svg>`,
                    specs: [
                        "Voltaje directo (Vf): Rojo 1.8-2.2V, Verde 2.0-2.4V, Azul/Blanco 3.0-3.4V",
                        "Corriente directa típica (If): 20mA (estándar), 350mA-1A (alta potencia)",
                        "Corriente máxima: 30-50mA (LEDs estándar)",
                        "Potencia: 0.06W (estándar) a 100W+ (alta potencia)",
                        "Eficiencia luminosa: 80-200 lm/W (vs 15 lm/W incandescente)",
                        "Vida útil: 25,000-100,000 horas",
                        "Temperatura de operación: -40°C a +85°C",
                        "Colores disponibles: Rojo, verde, azul, amarillo, blanco, infrarrojo, UV",
                        "Tipos: Through-hole (5mm, 3mm), SMD (0603, 0805, 1206), COB, alta potencia",
                        "Aplicaciones: Indicadores, iluminación, pantallas, comunicación óptica"
                    ]
                },
                {
                    name: "Batería",
                    subtitle: "Fuente de Energía Portátil",
                    icon: "🔋",
                    emoji: "⚡",
                    definition: "Una batería es un dispositivo electroquímico que convierte energía química almacenada en energía eléctrica mediante reacciones redox. Consiste en una o más celdas electroquímicas, cada una con un ánodo (terminal negativo), un cátodo (terminal positivo) y un electrolito. Las baterías proporcionan energía portátil y pueden ser primarias (desechables) o secundarias (recargables). Son fundamentales para alimentar dispositivos portátiles y sistemas de respaldo.",
                    symbol: `<svg width="80" height="50" viewBox="0 0 80 50">
                        <!-- Celdas de la batería -->
                        <line x1="25" y1="15" x2="25" y2="35" stroke="#2c3e50" stroke-width="5"/>
                        <line x1="32" y1="12" x2="32" y2="38" stroke="#2c3e50" stroke-width="3"/>
                        <line x1="48" y1="12" x2="48" y2="38" stroke="#2c3e50" stroke-width="3"/>
                        <line x1="55" y1="15" x2="55" y2="35" stroke="#2c3e50" stroke-width="5"/>
                        <!-- Terminales -->
                        <line x1="0" y1="25" x2="25" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <line x1="55" y1="25" x2="80" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <!-- Símbolos de polaridad -->
                        <text x="18" y="30" text-anchor="middle" font-size="14" fill="#e74c3c" font-weight="bold">-</text>
                        <text x="62" y="30" text-anchor="middle" font-size="14" fill="#27ae60" font-weight="bold">+</text>
                        <!-- Indicador de voltaje -->
                        <rect x="30" y="8" width="20" height="8" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="2"/>
                        <text x="40" y="14" text-anchor="middle" font-size="8" fill="#2c3e50" font-weight="bold">9V</text>
                        <!-- Etiqueta -->
                        <text x="40" y="45" text-anchor="middle" font-size="10" fill="#2c3e50" font-weight="bold">BAT</text>
                    </svg>`,
                    specs: [
                        "Voltajes estándar: 1.2V (NiMH), 1.5V (AA/AAA), 3V (CR2032), 3.7V (Li-ion), 9V, 12V",
                        "Capacidad: mAh (miliamperios-hora) o Ah (amperios-hora)",
                        "Tipos primarios: Zinc-carbón, alcalina, litio",
                        "Tipos secundarios: NiMH, Li-ion, Li-Po, plomo-ácido",
                        "Densidad energética: 100-250 Wh/kg (Li-ion) vs 30-50 Wh/kg (plomo)",
                        "Ciclos de carga: 300-500 (NiMH), 500-1500 (Li-ion)",
                        "Autodescarga: 1-5% mensual (Li-ion), 20% mensual (NiMH)",
                        "Temperatura de operación: -20°C a +60°C (varía según tipo)",
                        "Formatos comunes: AA, AAA, 9V, 18650, CR2032, celdas prismáticas",
                        "Aplicaciones: Dispositivos portátiles, vehículos eléctricos, UPS, almacenamiento solar"
                    ]
                }
            ],
            en: [
                {
                    name: "Resistor",
                    subtitle: "Electrical Resistance",
                    icon: "🔧",
                    emoji: "⚡",
                    definition: "A resistor is a passive electronic component that opposes the flow of electric current. Its main function is to limit, control, or divide current in a circuit. When current passes through a resistor, part of the electrical energy is converted to heat. Resistors are fundamental in almost all electronic circuits to protect sensitive components, establish voltage levels, and control current flow.",
                    symbol: `<svg width="80" height="50" viewBox="0 0 80 50">
                        <!-- Resistor body -->
                        <rect x="20" y="20" width="40" height="12" fill="#d4af37" stroke="#b8860b" stroke-width="2" rx="3"/>
                        <!-- Color bands (resistance code) -->
                        <rect x="24" y="18" width="3" height="16" fill="#8B4513"/>
                        <rect x="30" y="18" width="3" height="16" fill="#000000"/>
                        <rect x="36" y="18" width="3" height="16" fill="#8B4513"/>
                        <rect x="50" y="18" width="2" height="16" fill="#FFD700"/>
                        <!-- Terminals -->
                        <line x1="0" y1="26" x2="20" y2="26" stroke="#95a5a6" stroke-width="3"/>
                        <line x1="60" y1="26" x2="80" y2="26" stroke="#95a5a6" stroke-width="3"/>
                        <!-- Label -->
                        <text x="40" y="45" text-anchor="middle" font-size="10" fill="#2c3e50" font-weight="bold">R</text>
                    </svg>`,
                    specs: [
                        "Unit of measurement: Ohms (Ω), kiloohms (kΩ), megaohms (MΩ)",
                        "Standard values: 1Ω to 100MΩ (E12, E24, E96 series)",
                        "Power rating: 1/8W, 1/4W, 1/2W, 1W, 2W, 5W, 10W, 25W+",
                        "Tolerance: ±0.1%, ±0.5%, ±1%, ±2%, ±5%, ±10%, ±20%",
                        "Types: Carbon, metal film, wirewound, SMD",
                        "Temperature coefficient: 50-500 ppm/°C",
                        "Color code: 4, 5 or 6 bands for identification",
                        "Applications: Current limiting, voltage dividers, pull-up/pull-down"
                    ]
                },
                {
                    name: "Capacitor",
                    subtitle: "Energy Storage Device",
                    icon: "⚡",
                    emoji: "🔋",
                    definition: "A capacitor is an electronic component that stores electrical energy in the form of an electric field between two conductive plates separated by an insulating material called a dielectric. It can charge quickly when voltage is applied and discharge when energy is needed. Capacitors are essential for filtering signals, stabilizing voltages, coupling AC signals, and providing instantaneous energy in circuits.",
                    symbol: `<svg width="80" height="50" viewBox="0 0 80 50">
                        <!-- Capacitor plates -->
                        <line x1="30" y1="12" x2="30" y2="38" stroke="#2c3e50" stroke-width="4"/>
                        <line x1="50" y1="12" x2="50" y2="38" stroke="#2c3e50" stroke-width="4"/>
                        <!-- Terminals -->
                        <line x1="0" y1="25" x2="30" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <line x1="50" y1="25" x2="80" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <!-- Polarity indicator (for electrolytics) -->
                        <text x="22" y="20" text-anchor="middle" font-size="12" fill="#e74c3c" font-weight="bold">+</text>
                        <text x="58" y="20" text-anchor="middle" font-size="12" fill="#2c3e50" font-weight="bold">-</text>
                        <!-- Label -->
                        <text x="40" y="45" text-anchor="middle" font-size="10" fill="#2c3e50" font-weight="bold">C</text>
                    </svg>`,
                    specs: [
                        "Unit of measurement: Farads (F), microfarads (µF), nanofarads (nF), picofarads (pF)",
                        "Typical values: 1pF to 100,000µF (0.1F)",
                        "Working voltage: 6.3V, 10V, 16V, 25V, 50V, 100V, 400V, 1000V+",
                        "Main types: Ceramic, electrolytic, tantalum, film (polyester, polypropylene)",
                        "Tolerance: ±1%, ±5%, ±10%, ±20%, -20%/+80%",
                        "Operating temperature: -55°C to +125°C (depending on type)",
                        "ESR (Equivalent Series Resistance): 0.01Ω to 10Ω",
                        "Polarity: Polarized (electrolytic) and non-polarized (ceramic, film)",
                        "Applications: Filters, AC coupling, power supplies, timers"
                    ]
                },
                {
                    name: "LED",
                    subtitle: "Light Emitting Diode",
                    icon: "💡",
                    emoji: "🌟",
                    definition: "An LED (Light Emitting Diode) is a semiconductor device that converts electrical energy directly into visible light through a process called electroluminescence. Unlike incandescent bulbs that produce light by heating, LEDs are extremely efficient and durable. They only allow current to flow in one direction (from anode to cathode) and require limited current to function properly without damage.",
                    symbol: `<svg width="80" height="50" viewBox="0 0 80 50">
                        <!-- Diode body -->
                        <polygon points="25,18 40,25 25,32" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                        <line x1="40" y1="18" x2="40" y2="32" stroke="#2c3e50" stroke-width="3"/>
                        <!-- Terminals -->
                        <line x1="0" y1="25" x2="25" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <line x1="40" y1="25" x2="80" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <!-- Light rays -->
                        <path d="M 45 15 L 52 8 M 50 8 L 52 8 L 52 10" stroke="#f39c12" stroke-width="2" fill="none"/>
                        <path d="M 48 18 L 55 11 M 53 11 L 55 11 L 55 13" stroke="#f39c12" stroke-width="2" fill="none"/>
                        <path d="M 45 35 L 52 42 M 50 42 L 52 42 L 52 40" stroke="#f39c12" stroke-width="2" fill="none"/>
                        <path d="M 48 32 L 55 39 M 53 39 L 55 39 L 55 37" stroke="#f39c12" stroke-width="2" fill="none"/>
                        <!-- Terminal labels -->
                        <text x="15" y="20" text-anchor="middle" font-size="8" fill="#e74c3c" font-weight="bold">A</text>
                        <text x="65" y="20" text-anchor="middle" font-size="8" fill="#2c3e50" font-weight="bold">K</text>
                        <!-- Label -->
                        <text x="40" y="45" text-anchor="middle" font-size="10" fill="#2c3e50" font-weight="bold">LED</text>
                    </svg>`,
                    specs: [
                        "Forward voltage (Vf): Red 1.8-2.2V, Green 2.0-2.4V, Blue/White 3.0-3.4V",
                        "Typical forward current (If): 20mA (standard), 350mA-1A (high power)",
                        "Maximum current: 30-50mA (standard LEDs)",
                        "Power: 0.06W (standard) to 100W+ (high power)",
                        "Luminous efficiency: 80-200 lm/W (vs 15 lm/W incandescent)",
                        "Lifespan: 25,000-100,000 hours",
                        "Operating temperature: -40°C to +85°C",
                        "Available colors: Red, green, blue, yellow, white, infrared, UV",
                        "Types: Through-hole (5mm, 3mm), SMD (0603, 0805, 1206), COB, high power",
                        "Applications: Indicators, lighting, displays, optical communication"
                    ]
                },
                {
                    name: "Battery",
                    subtitle: "Portable Energy Source",
                    icon: "🔋",
                    emoji: "⚡",
                    definition: "A battery is an electrochemical device that converts stored chemical energy into electrical energy through redox reactions. It consists of one or more electrochemical cells, each with an anode (negative terminal), a cathode (positive terminal), and an electrolyte. Batteries provide portable energy and can be primary (disposable) or secondary (rechargeable). They are fundamental for powering portable devices and backup systems.",
                    symbol: `<svg width="80" height="50" viewBox="0 0 80 50">
                        <!-- Battery cells -->
                        <line x1="25" y1="15" x2="25" y2="35" stroke="#2c3e50" stroke-width="5"/>
                        <line x1="32" y1="12" x2="32" y2="38" stroke="#2c3e50" stroke-width="3"/>
                        <line x1="48" y1="12" x2="48" y2="38" stroke="#2c3e50" stroke-width="3"/>
                        <line x1="55" y1="15" x2="55" y2="35" stroke="#2c3e50" stroke-width="5"/>
                        <!-- Terminals -->
                        <line x1="0" y1="25" x2="25" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <line x1="55" y1="25" x2="80" y2="25" stroke="#95a5a6" stroke-width="3"/>
                        <!-- Polarity symbols -->
                        <text x="18" y="30" text-anchor="middle" font-size="14" fill="#e74c3c" font-weight="bold">-</text>
                        <text x="62" y="30" text-anchor="middle" font-size="14" fill="#27ae60" font-weight="bold">+</text>
                        <!-- Voltage indicator -->
                        <rect x="30" y="8" width="20" height="8" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="2"/>
                        <text x="40" y="14" text-anchor="middle" font-size="8" fill="#2c3e50" font-weight="bold">9V</text>
                        <!-- Label -->
                        <text x="40" y="45" text-anchor="middle" font-size="10" fill="#2c3e50" font-weight="bold">BAT</text>
                    </svg>`,
                    specs: [
                        "Standard voltages: 1.2V (NiMH), 1.5V (AA/AAA), 3V (CR2032), 3.7V (Li-ion), 9V, 12V",
                        "Capacity: mAh (milliamp-hours) or Ah (amp-hours)",
                        "Primary types: Zinc-carbon, alkaline, lithium",
                        "Secondary types: NiMH, Li-ion, Li-Po, lead-acid",
                        "Energy density: 100-250 Wh/kg (Li-ion) vs 30-50 Wh/kg (lead)",
                        "Charge cycles: 300-500 (NiMH), 500-1500 (Li-ion)",
                        "Self-discharge: 1-5% monthly (Li-ion), 20% monthly (NiMH)",
                        "Operating temperature: -20°C to +60°C (varies by type)",
                        "Common formats: AA, AAA, 9V, 18650, CR2032, prismatic cells",
                        "Applications: Portable devices, electric vehicles, UPS, solar storage"
                    ]
                }
            ]
        };

        // Configuraciones de circuitos para cada ejercicio con posiciones específicas
        const circuitConfigs = {
            battery: {
                components: [
                    { type: 'battery', x: 200, y: 100 }
                ],
                points: [
                    { id: 1, x: 180, y: 120, label: "BAT+", description: "Terminal positivo de la batería" },
                    { id: 2, x: 320, y: 120, label: "BAT-", description: "Terminal negativo de la batería" }
                ],
                connections: []
            },
            resistor: {
                components: [
                    { type: 'resistor', x: 250, y: 120 }
                ],
                points: [
                    { id: 1, x: 230, y: 120, label: "R1", description: "Terminal izquierdo del resistor" },
                    { id: 2, x: 310, y: 120, label: "R2", description: "Terminal derecho del resistor" }
                ],
                connections: []
            },
            led: {
                components: [
                    { type: 'battery', x: 80, y: 100 },
                    { type: 'resistor', x: 200, y: 120 },
                    { type: 'led', x: 350, y: 100 }
                ],
                points: [
                    { id: 1, x: 60, y: 120, label: "BAT+", description: "Terminal positivo de la batería" },
                    { id: 2, x: 280, y: 120, label: "R-LED", description: "Entre resistor y LED" },
                    { id: 3, x: 420, y: 120, label: "LED-", description: "Después del LED" },
                    { id: 4, x: 60, y: 200, label: "BAT-", description: "Terminal negativo de la batería" }
                ],
                connections: [
                    { from: [140, 120], to: [180, 120], type: "wire" },
                    { from: [240, 120], to: [330, 120], type: "wire" },
                    { from: [390, 120], to: [450, 120], type: "wire" },
                    { from: [450, 120], to: [450, 200], type: "wire" },
                    { from: [450, 200], to: [60, 200], type: "wire" }
                ]
            },
            ledOnly: {
                components: [
                    { type: 'led', x: 250, y: 100 }
                ],
                points: [
                    { id: 1, x: 230, y: 120, label: "LED+", description: "Terminal positivo del LED (ánodo)" },
                    { id: 2, x: 290, y: 120, label: "LED-", description: "Terminal negativo del LED (cátodo)" }
                ],
                connections: []
            },
            capacitor: {
                components: [
                    { type: 'capacitor', x: 250, y: 100 }
                ],
                points: [
                    { id: 1, x: 230, y: 124, label: "CAP+", description: "Terminal positivo del condensador" },
                    { id: 2, x: 310, y: 124, label: "CAP-", description: "Terminal negativo del condensador" }
                ],
                connections: []
            },
            complete: {
                components: [
                    { type: 'battery', x: 50, y: 100 },
                    { type: 'resistor', x: 150, y: 120 },
                    { type: 'led', x: 280, y: 100 },
                    { type: 'capacitor', x: 420, y: 100 }
                ],
                points: [
                    { id: 1, x: 30, y: 120, label: "BAT+", description: "Terminal positivo de la batería" },
                    { id: 2, x: 130, y: 120, label: "R1", description: "Entrada del resistor" },
                    { id: 3, x: 210, y: 120, label: "R-LED", description: "Entre resistor y LED" },
                    { id: 4, x: 340, y: 120, label: "LED-CAP", description: "Entre LED y condensador" },
                    { id: 5, x: 480, y: 120, label: "CAP-", description: "Salida del condensador" },
                    { id: 6, x: 30, y: 200, label: "BAT-", description: "Terminal negativo de la batería" }
                ],
                connections: [
                    { from: [110, 120], to: [130, 120], type: "wire" },
                    { from: [190, 120], to: [260, 120], type: "wire" },
                    { from: [320, 120], to: [400, 120], type: "wire" },
                    { from: [480, 120], to: [520, 120], type: "wire" },
                    { from: [520, 120], to: [520, 200], type: "wire" },
                    { from: [520, 200], to: [30, 200], type: "wire" }
                ]
            }
        };

        const exercises = [
            {
                title: "Medir Voltaje de Batería",
                objective: "Mide cuántos voltios produce la batería y aprende conceptos fundamentales",
                mode: "Voltaje (V)",
                connection: "Conecta las puntas en los extremos de la batería (puntos 1 y 2)",
                hint: "Para medir voltaje, conecta el multímetro en paralelo (al lado) del componente",
                type: "voltage",
                circuit: "battery",
                correctPoints: [1, 2],
                expectedValue: "9.00",
                explanation: "¡Perfecto! La batería produce 9 voltios. El voltaje se mide en paralelo.",
                detailedExplanation: {
                    concept: "El voltaje es la diferencia de potencial eléctrico entre dos puntos, como la 'presión' eléctrica",
                    analogy: "Imagina el voltaje como la presión del agua en una manguera - cuanta más presión, más fuerte sale el agua",
                    units: "Se mide en Voltios (V). 1 Voltio = 1 Joule de energía por Coulomb de carga",
                    measurement: "Para medir voltaje, conecta el multímetro EN PARALELO (al lado) del componente, nunca en serie",
                    safety: "¡IMPORTANTE! Nunca toques cables pelados con voltajes altos - pueden ser peligrosos",
                    calculation: "En este circuito: V = 9V (voltaje nominal de la batería)",
                    realWorld: "9V es común en detectores de humo, 1.5V en pilas AA, 12V en baterías de coche"
                }
            },
            {
                title: "Medir Resistencia del Resistor",
                objective: "Mide el valor de la resistencia y aprende sobre la Ley de Ohm",
                mode: "Resistencia (Ω)",
                connection: "Conecta las puntas en los extremos del resistor (puntos 1 y 2)",
                hint: "Para medir resistencia, el componente debe estar desconectado del circuito",
                type: "resistance",
                circuit: "resistor",
                correctPoints: [1, 2],
                expectedValue: "100.0",
                explanation: "¡Muy bien! El resistor tiene 100 ohmios. La resistencia se mide sin energía.",
                detailedExplanation: {
                    concept: "La resistencia eléctrica es la oposición que presenta un material al paso de la corriente eléctrica",
                    analogy: "Imagina la resistencia como una tubería estrecha - cuanto más estrecha, más difícil es que pase el agua (corriente)",
                    units: "Se mide en Ohmios (Ω). 1 Ohmio = 1 Voltio / 1 Amperio según la Ley de Ohm",
                    measurement: "Para medir resistencia, el componente DEBE estar desconectado del circuito (sin energía)",
                    safety: "¡IMPORTANTE! Nunca midas resistencia con el circuito energizado - podrías dañar el multímetro",
                    calculation: "Ley de Ohm: R = V/I. En este caso: R = 100Ω (valor nominal del resistor)",
                    realWorld: "100Ω es común en LEDs, 1kΩ-10kΩ en circuitos digitales, MΩ en aislamiento eléctrico"
                }
            },
            {
                title: "Medir Corriente en el Circuito",
                objective: "Mide cuánta corriente fluye por el LED y aprende conceptos fundamentales",
                mode: "Corriente (A)",
                connection: "Conecta las puntas donde pasa la corriente (puntos 2 y 3)",
                hint: "Para medir corriente, el multímetro debe estar en serie (en el camino) de la corriente",
                type: "current",
                circuit: "led",
                correctPoints: [2, 3],
                expectedValue: "0.09",
                explanation: "¡Excelente! La corriente es 0.09 amperios. La corriente se mide en serie.",
                detailedExplanation: {
                    concept: "La corriente eléctrica es el flujo de electrones a través de un conductor",
                    analogy: "Imagina la corriente como el agua que fluye por una tubería - los electrones son como las gotas de agua moviéndose",
                    units: "Se mide en Amperios (A). 1 Amperio = 1 Coulomb de carga por segundo",
                    measurement: "Para medir corriente, el multímetro debe 'interrumpir' el circuito y convertirse en parte del camino",
                    safety: "¡IMPORTANTE! Nunca midas corriente en paralelo - podrías dañar el multímetro",
                    calculation: "En este circuito: I = V/R = 9V / 100Ω = 0.09A (Ley de Ohm)",
                    realWorld: "0.09A es suficiente para encender un LED pero muy poco para electrodomésticos"
                }
            },
            {
                title: "Medir Voltaje del LED",
                objective: "Mide la caída de voltaje a través del LED cuando está encendido",
                mode: "Voltaje (V)",
                connection: "Conecta las puntas en los extremos del LED (puntos 2 y 3)",
                hint: "El LED consume voltaje cuando está encendido - esto se llama 'caída de voltaje'",
                type: "voltage",
                circuit: "led",
                correctPoints: [2, 3],
                expectedValue: "2.10",
                explanation: "¡Perfecto! El LED tiene una caída de voltaje de 2.1V cuando está encendido.",
                detailedExplanation: {
                    concept: "La caída de voltaje es la diferencia de potencial que consume un componente activo",
                    analogy: "Como una cascada que 'consume' altura del agua, el LED 'consume' voltaje para producir luz",
                    units: "Se mide en Voltios (V). Cada color de LED tiene una caída de voltaje característica",
                    measurement: "Mide en paralelo con el LED mientras el circuito está energizado y funcionando",
                    safety: "Es seguro medir voltajes bajos como estos, pero siempre ten cuidado con las conexiones",
                    calculation: "V_LED = 2.1V (voltaje directo típico de un LED rojo)",
                    realWorld: "LEDs rojos: ~2.1V, verdes: ~2.2V, azules/blancos: ~3.2V"
                }
            },
            {
                title: "Medir Capacitancia",
                objective: "Mide el valor del condensador y aprende sobre almacenamiento de energía",
                mode: "Capacitancia (µF)",
                connection: "Conecta las puntas en los terminales del condensador (puntos 1 y 2)",
                hint: "Los condensadores almacenan energía eléctrica - descárgalo antes de medir",
                type: "capacitance",
                circuit: "capacitor",
                correctPoints: [1, 2],
                expectedValue: "100.0",
                explanation: "¡Excelente! El condensador tiene 100 microfaradios de capacitancia.",
                detailedExplanation: {
                    concept: "La capacitancia es la capacidad de un componente para almacenar carga eléctrica",
                    analogy: "Como un tanque de agua que puede almacenar más o menos agua según su tamaño",
                    units: "Se mide en Faradios (F), microfaradios (µF), nanofaradios (nF), picofaradios (pF)",
                    measurement: "Mide con el condensador desconectado del circuito y completamente descargado",
                    safety: "¡CUIDADO! Los condensadores grandes pueden mantener carga peligrosa - descárgalos primero",
                    calculation: "C = 100µF (capacitancia nominal del condensador electrolítico)",
                    realWorld: "100µF es común en fuentes de alimentación, 10nF en filtros, 22pF en osciladores"
                }
            },
            {
                title: "Verificar Continuidad",
                objective: "Verifica si hay un camino continuo para la corriente eléctrica",
                mode: "Continuidad (♪)",
                connection: "Conecta las puntas en los extremos del resistor (puntos 1 y 2)",
                hint: "La continuidad verifica si la electricidad puede fluir entre dos puntos",
                type: "continuity",
                circuit: "resistor",
                correctPoints: [1, 2],
                expectedValue: "♪",
                explanation: "¡Perfecto! Hay continuidad - el multímetro emite un pitido.",
                detailedExplanation: {
                    concept: "La continuidad verifica si existe un camino de baja resistencia entre dos puntos",
                    analogy: "Como verificar si una tubería está conectada de extremo a extremo sin obstrucciones",
                    units: "No tiene unidades - solo indica SÍ (♪) o NO (silencio)",
                    measurement: "El multímetro envía una pequeña corriente y verifica si puede completar el circuito",
                    safety: "Siempre verifica continuidad con el circuito SIN ENERGÍA para evitar daños",
                    calculation: "Resistencia < 50Ω típicamente = Continuidad (♪)",
                    realWorld: "Útil para verificar cables, fusibles, conexiones soldadas y trazas de PCB"
                }
            }
        ];

        // Función para crear componentes SVG
        function createComponent(type, x, y) {
            let svg = '';
            switch(type) {
                case 'battery':
                    const currentBat = batteries[currentBattery];
                    svg = `
                        <g transform="translate(${x}, ${y})" onclick="changeBattery()" style="cursor: pointer;" title="${translations[currentLanguage].batteryTooltip}">
                            <!-- Cuerpo principal de la batería -->
                            <rect x="0" y="0" width="80" height="40" fill="${currentBat.color}" stroke="#2c3e50" stroke-width="3" rx="4"/>
                            <!-- Terminal positivo -->
                            <rect x="80" y="8" width="12" height="24" fill="#e74c3c" rx="3"/>
                            <!-- Terminal negativo -->
                            <rect x="-12" y="14" width="12" height="12" fill="#34495e" rx="2"/>
                            <!-- Indicadores de polaridad -->
                            <text x="65" y="24" fill="white" font-size="16" font-weight="bold">+</text>
                            <text x="20" y="24" fill="white" font-size="16" font-weight="bold">-</text>
                            <!-- Etiqueta del voltaje y tipo -->
                            <rect x="15" y="50" width="50" height="22" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="11"/>
                            <text x="40" y="60" fill="#2c3e50" font-size="12" font-weight="bold" text-anchor="middle" id="battery-label">${currentBat.name}</text>
                            <text x="40" y="70" fill="#2c3e50" font-size="10" text-anchor="middle">${currentBat.voltage}V</text>
                        </g>
                    `;
                    break;
                case 'resistor':
                    const currentRes = resistors[currentResistor];
                    svg = `
                        <g transform="translate(${x}, ${y})" onclick="changeResistor()" style="cursor: pointer;" title="${translations[currentLanguage].resistorTooltip}">
                            <!-- Cuerpo principal del resistor -->
                            <rect x="0" y="-7" width="40" height="14" fill="#d4af37" stroke="#b8860b" stroke-width="2" rx="3"/>
                            <!-- Bandas de colores del código de resistencia -->
                            <rect x="4" y="-10" width="4" height="20" fill="${currentRes.colors[0]}"/>
                            <rect x="12" y="-10" width="4" height="20" fill="${currentRes.colors[1]}"/>
                            <rect x="20" y="-10" width="4" height="20" fill="${currentRes.colors[2]}"/>
                            <rect x="32" y="-10" width="3" height="20" fill="${currentRes.colors[3]}"/>
                            <!-- Terminales que se conectan directamente a los cables -->
                            <line x1="-20" y1="0" x2="0" y2="0" stroke="#95a5a6" stroke-width="4"/>
                            <line x1="40" y1="0" x2="60" y2="0" stroke="#95a5a6" stroke-width="4"/>
                            <!-- Etiqueta del valor -->
                            <rect x="-5" y="15" width="50" height="18" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="9"/>
                            <text x="20" y="27" fill="#2c3e50" font-size="12" text-anchor="middle" font-weight="bold" id="resistor-label">${currentRes.name}</text>
                        </g>
                    `;
                    break;
                case 'led':
                    const currentLed = leds[currentLED];
                    svg = `
                        <g transform="translate(${x}, ${y})" onclick="changeLED()" style="cursor: pointer;" title="${translations[currentLanguage].ledTooltip}">
                            <!-- Cuerpo principal del LED -->
                            <circle cx="20" cy="20" r="16" fill="${currentLed.color}" stroke="#2c3e50" stroke-width="3"/>
                            <!-- Efecto de brillo interno -->
                            <circle cx="20" cy="20" r="12" fill="${currentLed.color}" opacity="0.8"/>
                            <circle cx="20" cy="20" r="8" fill="#fff" opacity="0.6"/>
                            <circle cx="20" cy="20" r="4" fill="#fff" opacity="0.9"/>
                            <!-- Terminales -->
                            <line x1="20" y1="36" x2="20" y2="52" stroke="#95a5a6" stroke-width="4"/>
                            <line x1="14" y1="33" x2="14" y2="46" stroke="#95a5a6" stroke-width="4"/>
                            <!-- Rayos de luz -->
                            <path d="M 38 12 L 45 5 M 43 5 L 45 5 L 45 7" stroke="#f39c12" stroke-width="2" fill="none"/>
                            <path d="M 41 15 L 48 8 M 46 8 L 48 8 L 48 10" stroke="#f39c12" stroke-width="2" fill="none"/>
                            <path d="M 38 28 L 45 35 M 43 35 L 45 35 L 45 33" stroke="#f39c12" stroke-width="2" fill="none"/>
                            <path d="M 41 25 L 48 32 M 46 32 L 48 32 L 48 30" stroke="#f39c12" stroke-width="2" fill="none"/>
                            <!-- Etiqueta del LED -->
                            <rect x="-8" y="58" width="56" height="18" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="9"/>
                            <text x="20" y="70" fill="#2c3e50" font-size="11" text-anchor="middle" font-weight="bold" id="led-label">${currentLed.name}</text>
                        </g>
                    `;
                    break;
                case 'capacitor':
                    const currentCap = capacitors[currentCapacitor];
                    svg = `
                        <g transform="translate(${x}, ${y})" onclick="changeCapacitor()" style="cursor: pointer;" title="${translations[currentLanguage].capacitorTooltip}">
                            <!-- Placas del condensador -->
                            <rect x="16" y="8" width="6" height="32" fill="#2c3e50" stroke="#34495e" stroke-width="3"/>
                            <rect x="32" y="8" width="6" height="32" fill="#2c3e50" stroke="#34495e" stroke-width="3"/>
                            <!-- Terminales -->
                            <line x1="-8" y1="24" x2="16" y2="24" stroke="#95a5a6" stroke-width="4"/>
                            <line x1="38" y1="24" x2="62" y2="24" stroke="#95a5a6" stroke-width="4"/>
                            <!-- Indicadores de polaridad -->
                            <text x="8" y="18" fill="#e74c3c" font-size="16" font-weight="bold">+</text>
                            <text x="42" y="18" fill="#2c3e50" font-size="16" font-weight="bold">-</text>
                            <!-- Cuerpo del condensador con color variable -->
                            <rect x="12" y="5" width="28" height="38" fill="${currentCap.color}" stroke="#2c3e50" stroke-width="3" rx="14"/>
                            <rect x="12" y="5" width="12" height="38" fill="#e74c3c" opacity="0.7" rx="6"/>
                            <!-- Etiqueta del valor y voltaje -->
                            <rect x="4" y="48" width="44" height="22" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="11"/>
                            <text x="26" y="58" fill="#2c3e50" font-size="11" text-anchor="middle" font-weight="bold" id="capacitor-label">${currentCap.name}</text>
                            <text x="26" y="68" fill="#2c3e50" font-size="9" text-anchor="middle" font-weight="bold">${currentCap.voltage}</text>
                        </g>
                    `;
                    break;
            }
            return svg;
        }

        // Función para dibujar cables
        function drawWire(from, to) {
            return `<line x1="${from[0]}" y1="${from[1]}" x2="${to[0]}" y2="${to[1]}" stroke="#2c3e50" stroke-width="4" stroke-linecap="round"/>`;
        }

        // Función para crear puntos de medición
        function createMeasurementPoint(point) {
            return `
                <g class="measurement-point" data-point="${point.id}" style="cursor: pointer; pointer-events: all;" transform="translate(${point.x}, ${point.y})">
                    <circle cx="0" cy="0" r="16" fill="#3498db" stroke="white" stroke-width="5" style="pointer-events: all;" class="point-circle"/>
                    <circle cx="0" cy="0" r="20" fill="none" stroke="transparent" stroke-width="8" style="pointer-events: all;" class="point-hover-area"/>
                    <text x="0" y="6" fill="white" font-size="16" font-weight="bold" text-anchor="middle" style="pointer-events: none; user-select: none;" class="point-text">${point.id}</text>
                    <rect x="-35" y="-35" width="70" height="25" fill="rgba(0,0,0,0.8)" rx="6" opacity="0" class="point-tooltip" style="pointer-events: none;"/>
                    <text x="0" y="-25" fill="white" font-size="12" font-weight="bold" text-anchor="middle" opacity="0" class="point-tooltip-text" style="pointer-events: none; user-select: none;">${point.label}</text>
                </g>
            `;
        }

        // Función para renderizar el circuito
        function renderCircuit(circuitType) {
            const circuit = document.getElementById('circuit');
            const config = circuitConfigs[circuitType];
            
            if (!config) {
                circuit.innerHTML = '<p>Configuración de circuito no encontrada</p>';
                return;
            }

            // Crear el SVG con dimensiones apropiadas
            let svg = `
                <svg width="100%" height="280" viewBox="0 0 490 280" style="background: #ecf0f1; border-radius: 15px; border: 3px solid #bdc3c7; display: block; max-width: 100%;">
                    <!-- Fondo del circuito -->
                    <rect x="0" y="0" width="400" height="280" fill="#ecf0f1" rx="15"/>
                    
                    <!-- Cables de conexión -->
                    ${config.connections ? config.connections.map(conn => drawWire(conn.from, conn.to)).join('') : ''}
                    
                    <!-- Componentes del circuito -->
                    ${config.components ? config.components.map(comp => createComponent(comp.type, comp.x, comp.y)).join('') : ''}
                    
                    <!-- Puntos de medición interactivos -->
                    ${config.points ? config.points.map(point => createMeasurementPoint(point)).join('') : ''}
                </svg>
            `;

            circuit.innerHTML = svg;
            
            // Configurar eventos después de un pequeño delay para asegurar que el DOM esté listo
            setTimeout(() => {
                setupCircuitEvents();
            }, 100);
        }

        function setupCircuitEvents() {
            // Agregar eventos a los puntos de medición
            document.querySelectorAll('.measurement-point').forEach(point => {
                point.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const pointNum = parseInt(this.dataset.point);
                    
                    if (connectionState === 'red-selected') {
                        probeConnections.red = pointNum;
                        connectionState = 'red-connected';
                        updateProbeConnections();
                        updateProbeStatus();
                        
                        // Mostrar feedback visual
                        const t = translations[currentLanguage];
                        showFeedback('success', `${t.redProbeConnectedMsg} ${pointNum}`);
                        
                        // Actualizar visual para mostrar conexión roja
                        updateMeasurementPointsVisual('connections-made');
                        
                    } else if (connectionState === 'black-selected') {
                        probeConnections.black = pointNum;
                        connectionState = 'idle';
                        updateProbeConnections();
                        updateProbeStatus();
                        
                        // Mostrar feedback visual
                        const t = translations[currentLanguage];
                        showFeedback('success', `${t.blackProbeConnectedMsg} ${pointNum}`);
                        
                        // Actualizar visual para mostrar ambas conexiones
                        updateMeasurementPointsVisual('connections-made');
                        
                    } else {
                        // Si no hay punta seleccionada, dar instrucción
                        const t = translations[currentLanguage];
                        showFeedback('error', t.selectProbeFirst);
                    }
                    
                    updateDisplay();
                    updateSteps();
                });

                // Efectos hover para tooltips
                point.addEventListener('mouseenter', function() {
                    const tooltips = this.querySelectorAll('.point-tooltip, .point-tooltip-text');
                    tooltips.forEach(el => {
                        el.style.opacity = '1';
                        el.style.transition = 'opacity 0.2s ease';
                    });
                });

                point.addEventListener('mouseleave', function() {
                    const tooltips = this.querySelectorAll('.point-tooltip, .point-tooltip-text');
                    tooltips.forEach(el => {
                        el.style.opacity = '0';
                        el.style.transition = 'opacity 0.2s ease';
                    });
                });
            });
        }

        // Función para mostrar el selector de ejercicios
        function showExerciseSelector() {
            const modal = document.getElementById('exercise-selector-modal');
            const content = document.getElementById('exercise-selector-content');
            const t = translations[currentLanguage];
            
            // Generar las tarjetas de ejercicios usando las traducciones
            content.innerHTML = t.exercises.map((exercise, index) => {
                const isCompleted = completedExercises.has(index);
                const isCurrent = index === currentExercise;
                const statusIcon = isCompleted ? '✅' : (isCurrent ? '🎯' : '⭕');
                const cardClass = isCompleted ? 'completed' : (isCurrent ? 'current' : '');
                
                const modeLabel = currentLanguage === 'es' ? 'Modo:' : 'Mode:';
                const connectionLabel = currentLanguage === 'es' ? 'Conexión:' : 'Connection:';
                const hintLabel = currentLanguage === 'es' ? 'Pista:' : 'Hint:';
                
                return `
                    <div class="exercise-card ${cardClass}" onclick="selectExercise(${index})">
                        <div class="exercise-status">${statusIcon}</div>
                        <div class="exercise-header">
                            <div class="exercise-number">${index + 1}</div>
                            <div>
                                <h3 class="exercise-title">${exercise.title}</h3>
                            </div>
                        </div>
                        
                        <div class="exercise-objective">
                            ${exercise.objective}
                        </div>
                        
                        <div class="exercise-details">
                            <div class="exercise-detail">
                                <strong>🔧 ${modeLabel}</strong> ${exercise.mode}
                            </div>
                            <div class="exercise-detail">
                                <strong>📍 ${connectionLabel}</strong> ${exercise.connection}
                            </div>
                        </div>
                        
                        <div style="background: #fff3cd; padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 0.9rem;">
                            <strong>💡 ${hintLabel}</strong> ${exercise.hint}
                        </div>
                    </div>
                `;
            }).join('');
            
            modal.style.display = 'block';
        }

        function closeExerciseSelector() {
            document.getElementById('exercise-selector-modal').style.display = 'none';
        }

        function selectExercise(index) {
  // Quitar el estado "current" de todos los ejercicios
  document.querySelectorAll('.exercise-card').forEach(card => {
    card.classList.remove('current');
  });

  // Agregar el estado "current" al ejercicio seleccionado
  const selectedCard = document.querySelectorAll('.exercise-card')[index];
  if (selectedCard) {
    selectedCard.classList.add('current');
  }

  // Actualizar el índice y recargar contenido
  currentExercise = index;
  loadExercise();

  // Cerrar el modal (si quieres ver el resaltado antes de cerrar, puedes retrasarlo un poco)
  setTimeout(closeExerciseSelector, 150);
}


        // Función para mostrar el glosario
        function showGlossary() {
            const modal = document.getElementById('glossary-modal');
            const content = document.getElementById('glossary-content');
            const t = translations[currentLanguage];
            
            // Obtener el glosario en el idioma actual
            const currentGlossary = componentsGlossary[currentLanguage];
            
            // Generar las tarjetas de componentes
            content.innerHTML = currentGlossary.map(component => `
                <div class="component-card">
                    <div class="component-header">
                        <div class="component-icon">${component.icon}</div>
                        <div>
                            <h3 class="component-title">${component.name}</h3>
                            <p class="component-subtitle">${component.subtitle}</p>
                        </div>
                    </div>
                    
                    <div class="component-visual">
                        <div class="component-symbol">
                            <h4>${currentLanguage === 'es' ? 'Símbolo Esquemático' : 'Schematic Symbol'}</h4>
                            <div class="symbol-svg">${component.symbol}</div>
                        </div>
                        <div class="component-image">
                            <h4>${currentLanguage === 'es' ? 'Representación' : 'Representation'}</h4>
                            <div class="image-container">${component.emoji}</div>
                        </div>
                    </div>
                    
                    <div class="component-definition">
                        ${component.definition}
                    </div>
                    
                    <div class="component-specs">
                        <h4>📋 ${currentLanguage === 'es' ? 'Especificaciones Técnicas' : 'Technical Specifications'}</h4>
                        <ul class="specs-list">
                            ${component.specs.map(spec => `<li>${spec}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `).join('');
            
            modal.style.display = 'block';
        }

        function closeGlossary() {
            document.getElementById('glossary-modal').style.display = 'none';
        }

        // Función para mostrar la guía del multímetro
        function showMultimeterGuide() {
            const modal = document.getElementById('multimeter-guide-modal');
            const content = document.getElementById('multimeter-guide-content');
            
            // Generar el contenido de la guía
            content.innerHTML = generateMultimeterGuideContent();
            
            modal.style.display = 'block';
        }

        function closeMultimeterGuide() {
            document.getElementById('multimeter-guide-modal').style.display = 'none';
        }

        // Función para generar el contenido de la guía del multímetro
        function generateMultimeterGuideContent() {
            const t = translations[currentLanguage];
            const guide = t.multimeterGuide;
            
            return `
                <div style="display: grid; gap: 30px;">
                    <!-- Introducción -->
                    <div style="background: linear-gradient(135deg, #e8f4fd 0%, #f8f9fa 100%); padding: 25px; border-radius: 15px; border-left: 5px solid #3498db;">
                        <h3 style="color: #2c3e50; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.5rem;">📏</span>
                            ${guide.whatIsTitle}
                        </h3>
                        <p style="color: #34495e; line-height: 1.6; margin: 0; font-size: 1rem;">
                            ${guide.whatIsDescription}
                        </p>
                    </div>

                    <!-- Partes principales del multímetro -->
                    <div>
                        <h3 style="color: #2c3e50; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.3rem;">🔍</span>
                            ${guide.mainPartsTitle}
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                            <!-- Pantalla Digital -->
                            <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 2px solid #ecf0f1;">
                                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                    <div style="font-size: 2.5rem; background: #e8f4fd; padding: 15px; border-radius: 50%; border: 3px solid #3498db;">📺</div>
                                    <div>
                                        <h4 style="color: #2c3e50; margin: 0; font-size: 1.2rem;">${guide.display.title}</h4>
                                        <p style="color: #7f8c8d; margin: 5px 0 0 0; font-size: 0.9rem;">${guide.display.subtitle}</p>
                                    </div>
                                </div>
                                <div style="color: #34495e; line-height: 1.5;">
                                    <p><strong>${guide.functionLabel}:</strong> ${guide.display.function}</p>
                                    <p><strong>${guide.featuresLabel}:</strong></p>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        <li>${guide.display.features[0]}</li>
                                        <li>${guide.display.features[1]}</li>
                                        <li>${guide.display.features[2]}</li>
                                        <li>${guide.display.features[3]}</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Selector Rotatorio -->
                            <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 2px solid #ecf0f1;">
                                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                    <div style="font-size: 2.5rem; background: #fef9f3; padding: 15px; border-radius: 50%; border: 3px solid #e67e22;">⚙️</div>
                                    <div>
                                        <h4 style="color: #2c3e50; margin: 0; font-size: 1.2rem;">${guide.selector.title}</h4>
                                        <p style="color: #7f8c8d; margin: 5px 0 0 0; font-size: 0.9rem;">${guide.selector.subtitle}</p>
                                    </div>
                                </div>
                                <div style="color: #34495e; line-height: 1.5;">
                                    <p><strong>${guide.functionLabel}:</strong> ${guide.selector.function}</p>
                                    <p><strong>${guide.selector.positionsLabel}:</strong></p>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        <li><strong>OFF:</strong> ${guide.selector.positions[0]}</li>
                                        <li><strong>V~:</strong> ${guide.selector.positions[1]}</li>
                                        <li><strong>V⎓:</strong> ${guide.selector.positions[2]}</li>
                                        <li><strong>A:</strong> ${guide.selector.positions[3]}</li>
                                        <li><strong>Ω:</strong> ${guide.selector.positions[4]}</li>
                                        <li><strong>♪:</strong> ${guide.selector.positions[5]}</li>
                                        <li><strong>µF:</strong> ${guide.selector.positions[6]}</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Puertos de Conexión -->
                            <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 2px solid #ecf0f1;">
                                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                    <div style="font-size: 2.5rem; background: #f0fff4; padding: 15px; border-radius: 50%; border: 3px solid #27ae60;">🔌</div>
                                    <div>
                                        <h4 style="color: #2c3e50; margin: 0; font-size: 1.2rem;">${guide.ports.title}</h4>
                                        <p style="color: #7f8c8d; margin: 5px 0 0 0; font-size: 0.9rem;">${guide.ports.subtitle}</p>
                                    </div>
                                </div>
                                <div style="color: #34495e; line-height: 1.5;">
                                    <p><strong>${guide.functionLabel}:</strong> ${guide.ports.function}</p>
                                    <p><strong>${guide.ports.typicalLabel}:</strong></p>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        <li><strong>COM (${guide.ports.black}):</strong> ${guide.ports.types[0]}</li>
                                        <li><strong>VΩmA (${guide.ports.red}):</strong> ${guide.ports.types[1]}</li>
                                        <li><strong>10A (${guide.ports.red}):</strong> ${guide.ports.types[2]}</li>
                                        <li><strong>TEMP:</strong> ${guide.ports.types[3]}</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Puntas de Prueba -->
                            <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 2px solid #ecf0f1;">
                                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                    <div style="font-size: 2.5rem; background: #fdf2f2; padding: 15px; border-radius: 50%; border: 3px solid #e74c3c;">🖊️</div>
                                    <div>
                                        <h4 style="color: #2c3e50; margin: 0; font-size: 1.2rem;">${guide.probes.title}</h4>
                                        <p style="color: #7f8c8d; margin: 5px 0 0 0; font-size: 0.9rem;">${guide.probes.subtitle}</p>
                                    </div>
                                </div>
                                <div style="color: #34495e; line-height: 1.5;">
                                    <p><strong>${guide.functionLabel}:</strong> ${guide.probes.function}</p>
                                    <p><strong>${guide.featuresLabel}:</strong></p>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        <li><strong>${guide.probes.redLabel}:</strong> ${guide.probes.features[0]}</li>
                                        <li><strong>${guide.probes.blackLabel}:</strong> ${guide.probes.features[1]}</li>
                                        <li><strong>${guide.probes.insulationLabel}:</strong> ${guide.probes.features[2]}</li>
                                        <li><strong>${guide.probes.interchangeableLabel}:</strong> ${guide.probes.features[3]}</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Botones de Función -->
                            <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 2px solid #ecf0f1;">
                                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                    <div style="font-size: 2.5rem; background: #f8f4ff; padding: 15px; border-radius: 50%; border: 3px solid #9b59b6;">🎛️</div>
                                    <div>
                                        <h4 style="color: #2c3e50; margin: 0; font-size: 1.2rem;">${guide.buttons.title}</h4>
                                        <p style="color: #7f8c8d; margin: 5px 0 0 0; font-size: 0.9rem;">${guide.buttons.subtitle}</p>
                                    </div>
                                </div>
                                <div style="color: #34495e; line-height: 1.5;">
                                    <p><strong>${guide.functionLabel}:</strong> ${guide.buttons.function}</p>
                                    <p><strong>${guide.buttons.commonLabel}:</strong></p>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        <li><strong>HOLD:</strong> ${guide.buttons.common[0]}</li>
                                        <li><strong>AUTO:</strong> ${guide.buttons.common[1]}</li>
                                        <li><strong>LIGHT:</strong> ${guide.buttons.common[2]}</li>
                                        <li><strong>RESET:</strong> ${guide.buttons.common[3]}</li>
                                        <li><strong>MIN/MAX:</strong> ${guide.buttons.common[4]}</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Compartimento de Batería -->
                            <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 2px solid #ecf0f1;">
                                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                    <div style="font-size: 2.5rem; background: #fff9e6; padding: 15px; border-radius: 50%; border: 3px solid #f39c12;">🔋</div>
                                    <div>
                                        <h4 style="color: #2c3e50; margin: 0; font-size: 1.2rem;">${guide.battery.title}</h4>
                                        <p style="color: #7f8c8d; margin: 5px 0 0 0; font-size: 0.9rem;">${guide.battery.subtitle}</p>
                                    </div>
                                </div>
                                <div style="color: #34495e; line-height: 1.5;">
                                    <p><strong>${guide.functionLabel}:</strong> ${guide.battery.function}</p>
                                    <p><strong>${guide.featuresLabel}:</strong></p>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        <li><strong>${guide.battery.typicalLabel}:</strong> ${guide.battery.features[0]}</li>
                                        <li><strong>${guide.battery.durationLabel}:</strong> ${guide.battery.features[1]}</li>
                                        <li><strong>${guide.battery.indicatorLabel}:</strong> ${guide.battery.features[2]}</li>
                                        <li><strong>${guide.battery.autoOffLabel}:</strong> ${guide.battery.features[3]}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Funciones principales -->
                    <div>
                        <h3 style="color: #2c3e50; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.3rem;">⚡</span>
                            ${guide.mainFunctionsTitle}
                        </h3>
                        
                        <div style="display: grid; gap: 15px;">
                            <!-- Voltaje -->
                            <div style="background: linear-gradient(135deg, #e8f4fd 0%, #ffffff 100%); border-radius: 12px; padding: 20px; border-left: 5px solid #3498db;">
                                <h4 style="color: #2c3e50; margin: 0 0 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.2rem;">⚡</span>
                                    ${guide.voltage.title}
                                </h4>
                                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; align-items: center;">
                                    <div style="color: #34495e; line-height: 1.5;">
                                        <p><strong>${guide.voltage.whatLabel}</strong> ${guide.voltage.what}</p>
                                        <p><strong>${guide.voltage.howLabel}</strong> ${guide.voltage.how}</p>
                                        <p><strong>${guide.voltage.rangesLabel}</strong> ${guide.voltage.ranges}</p>
                                        <p><strong>${guide.voltage.applicationsLabel}</strong> ${guide.voltage.applications}</p>
                                    </div>
                                    <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; border: 2px solid #3498db;">
                                        <div style="font-size: 2rem; color: #3498db; margin-bottom: 5px;">📊</div>
                                        <div style="font-size: 1.1rem; font-weight: bold; color: #2c3e50;">V~  V⎓</div>
                                        <div style="font-size: 0.8rem; color: #7f8c8d;">AC / DC</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Corriente -->
                            <div style="background: linear-gradient(135deg, #fef9f3 0%, #ffffff 100%); border-radius: 12px; padding: 20px; border-left: 5px solid #e67e22;">
                                <h4 style="color: #2c3e50; margin: 0 0 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.2rem;">🌊</span>
                                    ${guide.current.title}
                                </h4>
                                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; align-items: center;">
                                    <div style="color: #34495e; line-height: 1.5;">
                                        <p><strong>${guide.current.whatLabel}</strong> ${guide.current.what}</p>
                                        <p><strong>${guide.current.howLabel}</strong> ${guide.current.how}</p>
                                        <p><strong>${guide.current.rangesLabel}</strong> ${guide.current.ranges}</p>
                                        <p><strong>${guide.current.applicationsLabel}</strong> ${guide.current.applications}</p>
                                    </div>
                                    <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; border: 2px solid #e67e22;">
                                        <div style="font-size: 2rem; color: #e67e22; margin-bottom: 5px;">⚡</div>
                                        <div style="font-size: 1.1rem; font-weight: bold; color: #2c3e50;">A  mA</div>
                                        <div style="font-size: 0.8rem; color: #7f8c8d;">${guide.current.unit}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Resistencia -->
                            <div style="background: linear-gradient(135deg, #f0fff4 0%, #ffffff 100%); border-radius: 12px; padding: 20px; border-left: 5px solid #27ae60;">
                                <h4 style="color: #2c3e50; margin: 0 0 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.2rem;">🔧</span>
                                    ${guide.resistance.title}
                                </h4>
                                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; align-items: center;">
                                    <div style="color: #34495e; line-height: 1.5;">
                                        <p><strong>${guide.resistance.whatLabel}</strong> ${guide.resistance.what}</p>
                                        <p><strong>${guide.resistance.howLabel}</strong> ${guide.resistance.how}</p>
                                        <p><strong>${guide.resistance.rangesLabel}</strong> ${guide.resistance.ranges}</p>
                                        <p><strong>${guide.resistance.applicationsLabel}</strong> ${guide.resistance.applications}</p>
                                    </div>
                                    <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; border: 2px solid #27ae60;">
                                        <div style="font-size: 2rem; color: #27ae60; margin-bottom: 5px;">🔧</div>
                                        <div style="font-size: 1.1rem; font-weight: bold; color: #2c3e50;">Ω</div>
                                        <div style="font-size: 0.8rem; color: #7f8c8d;">${guide.resistance.unit}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Continuidad -->
                            <div style="background: linear-gradient(135deg, #f8f4ff 0%, #ffffff 100%); border-radius: 12px; padding: 20px; border-left: 5px solid #9b59b6;">
                                <h4 style="color: #2c3e50; margin: 0 0 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.2rem;">🔊</span>
                                    ${guide.continuity.title}
                                </h4>
                                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; align-items: center;">
                                    <div style="color: #34495e; line-height: 1.5;">
                                        <p><strong>${guide.continuity.whatLabel}</strong> ${guide.continuity.what}</p>
                                        <p><strong>${guide.continuity.howLabel}</strong> ${guide.continuity.how}</p>
                                        <p><strong>${guide.continuity.thresholdLabel}</strong> ${guide.continuity.threshold}</p>
                                        <p><strong>${guide.continuity.applicationsLabel}</strong> ${guide.continuity.applications}</p>
                                    </div>
                                    <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; border: 2px solid #9b59b6;">
                                        <div style="font-size: 2rem; color: #9b59b6; margin-bottom: 5px;">🔊</div>
                                        <div style="font-size: 1.1rem; font-weight: bold; color: #2c3e50;">♪</div>
                                        <div style="font-size: 0.8rem; color: #7f8c8d;">${guide.continuity.unit}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Capacitancia -->
                            <div style="background: linear-gradient(135deg, #fff9e6 0%, #ffffff 100%); border-radius: 12px; padding: 20px; border-left: 5px solid #f39c12;">
                                <h4 style="color: #2c3e50; margin: 0 0 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 1.2rem;">⚡</span>
                                    ${guide.capacitance.title}
                                </h4>
                                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; align-items: center;">
                                    <div style="color: #34495e; line-height: 1.5;">
                                        <p><strong>${guide.capacitance.whatLabel}</strong> ${guide.capacitance.what}</p>
                                        <p><strong>${guide.capacitance.howLabel}</strong> ${guide.capacitance.how}</p>
                                        <p><strong>${guide.capacitance.rangesLabel}</strong> ${guide.capacitance.ranges}</p>
                                        <p><strong>${guide.capacitance.applicationsLabel}</strong> ${guide.capacitance.applications}</p>
                                    </div>
                                    <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; border: 2px solid #f39c12;">
                                        <div style="font-size: 2rem; color: #f39c12; margin-bottom: 5px;">⚡</div>
                                        <div style="font-size: 1.1rem; font-weight: bold; color: #2c3e50;">µF</div>
                                        <div style="font-size: 0.8rem; color: #7f8c8d;">${guide.capacitance.unit}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Consejos de seguridad -->
                    <div style="background: linear-gradient(135deg, #fdf2f2 0%, #ffffff 100%); border-radius: 15px; padding: 25px; border-left: 5px solid #e74c3c;">
                        <h3 style="color: #c0392b; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.5rem;">⚠️</span>
                            ${guide.safetyTitle}
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div>
                                <h4 style="color: #e74c3c; margin-bottom: 10px;">🔌 ${guide.safety.connections.title}</h4>
                                <ul style="color: #34495e; line-height: 1.6; margin: 0; padding-left: 20px;">
                                    <li>${guide.safety.connections.tips[0]}</li>
                                    <li>${guide.safety.connections.tips[1]}</li>
                                    <li>${guide.safety.connections.tips[2]}</li>
                                    <li>${guide.safety.connections.tips[3]}</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 style="color: #e74c3c; margin-bottom: 10px;">⚡ ${guide.safety.highVoltage.title}</h4>
                                <ul style="color: #34495e; line-height: 1.6; margin: 0; padding-left: 20px;">
                                    <li>${guide.safety.highVoltage.tips[0]}</li>
                                    <li>${guide.safety.highVoltage.tips[1]}</li>
                                    <li>${guide.safety.highVoltage.tips[2]}</li>
                                    <li>${guide.safety.highVoltage.tips[3]}</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 style="color: #e74c3c; margin-bottom: 10px;">🔋 ${guide.safety.maintenance.title}</h4>
                                <ul style="color: #34495e; line-height: 1.6; margin: 0; padding-left: 20px;">
                                    <li>${guide.safety.maintenance.tips[0]}</li>
                                    <li>${guide.safety.maintenance.tips[1]}</li>
                                    <li>${guide.safety.maintenance.tips[2]}</li>
                                    <li>${guide.safety.maintenance.tips[3]}</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Consejos prácticos -->
                    <div style="background: linear-gradient(135deg, #e8f4fd 0%, #ffffff 100%); border-radius: 15px; padding: 25px; border-left: 5px solid #3498db;">
                        <h3 style="color: #2980b9; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.5rem;">💡</span>
                            ${guide.practicalTitle}
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div>
                                <h4 style="color: #3498db; margin-bottom: 10px;">📏 ${guide.practical.precision.title}</h4>
                                <ul style="color: #34495e; line-height: 1.6; margin: 0; padding-left: 20px;">
                                    <li>${guide.practical.precision.tips[0]}</li>
                                    <li>${guide.practical.precision.tips[1]}</li>
                                    <li>${guide.practical.precision.tips[2]}</li>
                                    <li>${guide.practical.precision.tips[3]}</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 style="color: #3498db; margin-bottom: 10px;">🔧 ${guide.practical.technique.title}</h4>
                                <ul style="color: #34495e; line-height: 1.6; margin: 0; padding-left: 20px;">
                                    <li>${guide.practical.technique.tips[0]}</li>
                                    <li>${guide.practical.technique.tips[1]}</li>
                                    <li>${guide.practical.technique.tips[2]}</li>
                                    <li>${guide.practical.technique.tips[3]}</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 style="color: #3498db; margin-bottom: 10px;">📊 ${guide.practical.interpretation.title}</h4>
                                <ul style="color: #34495e; line-height: 1.6; margin: 0; padding-left: 20px;">
                                    <li>${guide.practical.interpretation.tips[0]}</li>
                                    <li>${guide.practical.interpretation.tips[1]}</li>
                                    <li>${guide.practical.interpretation.tips[2]}</li>
                                    <li>${guide.practical.interpretation.tips[3]}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Funciones del multímetro
        function rotateSelector(event) {
            const selector = document.getElementById('selector');
            const pointer = document.getElementById('pointer');
            const rect = selector.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            const angle = Math.atan2(event.clientY - centerY, event.clientX - centerX);
            const degrees = (angle * 180 / Math.PI + 90 + 360) % 360;
            
            // Determinar el modo basado en el ángulo - ahora OFF está en 0° (arriba)
            const modes = ['off', 'voltage', 'current_ma', 'current_a', 'capacitance', 'resistance', 'continuity', 'conductance'];
            const modeIndex = Math.floor((degrees + 22.5) / 45) % 8;
            const newMode = modes[modeIndex] || 'off';
            
            // Solo actualizar si el modo cambió
            if (newMode !== currentMode) {
                currentMode = newMode;
                pointer.style.transform = `translateX(-50%) rotate(${modeIndex * 45}deg)`;
                updateDisplay();
                
                // Mostrar feedback del modo seleccionado
                const t = translations[currentLanguage];
                const modeNames = {
                    'voltage': t.modeVoltage,
                    'current_ma': t.modeCurrent,
                    'current_a': t.modeCurrentA,
                    'capacitance': t.modeCapacitance,
                    'resistance': t.modeResistance,
                    'conductance': t.modeConductance,
                    'continuity': t.modeContinuity,
                    'off': t.modeOff
                };
                
                showFeedback('success', `${t.modeSelected} ${modeNames[currentMode]}`);
            }
        }

        function selectProbe(color) {
            if (color === 'red') {
                connectionState = 'red-selected';
                document.getElementById('probe-red').style.boxShadow = '0 0 20px #e74c3c';
                updateMeasurementPointsVisual('red-ready');
            } else if (color === 'black') {
                connectionState = 'black-selected';
                document.getElementById('probe-black').style.boxShadow = '0 0 20px #2c3e50';
                updateMeasurementPointsVisual('black-ready');
            }
            
            // Resetear el otro probe
            if (color === 'red') {
                document.getElementById('probe-black').style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';
            } else {
                document.getElementById('probe-red').style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';
            }
            
            updateProbeStatus();
        }

        function updateProbeStatus() {
            const redStatus = document.getElementById('red-probe-status');
            const blackStatus = document.getElementById('black-probe-status');
            const redIcon = document.getElementById('red-status-icon');
            const blackIcon = document.getElementById('black-status-icon');
            const redProgress = document.getElementById('red-progress');
            const blackProgress = document.getElementById('black-progress');
            const connectionBadge = document.getElementById('connection-badge');
            const statusText = connectionBadge.querySelector('.status-text');
            const t = translations[currentLanguage];
            
            // Actualizar estado de la punta roja
            if (connectionState === 'red-selected') {
                redStatus.textContent = t.redProbeSelected;
                redIcon.textContent = '🎯';
                redProgress.style.width = '50%';
            } else if (probeConnections.red) {
                redStatus.textContent = `${t.redProbeConnected} ${probeConnections.red}`;
                redIcon.textContent = '✅';
                redProgress.style.width = '100%';
            } else {
                redStatus.textContent = t.redProbeClick;
                redIcon.textContent = '⭕';
                redProgress.style.width = '0%';
            }
            
            // Actualizar estado de la punta negra
            if (connectionState === 'black-selected') {
                blackStatus.textContent = t.blackProbeSelected;
                blackIcon.textContent = '🎯';
                blackProgress.style.width = '50%';
            } else if (probeConnections.black) {
                blackStatus.textContent = `${t.blackProbeConnected} ${probeConnections.black}`;
                blackIcon.textContent = '✅';
                blackProgress.style.width = '100%';
            } else {
                if (probeConnections.red) {
                    blackStatus.textContent = t.blackProbeClick;
                } else {
                    blackStatus.textContent = t.waitingRedProbe;
                }
                blackIcon.textContent = '⭕';
                blackProgress.style.width = '0%';
            }
            
            // Actualizar badge de estado general
            connectionBadge.className = 'connection-status-badge';
            if (probeConnections.red && probeConnections.black) {
                connectionBadge.classList.add('connected');
                statusText.textContent = t.fullyConnected;
            } else if (probeConnections.red || probeConnections.black) {
                connectionBadge.classList.add('partial');
                statusText.textContent = t.partiallyConnected;
            } else {
                statusText.textContent = t.disconnected;
            }
            
            // Actualizar pasos de instrucciones
            updateInstructionSteps();
        }
        
        function updateInstructionSteps() {
            const steps = document.querySelectorAll('.instruction-step');
            
            // Resetear todos los pasos
            steps.forEach(step => {
                step.classList.remove('active', 'completed');
            });
            
            // Paso 1: Seleccionar punta roja
            if (connectionState === 'red-selected' || probeConnections.red) {
                steps[0].classList.add('completed');
            } else {
                steps[0].classList.add('active');
                return;
            }
            
            // Paso 2: Conectar punta roja
            if (probeConnections.red) {
                steps[1].classList.add('completed');
            } else {
                steps[1].classList.add('active');
                return;
            }
            
            // Paso 3: Seleccionar punta negra
            if (connectionState === 'black-selected' || probeConnections.black) {
                steps[2].classList.add('completed');
            } else {
                steps[2].classList.add('active');
                return;
            }
            
            // Paso 4: Conectar punta negra
            if (probeConnections.black) {
                steps[3].classList.add('completed');
            } else {
                steps[3].classList.add('active');
            }
        }

        function updateProbeConnections() {
            // Resetear estilos de las puntas
            document.getElementById('probe-red').style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';
            document.getElementById('probe-black').style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';
            
            // Actualizar estado visual de los puntos
            updateMeasurementPointsVisual('idle');
        }

        function updateMeasurementPointsVisual(state) {
            const points = document.querySelectorAll('.measurement-point');
            
            // Limpiar todas las clases de estado
            points.forEach(point => {
                point.classList.remove('red-ready', 'black-ready', 'red-connected', 'black-connected');
            });
            
            // Aplicar el nuevo estado
            if (state === 'red-ready') {
                points.forEach(point => {
                    point.classList.add('red-ready');
                });
            } else if (state === 'black-ready') {
                points.forEach(point => {
                    point.classList.add('black-ready');
                });
            } else if (state === 'connections-made') {
                // Marcar puntos específicos como conectados
                if (probeConnections.red) {
                    const redPoint = document.querySelector(`[data-point="${probeConnections.red}"]`);
                    if (redPoint) redPoint.classList.add('red-connected');
                }
                if (probeConnections.black) {
                    const blackPoint = document.querySelector(`[data-point="${probeConnections.black}"]`);
                    if (blackPoint) blackPoint.classList.add('black-connected');
                }
            }
        }

        function updateDisplay() {
            const display = document.getElementById('display');
            const unitDisplay = document.getElementById('unit-display');
            
            // Si está en modo HOLD, mantener el valor congelado
            if (holdMode && heldValue) {
                display.textContent = heldValue;
                return;
            }
            
            // Mostrar unidad según el modo, incluso sin conexiones
            let unit = '';
            switch (currentMode) {
                case 'voltage': unit = 'V'; break;
                case 'current_ma': unit = 'mA'; break;
                case 'current_a': unit = 'A'; break;
                case 'resistance': unit = 'Ω'; break;
                case 'capacitance': unit = 'µF'; break;
                case 'conductance': unit = 'mS'; break;
                case 'continuity': unit = ''; break;
                case 'off': unit = ''; break;
            }
            unitDisplay.textContent = unit;
            
            // Si no hay conexiones o está apagado
            if (currentMode === 'off' || !probeConnections.red || !probeConnections.black) {
                display.textContent = currentMode === 'off' ? '' : '0.00';
                return;
            }
            
            const points = [probeConnections.red, probeConnections.black].sort((a, b) => a - b);
            let value = '0.00';
            
            // Calcular el valor basado en el modo y los puntos conectados
            switch (currentMode) {
                case 'voltage':
                    value = calculateVoltage(points);
                    break;
                case 'current_ma':
                    value = calculateCurrent(points, true);
                    break;
                case 'current_a':
                    value = calculateCurrent(points, false);
                    break;
                case 'resistance':
                    value = calculateResistance(points);
                    break;
                case 'capacitance':
                    value = calculateCapacitance(points);
                    break;
                case 'conductance':
                    value = calculateConductance(points);
                    break;
                case 'continuity':
                    const hasContinuity = checkContinuity(points);
                    value = hasContinuity ? '♪' : '∞';
                    if (hasContinuity) {
                        setTimeout(() => {
                            const t = translations[currentLanguage];
                            showFeedback('success', t.continuityDetected);
                        }, 100);
                    }
                    break;
            }
            
            display.textContent = value;
            
            // Efecto de parpadeo para nuevas mediciones
            if (!holdMode) {
                display.style.animation = 'none';
                setTimeout(() => {
                    display.style.animation = 'pulse 0.3s ease-in-out';
                }, 10);
            }
        }

        // Funciones de cálculo mejoradas
        function calculateVoltage(points) {
            const battery = batteries[currentBattery];
            const led = leds[currentLED];
            const resistor = resistors[currentResistor];
            const exercise = exercises[currentExercise];
            
            console.log('Calculando voltaje:', { points, circuit: exercise.circuit, battery: battery.voltage });
            
            // Lógica específica según el circuito y puntos
            switch (exercise.circuit) {
                case 'battery':
                    // Puntos 1 y 2 son los terminales de la batería
                    if ((points.includes(1) && points.includes(2))) {
                        return battery.voltage.toFixed(2);
                    }
                    break;
                    
                case 'resistor':
                    // Solo resistor aislado - Punto 1: R1, Punto 2: R2
                    if (points.includes(1) && points.includes(2)) {
                        // Sin fuente de voltaje, no hay voltaje a través del resistor
                        return "0.00";
                    }
                    break;
                    
                case 'led':
                    // Punto 1: BAT+, Punto 2: R-LED, Punto 3: LED-, Punto 4: BAT-
                    if (points.includes(1) && points.includes(4)) {
                        // Voltaje total de la batería
                        return battery.voltage.toFixed(2);
                    } else if (points.includes(1) && points.includes(2)) {
                        // Voltaje a través del resistor
                        const totalResistance = resistor.resistance + 105; // Resistencia aproximada del LED
                        const current = battery.voltage / totalResistance;
                        const voltageResistor = current * resistor.resistance;
                        return voltageResistor.toFixed(2);
                    } else if (points.includes(2) && points.includes(3)) {
                        // Voltaje a través del LED
                        return led.voltage.toFixed(2);
                    } else if (points.includes(3) && points.includes(4)) {
                        // Voltaje desde LED hasta batería (debería ser 0)
                        return "0.00";
                    }
                    break;
                    
                case 'ledOnly':
                    // Solo el LED, puntos 1 y 2
                    if (points.includes(1) && points.includes(2)) {
                        return led.voltage.toFixed(2);
                    }
                    break;
                    
                case 'capacitor':
                    // Condensador descargado
                    if (points.includes(1) && points.includes(2)) {
                        return "0.00";
                    }
                    break;
                    
                case 'complete':
                    // Circuito completo - cálculos más complejos
                    if (points.includes(1) && points.includes(6)) {
                        return battery.voltage.toFixed(2);
                    } else if (points.includes(3) && points.includes(4)) {
                        return led.voltage.toFixed(2);
                    }
                    break;
            }
            
            // Valor por defecto si no coincide ningún caso
            return "0.00";
        }

        function calculateCurrent(points, inMilliamps = false) {
            const battery = batteries[currentBattery];
            const resistor = resistors[currentResistor];
            const led = leds[currentLED];
            const exercise = exercises[currentExercise];
            
            console.log('Calculando corriente:', { points, circuit: exercise.circuit, inMilliamps });
            
            let current = 0;
            
            switch (exercise.circuit) {
                case 'battery':
                    // En una batería sin carga, la corriente es 0
                    current = 0;
                    break;
                    
                case 'resistor':
                    // Solo resistor aislado - sin fuente de voltaje, no hay corriente
                    if (points.includes(1) && points.includes(2)) {
                        current = 0; // Sin fuente de voltaje, corriente = 0
                    }
                    break;
                    
                case 'led':
                    // Circuito con batería, resistor y LED en serie
                    // La corriente es la misma en todo el circuito serie
                    if (points.includes(2) && points.includes(3)) {
                        // Resistencia total = resistor + resistencia dinámica del LED
                        const ledResistance = led.voltage / 0.02; // Aproximación: 2.1V / 20mA = 105Ω
                        const totalResistance = resistor.resistance + ledResistance;
                        current = battery.voltage / totalResistance;
                    } else if (points.includes(1) && points.includes(4)) {
                        // Corriente total del circuito
                        const ledResistance = led.voltage / 0.02;
                        const totalResistance = resistor.resistance + ledResistance;
                        current = battery.voltage / totalResistance;
                    }
                    break;
                    
                case 'ledOnly':
                    // Solo LED - necesitaría una fuente de corriente
                    current = 0.02; // 20mA típico
                    break;
                    
                case 'capacitor':
                    // Condensador - corriente inicial alta, luego 0
                    current = 0;
                    break;
                    
                case 'complete':
                    // Circuito completo
                    const ledResistance = led.voltage / 0.02;
                    const totalResistance = resistor.resistance + ledResistance;
                    current = battery.voltage / totalResistance;
                    break;
                    
                default:
                    current = 0;
            }
            
            const value = inMilliamps ? (current * 1000).toFixed(1) : current.toFixed(3);
            return value;
        }

        function calculateResistance(points) {
            const resistor = resistors[currentResistor];
            const led = leds[currentLED];
            const exercise = exercises[currentExercise];
            
            console.log('Calculando resistencia:', { points, circuit: exercise.circuit });
            
            switch (exercise.circuit) {
                case 'battery':
                    // Una batería ideal tiene resistencia interna muy baja
                    if (points.includes(1) && points.includes(2)) {
                        return "0.1"; // Resistencia interna típica
                    }
                    break;
                    
                case 'resistor':
                    // Medir resistencia del resistor aislado
                    if (points.includes(1) && points.includes(2)) {
                        return resistor.resistance.toFixed(1);
                    }
                    break;
                    
                case 'led':
                    // Resistencia del LED (varía según si está polarizado)
                    if (points.includes(2) && points.includes(3)) {
                        // Resistencia dinámica del LED cuando está encendido
                        const ledResistance = led.voltage / 0.02; // V/I = R
                        return ledResistance.toFixed(1);
                    } else if (points.includes(1) && points.includes(2)) {
                        // Resistencia del resistor
                        return resistor.resistance.toFixed(1);
                    }
                    break;
                    
                case 'ledOnly':
                    // Solo LED
                    if (points.includes(1) && points.includes(2)) {
                        const ledResistance = led.voltage / 0.02;
                        return ledResistance.toFixed(1);
                    }
                    break;
                    
                case 'capacitor':
                    // Condensador - resistencia muy alta (aislante)
                    if (points.includes(1) && points.includes(2)) {
                        return "∞"; // Infinita para DC
                    }
                    break;
                    
                case 'complete':
                    // Circuito completo - diferentes mediciones
                    if (points.includes(2) && points.includes(3)) {
                        return resistor.resistance.toFixed(1);
                    } else if (points.includes(3) && points.includes(4)) {
                        const ledResistance = led.voltage / 0.02;
                        return ledResistance.toFixed(1);
                    }
                    break;
            }
            
            return "∞"; // Circuito abierto
        }

        function calculateCapacitance(points) {
            const capacitor = capacitors[currentCapacitor];
            const exercise = exercises[currentExercise];
            
            console.log('Calculando capacitancia:', { points, circuit: exercise.circuit });
            
            switch (exercise.circuit) {
                case 'capacitor':
                    // Medir capacitancia del condensador
                    if (points.includes(1) && points.includes(2)) {
                        // Extraer el valor numérico del nombre del capacitor
                        const match = capacitor.name.match(/(\d+(?:\.\d+)?)/);
                        return match ? match[1] : "100.0";
                    }
                    break;
                    
                case 'complete':
                    // En circuito completo, medir el condensador
                    if (points.includes(4) && points.includes(5)) {
                        const match = capacitor.name.match(/(\d+(?:\.\d+)?)/);
                        return match ? match[1] : "100.0";
                    }
                    break;
                    
                default:
                    // Otros componentes no tienen capacitancia significativa
                    return "0.0";
            }
            
            return "0.0";
        }

        function calculateConductance(points) {
            const resistor = resistors[currentResistor];
            const led = leds[currentLED];
            const exercise = exercises[currentExercise];
            
            console.log('Calculando conductancia:', { points, circuit: exercise.circuit });
            
            let resistance = 0;
            
            switch (exercise.circuit) {
                case 'battery':
                    // Conductancia de la batería (inverso de resistencia interna)
                    if (points.includes(1) && points.includes(2)) {
                        resistance = 0.1; // Resistencia interna típica
                    }
                    break;
                    
                case 'resistor':
                    // Conductancia del resistor aislado
                    if (points.includes(1) && points.includes(2)) {
                        resistance = resistor.resistance;
                    }
                    break;
                    
                case 'led':
                    // Conductancia del LED
                    if (points.includes(2) && points.includes(3)) {
                        resistance = led.voltage / 0.02; // Resistencia dinámica del LED
                    } else if (points.includes(1) && points.includes(2)) {
                        resistance = resistor.resistance;
                    }
                    break;
                    
                case 'ledOnly':
                    if (points.includes(1) && points.includes(2)) {
                        resistance = led.voltage / 0.02;
                    }
                    break;
                    
                case 'capacitor':
                    // Condensador tiene conductancia 0 para DC
                    return "0.0";
                    
                case 'complete':
                    if (points.includes(2) && points.includes(3)) {
                        resistance = resistor.resistance;
                    } else if (points.includes(3) && points.includes(4)) {
                        resistance = led.voltage / 0.02;
                    }
                    break;
                    
                default:
                    return "0.0";
            }
            
            if (resistance > 0) {
                const conductance = 1 / resistance;
                return (conductance * 1000).toFixed(1); // En miliSiemens
            }
            
            return "0.0";
        }

        function checkContinuity(points) {
            const exercise = exercises[currentExercise];
            
            console.log('Verificando continuidad:', { points, circuit: exercise.circuit });
            
            switch (exercise.circuit) {
                case 'battery':
                    // Batería tiene continuidad interna
                    return points.includes(1) && points.includes(2);
                    
                case 'resistor':
                    // Hay continuidad a través del resistor aislado
                    if (points.includes(1) && points.includes(2)) {
                        return true; // A través del resistor
                    }
                    break;
                    
                case 'led':
                    // LED tiene continuidad en una dirección
                    if (points.includes(1) && points.includes(4)) {
                        return true; // A través de todo el circuito
                    } else if (points.includes(2) && points.includes(3)) {
                        return true; // A través del LED (polarizado correctamente)
                    }
                    break;
                    
                case 'ledOnly':
                    // Solo LED
                    return points.includes(1) && points.includes(2);
                    
                case 'capacitor':
                    // Condensador NO tiene continuidad DC
                    return false;
                    
                case 'complete':
                    // Circuito completo - múltiples caminos de continuidad
                    if (points.includes(1) && points.includes(6)) {
                        return true; // A través de todo el circuito
                    } else if (points.includes(2) && points.includes(3)) {
                        return true; // A través del resistor
                    } else if (points.includes(3) && points.includes(4)) {
                        return true; // A través del LED
                    }
                    // El condensador NO proporciona continuidad DC
                    break;
            }
            
            return false;
        }

        function arraysEqual(a, b) {
            return a.length === b.length && a.every((val, i) => val === b[i]);
        }

        // Funciones de ejercicios
        function loadExercise() {
            const t = translations[currentLanguage];
            const exercise = t.exercises[currentExercise];
            
            document.getElementById('exercise-title').textContent = exercise.title;
            document.getElementById('exercise-objective').textContent = exercise.objective;
            document.getElementById('exercise-mode').textContent = exercise.mode;
            document.getElementById('exercise-connection').textContent = exercise.connection;
            document.getElementById('exercise-hint').textContent = exercise.hint;
            
            renderCircuit(exercises[currentExercise].circuit);
            resetConnections();
            updateComponentInfo();
            updateSteps();
            
            // Actualizar etiquetas después de cargar el ejercicio
            setTimeout(() => {
                updateExerciseLabels();
                updateComponentTooltips();
            }, 100);
        }

        function resetConnections() {
            probeConnections = { red: null, black: null };
            connectionState = 'idle';
            updateProbeStatus();
            updateDisplay();
            updateMeasurementPointsVisual('idle');
        }

        function updateComponentInfo() {
            const battery = batteries[currentBattery];
            const resistor = resistors[currentResistor];
            const led = leds[currentLED];
            const capacitor = capacitors[currentCapacitor];
            const t = translations[currentLanguage];
            
            document.getElementById('current-battery-info').textContent = `${battery.name} - ${battery.voltage}V`;
            document.getElementById('current-resistor-info').textContent = `${resistor.name} - ${resistor.tolerance}`;
            document.getElementById('current-led-info').textContent = `${led.name} - ${led.voltage}V`;
            document.getElementById('current-capacitor-info').textContent = `${capacitor.name} - ${capacitor.voltage}`;
            
            // Actualizar etiquetas de componentes
            const componentLabels = document.querySelectorAll('strong[style*="color: #2c3e50"]');
            componentLabels.forEach(label => {
                if (label.textContent.includes('Batería') || label.textContent.includes('Battery')) {
                    label.textContent = t.battery;
                } else if (label.textContent.includes('Resistor')) {
                    label.textContent = t.resistor;
                } else if (label.textContent.includes('LED')) {
                    label.textContent = t.led;
                } else if (label.textContent.includes('Condensador') || label.textContent.includes('Capacitor')) {
                    label.textContent = t.capacitor;
                }
            });
        }

        function updateSteps() {
            const steps = document.querySelectorAll('.step');
            
            // Resetear todos los pasos
            steps.forEach(step => {
                step.classList.remove('completed', 'active');
            });
            
            // Paso 1: Seleccionar modo
            if (currentMode !== 'off') {
                steps[0].classList.add('completed');
            } else {
                steps[0].classList.add('active');
                return;
            }
            
            // Paso 2: Conectar punta roja
            if (probeConnections.red) {
                steps[1].classList.add('completed');
            } else {
                steps[1].classList.add('active');
                return;
            }
            
            // Paso 3: Conectar punta negra
            if (probeConnections.black) {
                steps[2].classList.add('completed');
            } else {
                steps[2].classList.add('active');
                return;
            }
            
            // Paso 4: Verificar medición
            steps[3].classList.add('active');
        }

        function checkMeasurement() {
            const exercise = exercises[currentExercise];
            const feedback = document.getElementById('feedback');
            const points = [probeConnections.red, probeConnections.black].sort((a, b) => a - b);
            const t = translations[currentLanguage];
            
            if (!probeConnections.red || !probeConnections.black) {
                showFeedback('error', t.connectBothProbes);
                return;
            }
            
            // Verificar modo correcto
            const correctMode = getCorrectMode(exercise.type);
            if (currentMode !== correctMode) {
                const currentExerciseTranslated = t.exercises[currentExercise];
                showFeedback('error', `${t.incorrectMode} ${currentExerciseTranslated.mode}.`);
                return;
            }
            
            // Verificar puntos correctos
            if (arraysEqual(points, exercise.correctPoints.sort())) {
                completedExercises.add(currentExercise);
                
                // Calcular progreso
                const progress = Math.round((completedExercises.size / exercises.length) * 100);
                
                // Generar mensaje de éxito dinámico con valores actuales
                const dynamicMessage = generateDynamicSuccessMessage(exercise);
                
                let successMessage = `✅ ${dynamicMessage}`;
                if (completedExercises.size === exercises.length) {
                    successMessage += ` ${t.congratulationsAll} (${progress}%).`;
                } else {
                    successMessage += ` ${t.progress} ${progress}% (${completedExercises.size}/${exercises.length})`;
                }
                
                showFeedback('success', successMessage);
                
                // Actualizar pasos como completados
                updateSteps();
                
                // Auto-avanzar al siguiente ejercicio después de 4 segundos
                setTimeout(() => {
                    if (currentExercise < exercises.length - 1) {
                        nextExercise();
                        const nextExerciseTitle = t.exercises[currentExercise].title;
                        showFeedback('success', `${t.nextExercise} ${nextExerciseTitle}`);
                    } else {
                        // Mostrar celebración especial de maestría inmediatamente
                        setTimeout(() => {
                            showMasteryAchievement();
                        }, 1000);
                    }
                }, 3000);
            } else {
                // Generar mensaje de error dinámico
                const dynamicErrorMessage = generateDynamicErrorMessage(exercise, points);
                showFeedback('error', `${t.incorrectConnection} ${dynamicErrorMessage}`);
                
                // Dar una pista adicional después de varios intentos fallidos
                setTimeout(() => {
                    const hintMessage = generateDynamicHint(exercise);
                    showFeedback('error', `💡 ${hintMessage}`);
                }, 2000);
            }
        }

        // Función para generar mensajes de éxito dinámicos
        function generateDynamicSuccessMessage(exercise) {
            const battery = batteries[currentBattery];
            const resistor = resistors[currentResistor];
            const led = leds[currentLED];
            const capacitor = capacitors[currentCapacitor];
            const displayValue = document.getElementById('display').textContent;
            
            switch (exercise.type) {
                case 'voltage':
                    if (exercise.circuit === 'battery') {
                        return `¡Perfecto! La batería ${battery.name} produce ${displayValue}V. El voltaje se mide en paralelo.`;
                    } else if (exercise.circuit === 'led') {
                        return `¡Excelente! El ${led.name} tiene una caída de voltaje de ${displayValue}V cuando está encendido con la batería ${battery.name}.`;
                    } else if (exercise.circuit === 'resistor') {
                        return `¡Muy bien! El voltaje a través del resistor ${resistor.name} es ${displayValue}V con la batería ${battery.name}.`;
                    }
                    break;
                    
                case 'current':
                    if (exercise.circuit === 'led') {
                        return `¡Excelente! La corriente que fluye por el ${led.name} es ${displayValue}A. Con el resistor ${resistor.name} y batería ${battery.name}, esta corriente es segura para el LED.`;
                    } else if (exercise.circuit === 'resistor') {
                        return `¡Muy bien! La corriente a través del resistor ${resistor.name} es ${displayValue}A usando la batería ${battery.name}.`;
                    }
                    break;
                    
                case 'resistance':
                    if (exercise.circuit === 'resistor') {
                        return `¡Muy bien! El resistor tiene ${displayValue}Ω. Este es un resistor ${resistor.name} con tolerancia ${resistor.tolerance}.`;
                    } else if (exercise.circuit === 'led') {
                        return `¡Perfecto! La resistencia dinámica del ${led.name} es ${displayValue}Ω cuando está polarizado correctamente.`;
                    }
                    break;
                    
                case 'capacitance':
                    return `¡Excelente! El condensador ${capacitor.name} tiene ${displayValue}µF de capacitancia con voltaje nominal ${capacitor.voltage}.`;
                    
                case 'continuity':
                    return `¡Perfecto! Hay continuidad (${displayValue}) - el multímetro confirma que existe un camino conductor entre los puntos medidos.`;
                    
                default:
                    return exercise.explanation;
            }
            
            return exercise.explanation;
        }

        // Función para generar mensajes de error dinámicos
        function generateDynamicErrorMessage(exercise, points) {
            const battery = batteries[currentBattery];
            const resistor = resistors[currentResistor];
            const led = leds[currentLED];
            const capacitor = capacitors[currentCapacitor];
            const t = translations[currentLanguage];
            
            let componentInfo = '';
            if (currentLanguage === 'es') {
                switch (exercise.circuit) {
                    case 'battery':
                        componentInfo = `con la batería ${battery.name} (${battery.voltage}V)`;
                        break;
                    case 'resistor':
                        componentInfo = `con el resistor ${resistor.name} y batería ${battery.name}`;
                        break;
                    case 'led':
                        componentInfo = `con el ${led.name}, resistor ${resistor.name} y batería ${battery.name}`;
                        break;
                    case 'capacitor':
                        componentInfo = `con el condensador ${capacitor.name}`;
                        break;
                    case 'complete':
                        componentInfo = `con todos los componentes: batería ${battery.name}, resistor ${resistor.name}, ${led.name} y condensador ${capacitor.name}`;
                        break;
                }
            } else {
                switch (exercise.circuit) {
                    case 'battery':
                        componentInfo = `with battery ${battery.name} (${battery.voltage}V)`;
                        break;
                    case 'resistor':
                        componentInfo = `with resistor ${resistor.name} and battery ${battery.name}`;
                        break;
                    case 'led':
                        componentInfo = `with ${led.name}, resistor ${resistor.name} and battery ${battery.name}`;
                        break;
                    case 'capacitor':
                        componentInfo = `with capacitor ${capacitor.name}`;
                        break;
                    case 'complete':
                        componentInfo = `with all components: battery ${battery.name}, resistor ${resistor.name}, ${led.name} and capacitor ${capacitor.name}`;
                        break;
                }
            }
            
            const joinWord = currentLanguage === 'es' ? ' y ' : ' and ';
            const butNeed = currentLanguage === 'es' ? 'pero necesitas conectar los puntos' : 'but you need to connect points';
            
            return `${componentInfo}. ${t.connectedPoints} ${points.join(joinWord)}, ${butNeed} ${exercise.correctPoints.join(joinWord)}.`;
        }

        // Función para generar pistas dinámicas
        function generateDynamicHint(exercise) {
            const battery = batteries[currentBattery];
            const resistor = resistors[currentResistor];
            const led = leds[currentLED];
            const capacitor = capacitors[currentCapacitor];
            
            let specificHint = '';
            switch (exercise.type) {
                case 'voltage':
                    specificHint = `Para medir voltaje, conecta en paralelo. `;
                    if (exercise.circuit === 'battery') {
                        specificHint += `La batería ${battery.name} debe medirse entre sus terminales positivo y negativo.`;
                    } else if (exercise.circuit === 'led') {
                        specificHint += `El ${led.name} debe medirse entre sus terminales ánodo y cátodo mientras está encendido.`;
                    }
                    break;
                    
                case 'current':
                    specificHint = `Para medir corriente, conecta en serie (interrumpiendo el circuito). `;
                    specificHint += `Con el resistor ${resistor.name} y batería ${battery.name}, la corriente debe medirse donde fluye.`;
                    break;
                    
                case 'resistance':
                    specificHint = `Para medir resistencia, desconecta el componente del circuito. `;
                    if (exercise.circuit === 'resistor') {
                        specificHint += `El resistor ${resistor.name} debe medirse entre sus terminales sin energía.`;
                    }
                    break;
                    
                case 'capacitance':
                    specificHint = `Para medir capacitancia, desconecta y descarga el componente. `;
                    specificHint += `El condensador ${capacitor.name} debe estar completamente descargado antes de medir.`;
                    break;
                    
                case 'continuity':
                    specificHint = `Para verificar continuidad, asegúrate de que el circuito esté sin energía. `;
                    specificHint += `Busca un camino conductor continuo entre los puntos.`;
                    break;
            }
            
            return `${specificHint} Verifica que estés usando el modo ${exercise.mode} y conectando los puntos ${exercise.correctPoints.join(' y ')}.`;
        }

        function getCorrectMode(exerciseType) {
            const modeMap = {
                'voltage': 'voltage',
                'current': 'current_a',
                'resistance': 'resistance',
                'capacitance': 'capacitance',
                'conductance': 'conductance',
                'continuity': 'continuity'
            };
            return modeMap[exerciseType] || 'voltage';
        }

        function showFeedback(type, message) {
            const feedback = document.getElementById('feedback');
            feedback.className = `feedback ${type} show`;
            feedback.textContent = message;
            
            setTimeout(() => {
                feedback.classList.remove('show');
            }, 5000);
        }

        function nextExercise() {
            if (currentExercise < exercises.length - 1) {
                currentExercise++;
                loadExercise();
            }
        }

        function previousExercise() {
            if (currentExercise > 0) {
                currentExercise--;
                loadExercise();
            }
        }

        function resetCurrentExercise() {
            resetConnections();
            currentMode = 'off';
            document.getElementById('pointer').style.transform = 'translateX(-50%) rotate(0deg)';
            updateDisplay();
            updateSteps();
        }

        // Función para actualizar etiquetas después de cargar ejercicio
        function updateExerciseLabels() {
            const t = translations[currentLanguage];
            
            // Actualizar etiquetas principales del ejercicio
            document.getElementById('exercise-label').textContent = t.exerciseTitle;
            document.getElementById('objective-label').textContent = t.objective;
            document.getElementById('mode-label').textContent = t.modeNeeded;
            document.getElementById('connection-label').textContent = t.connection;
            document.getElementById('hint-label').textContent = t.hint;
        }

        // Función para actualizar tooltips de componentes
        function updateComponentTooltips() {
            const t = translations[currentLanguage];
            
            // Buscar elementos con onclick y actualizar sus tooltips
            const batteryElement = document.querySelector('[onclick="changeBattery()"]');
            if (batteryElement) batteryElement.setAttribute('title', t.batteryTooltip);
            
            const resistorElement = document.querySelector('[onclick="changeResistor()"]');
            if (resistorElement) resistorElement.setAttribute('title', t.resistorTooltip);
            
            const ledElement = document.querySelector('[onclick="changeLED()"]');
            if (ledElement) ledElement.setAttribute('title', t.ledTooltip);
            
            const capacitorElement = document.querySelector('[onclick="changeCapacitor()"]');
            if (capacitorElement) capacitorElement.setAttribute('title', t.capacitorTooltip);
        }

        // Funciones para cambiar componentes (mejoradas para mantener conexiones)
        function changeBattery() {
            currentBattery = (currentBattery + 1) % batteries.length;
            updateComponentInPlace('battery');
        }

        function changeResistor() {
            currentResistor = (currentResistor + 1) % resistors.length;
            updateComponentInPlace('resistor');
        }

        function changeLED() {
            currentLED = (currentLED + 1) % leds.length;
            updateComponentInPlace('led');
        }

        function changeCapacitor() {
            currentCapacitor = (currentCapacitor + 1) % capacitors.length;
            updateComponentInPlace('capacitor');
        }

        // Nueva función para actualizar componentes sin perder conexiones
        function updateComponentInPlace(componentType) {
            // Mantener el estado actual de conexiones
            const savedConnections = { ...probeConnections };
            const savedConnectionState = connectionState;
            const savedMode = currentMode;
            
            // Efecto visual en el componente que está cambiando
            addComponentUpdateEffect(componentType);
            
            // Solo actualizar el circuito visual y la información
            const exercise = exercises[currentExercise];
            renderCircuit(exercise.circuit);
            
            // Restaurar el estado de conexiones
            probeConnections = savedConnections;
            connectionState = savedConnectionState;
            currentMode = savedMode;
            
            // Actualizar información de componentes con animación
            updateComponentInfoAnimated(componentType);
            
            // Restaurar el estado visual de las conexiones
            if (probeConnections.red || probeConnections.black) {
                updateMeasurementPointsVisual('connections-made');
                
                // Restaurar el estado visual de las puntas
                if (probeConnections.red) {
                    const redPoint = document.querySelector(`[data-point="${probeConnections.red}"]`);
                    if (redPoint) redPoint.classList.add('red-connected');
                }
                if (probeConnections.black) {
                    const blackPoint = document.querySelector(`[data-point="${probeConnections.black}"]`);
                    if (blackPoint) blackPoint.classList.add('black-connected');
                }
            }
            
            // Actualizar la pantalla con los nuevos valores
            updateDisplay();
            
            // NUEVO: Actualizar cálculos en tiempo real si el panel educativo está visible
            updateEducationalContentInRealTime();
            
            // Mostrar feedback del cambio
            const componentNames = {
                'battery': `Batería: ${batteries[currentBattery].name}`,
                'resistor': `Resistor: ${resistors[currentResistor].name}`,
                'led': `LED: ${leds[currentLED].name}`,
                'capacitor': `Condensador: ${capacitors[currentCapacitor].name}`
            };
            
            const t = translations[currentLanguage];
            showFeedback('success', `${t.measurementUpdated} - ${componentNames[componentType]}`);
            
            // Efecto visual en la pantalla para mostrar el cambio
            const display = document.getElementById('display');
            display.style.animation = 'none';
            setTimeout(() => {
                display.style.animation = 'pulse 0.8s ease-in-out';
            }, 10);
        }

        // Función para agregar efecto visual al componente que cambia
        function addComponentUpdateEffect(componentType) {
            // Encontrar el elemento del componente en el SVG y agregar efecto
            setTimeout(() => {
                const circuit = document.getElementById('circuit');
                const svg = circuit.querySelector('svg');
                if (svg) {
                    // Agregar clase de actualización temporal
                    svg.classList.add('component-updating');
                    setTimeout(() => {
                        svg.classList.remove('component-updating');
                    }, 600);
                }
            }, 50);
        }

        // Función para actualizar información de componentes con animación
        function updateComponentInfoAnimated(componentType) {
            const infoElements = {
                'battery': document.getElementById('current-battery-info'),
                'resistor': document.getElementById('current-resistor-info'),
                'led': document.getElementById('current-led-info'),
                'capacitor': document.getElementById('current-capacitor-info')
            };
            
            const element = infoElements[componentType];
            if (element) {
                // Efecto de parpadeo para mostrar el cambio
                element.style.transition = 'all 0.3s ease';
                element.style.backgroundColor = '#e8f4fd';
                element.style.transform = 'scale(1.05)';
                
                // Actualizar el contenido
                updateComponentInfo();
                
                // Restaurar el estilo después de la animación
                setTimeout(() => {
                    element.style.backgroundColor = 'white';
                    element.style.transform = 'scale(1)';
                }, 300);
            } else {
                // Fallback: actualizar normalmente
                updateComponentInfo();
            }
        }

        // Funciones del multímetro mejoradas
        let holdMode = false;
        let autoMode = true;
        let backlightOn = false;
        let heldValue = null;

        function toggleHold() {
            holdMode = !holdMode;
            const display = document.getElementById('display');
            const indicators = document.querySelector('.display-indicators');
            const t = translations[currentLanguage];
            
            if (holdMode) {
                heldValue = display.textContent;
                indicators.style.color = '#ffd700';
                showFeedback('success', t.holdActivated);
            } else {
                heldValue = null;
                indicators.style.color = '#666';
                updateDisplay();
                showFeedback('success', t.holdDeactivated);
            }
        }

        function toggleAuto() {
            autoMode = !autoMode;
            const indicators = document.querySelector('.display-indicators');
            const t = translations[currentLanguage];
            
            if (autoMode) {
                indicators.querySelector('span:first-child').style.color = '#00ff41';
                showFeedback('success', t.autoActivated);
            } else {
                indicators.querySelector('span:first-child').style.color = '#666';
                showFeedback('success', t.autoDeactivated);
            }
        }

        function toggleBacklight() {
            backlightOn = !backlightOn;
            const display = document.getElementById('display');
            const displaySection = document.querySelector('.display-section');
            const t = translations[currentLanguage];
            
            if (backlightOn) {
                display.style.backgroundColor = '#001a00';
                display.style.boxShadow = '0 0 20px #00ff41, inset 0 0 20px rgba(0,255,65,0.2)';
                displaySection.style.boxShadow = '0 0 30px rgba(0,255,65,0.5), inset 0 2px 4px rgba(0,0,0,0.8)';
                showFeedback('success', t.backlightOn);
            } else {
                display.style.backgroundColor = '#000';
                display.style.boxShadow = 'none';
                displaySection.style.boxShadow = 'inset 0 2px 4px rgba(0,0,0,0.8), 0 2px 4px rgba(255,255,255,0.1)';
                showFeedback('success', t.backlightOff);
            }
        }

        function resetDisplay() {
            resetConnections();
            holdMode = false;
            heldValue = null;
            backlightOn = false;
            autoMode = true;
            const t = translations[currentLanguage];
            
            // Resetear estilos
            const display = document.getElementById('display');
            const displaySection = document.querySelector('.display-section');
            const indicators = document.querySelector('.display-indicators');
            
            display.style.backgroundColor = '#000';
            display.style.boxShadow = 'none';
            displaySection.style.boxShadow = 'inset 0 2px 4px rgba(0,0,0,0.8), 0 2px 4px rgba(255,255,255,0.1)';
            indicators.style.color = '#666';
            indicators.querySelector('span:first-child').style.color = '#00ff41';
            
            updateDisplay();
            showFeedback('success', t.multimeterReset);
        }

        // Nueva función para actualizar contenido educativo en tiempo real
        function updateEducationalContentInRealTime() {
            const panel = document.getElementById('educational-panel');
            
            // Solo actualizar si el panel está visible
            if (panel.style.display === 'block') {
                const exercise = exercises[currentExercise];
                const calculationElement = document.getElementById('concept-calculation');
                
                if (calculationElement) {
                    // Actualizar solo la sección de cálculo con efecto visual
                    calculationElement.style.transition = 'all 0.4s ease';
                    calculationElement.style.backgroundColor = 'rgba(255, 255, 255, 0.2)';
                    calculationElement.style.transform = 'scale(1.02)';
                    
                    // Actualizar el contenido del cálculo
                    calculationElement.textContent = generateDynamicCalculation(exercise);
                    
                    // Restaurar el estilo después de la animación
                    setTimeout(() => {
                        calculationElement.style.backgroundColor = 'rgba(255, 255, 255, 0.1)';
                        calculationElement.style.transform = 'scale(1)';
                    }, 400);
                }
            }
        }

        function showEducationalContent() {
            const exercise = exercises[currentExercise];
            const panel = document.getElementById('educational-panel');
            const t = translations[currentLanguage];
            
            if (panel.style.display === 'none' || !panel.style.display) {
                // Mostrar panel educativo
                const explanation = exercise.detailedExplanation;
                
                console.log('Mostrando panel educativo en idioma:', currentLanguage);
                
                // Actualizar títulos según el idioma con verificación de existencia
                const conceptTitle = document.getElementById('concept-title');
                if (conceptTitle) {
                    conceptTitle.textContent = `${t.educationalPanelTitle} ${t.exercises[currentExercise].title}`;
                    console.log('Título principal actualizado:', conceptTitle.textContent);
                }
                
                // Actualizar todos los títulos de sección
                const titleUpdates = [
                    { id: 'concept-what-is-title', text: t.whatIs },
                    { id: 'concept-analogy-title', text: t.analogy },
                    { id: 'concept-units-title', text: t.units },
                    { id: 'concept-measurement-title', text: t.howToMeasure },
                    { id: 'concept-safety-title', text: t.safety },
                    { id: 'concept-calculation-title', text: t.calculation },
                    { id: 'concept-realworld-title', text: t.realWorld },
                    { id: 'hide-explanation-text', text: t.hideExplanation }
                ];
                
                titleUpdates.forEach(update => {
                    const element = document.getElementById(update.id);
                    if (element) {
                        element.textContent = update.text;
                        console.log(`Título ${update.id} actualizado a:`, update.text);
                    } else {
                        console.log(`Elemento ${update.id} no encontrado`);
                    }
                });
                
                // Actualizar contenido con verificación de existencia
                const contentUpdates = [
                    { id: 'concept-definition', text: explanation.concept },
                    { id: 'concept-analogy', text: explanation.analogy },
                    { id: 'concept-units', text: explanation.units },
                    { id: 'concept-measurement', text: explanation.measurement },
                    { id: 'concept-safety', text: explanation.safety },
                    { id: 'concept-calculation', text: generateDynamicCalculation(exercise) },
                    { id: 'concept-realworld', text: explanation.realWorld }
                ];
                
                contentUpdates.forEach(update => {
                    const element = document.getElementById(update.id);
                    if (element) {
                        element.textContent = update.text;
                        console.log(`Contenido ${update.id} actualizado`);
                    } else {
                        console.log(`Elemento de contenido ${update.id} no encontrado`);
                    }
                });
                
                panel.style.display = 'block';
                
                // Forzar actualización después de mostrar el panel
                setTimeout(() => {
                    updateAllEducationalElements();
                }, 100);
                
            } else {
                panel.style.display = 'none';
            }
        }

        // Nueva función para actualizar el panel educativo cuando cambia el idioma
        function updateEducationalPanel() {
            const panel = document.getElementById('educational-panel');
            
            // Solo actualizar si el panel está visible
            if (panel.style.display === 'block') {
                const exercise = exercises[currentExercise];
                const explanation = exercise.detailedExplanation;
                const t = translations[currentLanguage];
                
                // Actualizar títulos según el idioma
                const conceptTitle = document.getElementById('concept-title');
                if (conceptTitle) conceptTitle.textContent = `${t.educationalPanelTitle} ${t.exercises[currentExercise].title}`;
                
                const conceptWhatIsTitle = document.getElementById('concept-what-is-title');
                if (conceptWhatIsTitle) conceptWhatIsTitle.textContent = t.whatIs;
                
                const conceptAnalogyTitle = document.getElementById('concept-analogy-title');
                if (conceptAnalogyTitle) conceptAnalogyTitle.textContent = t.analogy;
                
                const conceptUnitsTitle = document.getElementById('concept-units-title');
                if (conceptUnitsTitle) conceptUnitsTitle.textContent = t.units;
                
                const conceptMeasurementTitle = document.getElementById('concept-measurement-title');
                if (conceptMeasurementTitle) conceptMeasurementTitle.textContent = t.howToMeasure;
                
                const conceptSafetyTitle = document.getElementById('concept-safety-title');
                if (conceptSafetyTitle) conceptSafetyTitle.textContent = t.safety;
                
                const conceptCalculationTitle = document.getElementById('concept-calculation-title');
                if (conceptCalculationTitle) conceptCalculationTitle.textContent = t.calculation;
                
                const conceptRealworldTitle = document.getElementById('concept-realworld-title');
                if (conceptRealworldTitle) conceptRealworldTitle.textContent = t.realWorld;
                
                const hideExplanationBtn = document.getElementById('hide-explanation-text');
                if (hideExplanationBtn) hideExplanationBtn.textContent = t.hideExplanation;
                
                // Actualizar contenido
                const conceptDefinition = document.getElementById('concept-definition');
                if (conceptDefinition) conceptDefinition.textContent = explanation.concept;
                
                const conceptAnalogy = document.getElementById('concept-analogy');
                if (conceptAnalogy) conceptAnalogy.textContent = explanation.analogy;
                
                const conceptUnits = document.getElementById('concept-units');
                if (conceptUnits) conceptUnits.textContent = explanation.units;
                
                const conceptMeasurement = document.getElementById('concept-measurement');
                if (conceptMeasurement) conceptMeasurement.textContent = explanation.measurement;
                
                const conceptSafety = document.getElementById('concept-safety');
                if (conceptSafety) conceptSafety.textContent = explanation.safety;
                
                const conceptCalculation = document.getElementById('concept-calculation');
                if (conceptCalculation) conceptCalculation.textContent = generateDynamicCalculation(exercise);
                
                const conceptRealworld = document.getElementById('concept-realworld');
                if (conceptRealworld) conceptRealworld.textContent = explanation.realWorld;
            }
        }

        // Nueva función para generar cálculos dinámicos
        function generateDynamicCalculation(exercise) {
            const battery = batteries[currentBattery];
            const resistor = resistors[currentResistor];
            const led = leds[currentLED];
            const capacitor = capacitors[currentCapacitor];
            
            switch (exercise.type) {
                case 'voltage':
                    if (exercise.circuit === 'battery') {
                        return `V_batería = ${battery.voltage}V (voltaje nominal de ${battery.name})`;
                    } else if (exercise.circuit === 'led') {
                        const totalR = resistor.resistance + (led.voltage / 0.02);
                        const current = battery.voltage / totalR;
                        const vResistor = current * resistor.resistance;
                        return `V_total = ${battery.voltage}V, I = V/R_total = ${battery.voltage}V/${totalR.toFixed(0)}Ω = ${current.toFixed(3)}A
V_resistor = I × R = ${current.toFixed(3)}A × ${resistor.resistance}Ω = ${vResistor.toFixed(2)}V
V_LED = ${led.voltage}V (caída directa del ${led.name})`;
                    } else if (exercise.circuit === 'resistor') {
                        return `Sin fuente de voltaje conectada: V = 0V
Con ${battery.name}: V = I × R = I × ${resistor.resistance}Ω`;
                    }
                    break;
                    
                case 'current':
                    if (exercise.circuit === 'led') {
                        const ledR = led.voltage / 0.02;
                        const totalR = resistor.resistance + ledR;
                        const current = battery.voltage / totalR;
                        return `Ley de Ohm: I = V/R_total
R_total = R_resistor + R_LED = ${resistor.resistance}Ω + ${ledR.toFixed(0)}Ω = ${totalR.toFixed(0)}Ω
I = ${battery.voltage}V / ${totalR.toFixed(0)}Ω = ${current.toFixed(3)}A = ${(current * 1000).toFixed(1)}mA
(Corriente segura para ${led.name}: máx 20-30mA)`;
                    } else if (exercise.circuit === 'resistor') {
                        const current = battery.voltage / resistor.resistance;
                        return `Ley de Ohm: I = V/R = ${battery.voltage}V / ${resistor.resistance}Ω = ${current.toFixed(3)}A`;
                    }
                    break;
                    
                case 'resistance':
                    if (exercise.circuit === 'resistor') {
                        const tolerance = parseFloat(resistor.tolerance.replace('%', ''));
                        const minR = resistor.resistance * (1 - tolerance/100);
                        const maxR = resistor.resistance * (1 + tolerance/100);
                        return `R_nominal = ${resistor.resistance}Ω (${resistor.name})
Tolerancia = ±${tolerance}% 
Rango real: ${minR.toFixed(1)}Ω - ${maxR.toFixed(1)}Ω
Código de colores: ${getColorCodeDescription(resistor)}`;
                    } else if (exercise.circuit === 'led') {
                        const ledR = led.voltage / 0.02;
                        return `R_LED_dinámica = V_LED / I_LED = ${led.voltage}V / 0.02A = ${ledR.toFixed(0)}Ω
(Resistencia dinámica del ${led.name} cuando conduce)
Esta resistencia varía con la corriente y temperatura`;
                    }
                    break;
                    
                case 'capacitance':
                    const capValue = parseFloat(capacitor.name.match(/(\d+(?:\.\d+)?)/)[1]);
                    const capUnit = capacitor.name.match(/([µnp]?F)/)[1];
                    return `C = ${capValue}${capUnit} (${capacitor.name})
Voltaje máximo = ${capacitor.voltage}
Energía almacenada: E = ½CV² = ½ × ${capValue}×10⁻⁶F × (${capacitor.voltage.replace('V', '')})² = ${((0.5 * capValue * 1e-6 * Math.pow(parseInt(capacitor.voltage), 2)) * 1000).toFixed(3)}mJ
Tiempo de carga (τ = RC): depende de la resistencia del circuito`;
                    
                case 'continuity':
                    if (exercise.circuit === 'resistor') {
                        return `Continuidad: R < 50Ω típicamente = ♪ (pitido)
${resistor.name} = ${resistor.resistance}Ω
${resistor.resistance < 50 ? '✓ Continuidad detectada' : '✗ Resistencia alta, pitido débil'}
El multímetro aplica ~3V y mide si I > 1mA`;
                    } else {
                        return `Continuidad verifica: R < 50Ω = ♪ (pitido)
Circuito abierto: R = ∞ = silencio
El multímetro inyecta corriente pequeña y verifica respuesta`;
                    }
                    break;
                    
                default:
                    return exercise.detailedExplanation.calculation;
            }
            
            return exercise.detailedExplanation.calculation;
        }

        // Función auxiliar para describir código de colores
        function getColorCodeDescription(resistor) {
            const colorNames = {
                '#8B4513': 'Marrón', '#FF0000': 'Rojo', '#FFA500': 'Naranja', 
                '#FFFF00': 'Amarillo', '#008000': 'Verde', '#0000FF': 'Azul',
                '#9370DB': 'Violeta', '#808080': 'Gris', '#FFFFFF': 'Blanco',
                '#000000': 'Negro', '#FFD700': 'Dorado', '#C0C0C0': 'Plateado'
            };
            
            if (resistor.colors && resistor.colors.length >= 4) {
                const colors = resistor.colors.map(color => colorNames[color] || 'Desconocido');
                return `${colors[0]}-${colors[1]}-${colors[2]}-${colors[3]}`;
            }
            return 'Código estándar de 4 bandas';
        }

        function toggleEducationalPanel() {
            const panel = document.getElementById('educational-panel');
            panel.style.display = 'none';
        }

        // Función para mostrar la celebración de maestría
        function showMasteryAchievement() {
            // Actualizar estadísticas en el modal
            document.getElementById('mastery-exercises').textContent = exercises.length;
            
            // Crear efecto de confeti
            createConfetti();
            
            // Mostrar el modal con animación
            const modal = document.getElementById('mastery-modal');
            modal.style.display = 'block';
            
            // Animar la entrada del modal
            const content = modal.querySelector('.glossary-content');
            content.style.animation = 'fadeInUp 0.8s ease-out';
            
            // Reproducir sonido de celebración (simulado con vibración si está disponible)
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200, 100, 200]);
            }
            
            // Mostrar feedback especial
            const t = translations[currentLanguage];
            showFeedback('success', t.masteryUnlocked);
        }

        // Función para crear efecto de confeti mejorado
        function createConfetti() {
            const colors = ['#FFD700', '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#FF8C00', '#32CD32', '#FF69B4', '#00CED1'];
            const shapes = ['circle', 'square', 'triangle'];
            
            // Crear múltiples oleadas de confeti
            for (let wave = 0; wave < 3; wave++) {
                setTimeout(() => {
                    for (let i = 0; i < 30; i++) {
                        setTimeout(() => {
                            const confetti = document.createElement('div');
                            confetti.className = 'confetti';
                            
                            // Posición aleatoria
                            confetti.style.left = Math.random() * 100 + 'vw';
                            
                            // Color aleatorio
                            const color = colors[Math.floor(Math.random() * colors.length)];
                            confetti.style.backgroundColor = color;
                            
                            // Tamaño aleatorio
                            const size = Math.random() * 12 + 6;
                            confetti.style.width = size + 'px';
                            confetti.style.height = size + 'px';
                            
                            // Forma aleatoria
                            const shape = shapes[Math.floor(Math.random() * shapes.length)];
                            if (shape === 'circle') {
                                confetti.style.borderRadius = '50%';
                            } else if (shape === 'triangle') {
                                confetti.style.borderRadius = '0';
                                confetti.style.transform = 'rotate(45deg)';
                            }
                            
                            // Duración y delay aleatorios
                            confetti.style.animationDuration = (Math.random() * 3 + 3) + 's';
                            confetti.style.animationDelay = Math.random() * 1 + 's';
                            
                            // Agregar brillo
                            confetti.style.boxShadow = `0 0 10px ${color}`;
                            
                            document.body.appendChild(confetti);
                            
                            // Remover el confeti después de la animación
                            setTimeout(() => {
                                if (confetti.parentNode) {
                                    confetti.parentNode.removeChild(confetti);
                                }
                            }, 8000);
                        }, i * 50);
                    }
                }, wave * 1000);
            }
            
            // Crear algunos confetis especiales más grandes
            setTimeout(() => {
                for (let i = 0; i < 10; i++) {
                    setTimeout(() => {
                        const specialConfetti = document.createElement('div');
                        specialConfetti.style.position = 'fixed';
                        specialConfetti.style.left = Math.random() * 100 + 'vw';
                        specialConfetti.style.top = '-50px';
                        specialConfetti.style.fontSize = '2rem';
                        specialConfetti.style.zIndex = '10001';
                        specialConfetti.style.animation = 'confetti 5s linear infinite';
                        specialConfetti.style.animationDelay = Math.random() * 2 + 's';
                        
                        const symbols = ['🏆', '⭐', '🎉', '🎊', '✨', '🌟', '💫', '🎈'];
                        specialConfetti.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                        
                        document.body.appendChild(specialConfetti);
                        
                        setTimeout(() => {
                            if (specialConfetti.parentNode) {
                                specialConfetti.parentNode.removeChild(specialConfetti);
                            }
                        }, 8000);
                    }, i * 200);
                }
            }, 500);
        }

        // Función para cerrar el modal de maestría
        function closeMasteryModal() {
            const modal = document.getElementById('mastery-modal');
            modal.style.display = 'none';
            
            // Limpiar cualquier confeti restante
            const confettiElements = document.querySelectorAll('.confetti');
            confettiElements.forEach(confetti => {
                if (confetti.parentNode) {
                    confetti.parentNode.removeChild(confetti);
                }
            });
        }

        // Función para reiniciar todo el progreso
        function resetAllProgress() {
            // Confirmar la acción
            const t = translations[currentLanguage];
                
            if (confirm(t.confirmReset)) {
                // Reiniciar variables de progreso
                completedExercises.clear();
                currentExercise = 0;
                
                // Reiniciar el multímetro
                resetDisplay();
                
                // Cargar el primer ejercicio
                loadExercise();
                
                // Cerrar el modal
                closeMasteryModal();
                
                // Mostrar confirmación
                showFeedback('success', t.progressReset);
            }
        }

        // Cerrar modales al hacer clic fuera
        window.onclick = function(event) {
            const glossaryModal = document.getElementById('glossary-modal');
            const exerciseModal = document.getElementById('exercise-selector-modal');
            const multimeterModal = document.getElementById('multimeter-guide-modal');
            const masteryModal = document.getElementById('mastery-modal');
            
            if (event.target === glossaryModal) {
                closeGlossary();
            }
            if (event.target === exerciseModal) {
                closeExerciseSelector();
            }
            if (event.target === multimeterModal) {
                closeMultimeterGuide();
            }
            if (event.target === masteryModal) {
                closeMasteryModal();
            }
        }

        // Función para cambiar idioma
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'es' ? 'en' : 'es';
            console.log('Cambiando idioma a:', currentLanguage);
            updateLanguage();
            
            const t = translations[currentLanguage];
            showFeedback('success', t.languageChanged);
        }

        // Función para actualizar todos los textos según el idioma
        function updateLanguage() {
            console.log('Iniciando actualización de idioma a:', currentLanguage);
            
            // Usar la función completa de actualización de interfaz
            updateCompleteInterface();
            
            // Recargar el ejercicio actual con las nuevas traducciones
            loadExercise();
            
            // Actualizar estado de las puntas
            updateProbeStatus();
            
            // Actualizar panel educativo si está visible
            const panel = document.getElementById('educational-panel');
            if (panel && panel.style.display === 'block') {
                console.log('Panel educativo visible, actualizando...');
                updateEducationalPanel();
                
                // Múltiples intentos de actualización para asegurar que funcione
                setTimeout(() => {
                    console.log('Primera actualización de elementos educativos...');
                    updateAllEducationalElements();
                }, 50);
                
                setTimeout(() => {
                    console.log('Segunda actualización de elementos educativos...');
                    updateAllEducationalElements();
                }, 200);
                
                setTimeout(() => {
                    console.log('Tercera actualización de elementos educativos...');
                    updateAllEducationalElements();
                }, 500);
            }
            
            // Actualización adicional de elementos que pueden no haberse actualizado
            setTimeout(() => {
                console.log('Actualización final de elementos faltantes...');
                updateMissingElements();
            }, 600);
            
            console.log('Actualización de idioma completada');
        }
        
        // Nueva función para actualizar elementos que pueden haberse perdido
        function updateMissingElements() {
            const t = translations[currentLanguage];
            
            // Buscar y actualizar elementos por texto específico
            const allTextElements = document.querySelectorAll('*');
            allTextElements.forEach(element => {
                // Solo procesar elementos de texto (no contenedores)
                if (element.children.length === 0 && element.textContent.trim()) {
                    const text = element.textContent.trim();
                    
                    // Mapeo exhaustivo de textos conocidos
                    const textMappings = {
                        // Títulos principales
                        '⚡ Simulador de Multímetro Digital': t.mainTitle,
                        '⚡ Digital Multimeter Simulator': t.mainTitle,
                        
                        // Multímetro
                        'Tu Multímetro Virtual': t.multimeterTitle,
                        'Your Virtual Multimeter': t.multimeterTitle,
                        'Multímetro Hericraft': t.multimeterBrand,
                        'Hericraft Multimeter': t.multimeterBrand,
                        'Puertos de Conexión': t.portsLabel,
                        'Connection Ports': t.portsLabel,
                        'Puntas de Prueba': t.probesLabel,
                        'Test Probes': t.probesLabel,
                        
                        // Botones del multímetro
                        'HOLD': t.holdButton,
                        'AUTO': t.autoButton,
                        'LIGHT': t.lightButton,
                        'RESET': t.resetButton,
                        
                        // Ejercicios
                        '🎯 Ejercicio:': t.exerciseTitle,
                        '🎯 Exercise:': t.exerciseTitle,
                        '📋 Seleccionar Ejercicio': t.selectExercise,
                        '📋 Select Exercise': t.selectExercise,
                        '📖 Objetivo:': t.objective,
                        '📖 Objective:': t.objective,
                        '🔧 Modo necesario:': t.modeNeeded,
                        '🔧 Required mode:': t.modeNeeded,
                        '📍 Conexión:': t.connection,
                        '📍 Connection:': t.connection,
                        '💡 Pista:': t.hint,
                        '💡 Hint:': t.hint,
                        
                        // Estados de conexión
                        '🔌 Estado de Conexión del Multímetro': t.connectionTitle,
                        '🔌 Multimeter Connection Status': t.connectionTitle,
                        'Desconectado': t.disconnected,
                        'Disconnected': t.disconnected,
                        'Parcialmente Conectado': t.partiallyConnected,
                        'Partially Connected': t.partiallyConnected,
                        'Completamente Conectado': t.fullyConnected,
                        'Fully Connected': t.fullyConnected,
                        'Punta Roja (+)': t.redProbe,
                        'Red Probe (+)': t.redProbe,
                        'Punta Negra (-)': t.blackProbe,
                        'Black Probe (-)': t.blackProbe,
                        'Puerto VΩmA': t.redPort,
                        'VΩmA Port': t.redPort,
                        'Puerto COM': t.blackPort,
                        'COM Port': t.blackPort,
                        
                        // Instrucciones
                        'Guía de Conexión Paso a Paso': t.instructionsTitle,
                        'Step-by-Step Connection Guide': t.instructionsTitle,
                        'Selecciona la punta roja': t.step1,
                        'Select the red probe': t.step1,
                        'Haz clic en la punta roja del multímetro': t.step1Desc,
                        'Click on the red probe of the multimeter': t.step1Desc,
                        'Conecta al punto del circuito': t.step2,
                        'Connect to circuit point': t.step2,
                        'Selecciona la punta negra': t.step3,
                        'Select the black probe': t.step3,
                        'Haz clic en la punta negra del multímetro': t.step3Desc,
                        'Click on the black probe of the multimeter': t.step3Desc,
                        'Completa la conexión': t.step4,
                        'Complete the connection': t.step4,
                        
                        // Botones de ayuda
                        '📚 Recursos de Aprendizaje': t.learningResources,
                        '📚 Learning Resources': t.learningResources,
                        'Explicación Detallada': t.detailedExplanation,
                        'Detailed Explanation': t.detailedExplanation,
                        'Conceptos y teoría': t.conceptsTheory,
                        'Concepts and theory': t.conceptsTheory,
                        'Glosario Técnico': t.technicalGlossary,
                        'Technical Glossary': t.technicalGlossary,
                        'Componentes y términos': t.componentsTerms,
                        'Components and terms': t.componentsTerms,
                        'Partes del Multímetro': t.multimeterParts,
                        'Multimeter Parts': t.multimeterParts,
                        'Funciones y componentes': t.functionsComponents,
                        'Functions and components': t.functionsComponents,
                        
                        // Verificación
                        'Verificar Medición': t.verifyMeasurement,
                        'Verify Measurement': t.verifyMeasurement,
                        'Comprobar si la conexión es correcta': t.checkConnection,
                        'Check if the connection is correct': t.checkConnection,
                        
                        // Componentes
                        'Componentes Actuales del Circuito': t.currentComponents,
                        'Current Circuit Components': t.currentComponents,
                        'Batería:': t.battery,
                        'Battery:': t.battery,
                        'Resistor:': t.resistor,
                        'LED:': t.led,
                        'Condensador:': t.capacitor,
                        'Capacitor:': t.capacitor,
                        
                        // Panel educativo
                        '🔬 ¿Qué es?': t.whatIs,
                        '🔬 What is it?': t.whatIs,
                        '🌊 Analogía': t.analogy,
                        '🌊 Analogy': t.analogy,
                        '📏 Unidades': t.units,
                        '📏 Units': t.units,
                        '🔧 Cómo medir': t.howToMeasure,
                        '🔧 How to measure': t.howToMeasure,
                        '⚠️ Seguridad': t.safety,
                        '⚠️ Safety': t.safety,
                        '🧮 Cálculo': t.calculation,
                        '🧮 Calculation': t.calculation,
                        '🌍 Mundo real': t.realWorld,
                        '🌍 Real world': t.realWorld,
                        'Ocultar Explicación': t.hideExplanation,
                        'Hide Explanation': t.hideExplanation,
                        
                        // Idioma
                        'English': currentLanguage === 'es' ? 'English' : 'Español',
                        'Español': currentLanguage === 'es' ? 'English' : 'Español'
                    };
                    
                    if (textMappings[text]) {
                        element.textContent = textMappings[text];
                        console.log(`Elemento faltante actualizado: "${text}" -> "${textMappings[text]}"`);
                    }
                }
            });
        }
        
        // Nueva función para actualizar todos los elementos educativos
        function updateAllEducationalElements() {
            const t = translations[currentLanguage];
            
            console.log('Actualizando elementos educativos al idioma:', currentLanguage);
            
            // Actualizar elementos específicos por ID primero
            const specificElements = {
                'concept-what-is-title': t.whatIs,
                'concept-analogy-title': t.analogy,
                'concept-units-title': t.units,
                'concept-measurement-title': t.howToMeasure,
                'concept-safety-title': t.safety,
                'concept-calculation-title': t.calculation,
                'concept-realworld-title': t.realWorld,
                'hide-explanation-text': t.hideExplanation
            };
            
            Object.entries(specificElements).forEach(([id, text]) => {
                const element = document.getElementById(id);
                if (element) {
                    console.log(`Actualizando elemento ${id} a: ${text}`);
                    element.textContent = text;
                } else {
                    console.log(`Elemento ${id} no encontrado`);
                }
            });
            
            // Buscar elementos por contenido como respaldo
            const textMappings = [
                { search: ['🔬 ¿Qué es?', '🔬 What is it?'], replace: t.whatIs },
                { search: ['🌊 Analogía', '🌊 Analogy'], replace: t.analogy },
                { search: ['📏 Unidades', '📏 Units'], replace: t.units },
                { search: ['🔧 Cómo medir', '🔧 How to measure'], replace: t.howToMeasure },
                { search: ['⚠️ Seguridad', '⚠️ Safety'], replace: t.safety },
                { search: ['🧮 Cálculo', '🧮 Calculation'], replace: t.calculation },
                { search: ['🌍 Mundo real', '🌍 Real world'], replace: t.realWorld },
                { search: ['Ocultar Explicación', 'Hide Explanation'], replace: t.hideExplanation }
            ];
            
            // Buscar en todos los h5 con color dorado
            const goldHeaders = document.querySelectorAll('h5[style*="color: #ffd700"], h5[style*="color:#ffd700"]');
            goldHeaders.forEach(header => {
                const currentText = header.textContent.trim();
                const mapping = textMappings.find(m => m.search.includes(currentText));
                if (mapping) {
                    console.log(`Actualizando header "${currentText}" a "${mapping.replace}"`);
                    header.textContent = mapping.replace;
                }
            });
            
            // Buscar en todos los h5 con color específico para seguridad
            const safetyHeaders = document.querySelectorAll('h5[style*="color: #ffcccb"], h5[style*="color:#ffcccb"]');
            safetyHeaders.forEach(header => {
                const currentText = header.textContent.trim();
                if (currentText.includes('Seguridad') || currentText.includes('Safety')) {
                    console.log(`Actualizando safety header "${currentText}" a "${t.safety}"`);
                    header.textContent = t.safety;
                }
            });
            
            // Buscar elementos span específicos
            const spans = document.querySelectorAll('span');
            spans.forEach(span => {
                const currentText = span.textContent.trim();
                const mapping = textMappings.find(m => m.search.includes(currentText));
                if (mapping) {
                    console.log(`Actualizando span "${currentText}" a "${mapping.replace}"`);
                    span.textContent = mapping.replace;
                }
            });
            
            // Forzar actualización del botón de ocultar explicación
            const hideButton = document.querySelector('button[onclick="toggleEducationalPanel()"]');
            if (hideButton) {
                const buttonSpan = hideButton.querySelector('span');
                if (buttonSpan) {
                    console.log(`Actualizando botón ocultar a: ${t.hideExplanation}`);
                    buttonSpan.textContent = t.hideExplanation;
                } else {
                    // Si no hay span, actualizar el texto del botón directamente
                    hideButton.textContent = t.hideExplanation;
                }
            }
        }
        
        // Nueva función para actualizar textos de modales
        function updateModalTexts() {
            const t = translations[currentLanguage];
            
            // Modal de glosario
            const glossaryTitle = document.getElementById('glossary-modal-title');
            if (glossaryTitle) glossaryTitle.textContent = t.glossaryModalTitle;
            
            const glossarySubtitle = document.getElementById('glossary-modal-subtitle');
            if (glossarySubtitle) glossarySubtitle.textContent = t.glossaryModalSubtitle;
            
            // Modal de selector de ejercicios
            const exerciseTitle = document.getElementById('exercise-selector-modal-title');
            if (exerciseTitle) exerciseTitle.textContent = t.exerciseSelectorModalTitle;
            
            const exerciseSubtitle = document.getElementById('exercise-selector-modal-subtitle');
            if (exerciseSubtitle) exerciseSubtitle.textContent = t.exerciseSelectorModalSubtitle;
            
            // Modal de guía del multímetro
            const guideTitle = document.getElementById('multimeter-guide-modal-title');
            if (guideTitle) guideTitle.textContent = t.multimeterGuideModalTitle;
            
            const guideSubtitle = document.getElementById('multimeter-guide-modal-subtitle');
            if (guideSubtitle) guideSubtitle.textContent = t.multimeterGuideModalSubtitle;
            
            // Modal de maestría
            updateMasteryModalTexts();
        }
        
        // Función para actualizar textos del modal de maestría
        function updateMasteryModalTexts() {
            const t = translations[currentLanguage];
            
            const masteryElements = {
                'mastery-congratulations': t.masteryModalTitle,
                'mastery-achieved': t.masteryAchieved,
                'mastery-master-title': t.masteryMasterTitle,
                'mastery-message': t.masteryMessage,
                'mastery-skills': t.masterySkills,
                'mastery-skills-achieved': t.masterySkillsAchieved,
                'mastery-voltage': t.masteryVoltage,
                'mastery-current': t.masteryCurrent,
                'mastery-resistance': t.masteryResistance,
                'mastery-capacitance': t.masteryCapacitance,
                'mastery-continuity': t.masteryContinuity,
                'mastery-exercises-completed': t.masteryExercisesCompleted,
                'mastery-precision-achieved': t.masteryPrecisionAchieved,
                'mastery-techniques-mastered': t.masteryTechniquesMastered,
                'mastery-continue-learning': t.masteryContinueLearning,
                'mastery-next-steps': t.masteryNextSteps
            };
            
            // Actualizar elementos de texto
            Object.entries(masteryElements).forEach(([id, text]) => {
                const element = document.getElementById(id);
                if (element) {
                    if (id === 'mastery-skills-achieved' || id === 'mastery-continue-learning') {
                        // Para elementos con HTML interno, actualizar solo el texto
                        const textNode = element.childNodes[2]; // El texto después del span
                        if (textNode) textNode.textContent = text;
                    } else {
                        element.textContent = text;
                    }
                }
            });
            
            // Actualizar botones del modal de maestría
            const continueBtn = document.getElementById('mastery-continue-btn');
            if (continueBtn) {
                const textSpan = continueBtn.childNodes[2]; // El texto después del span
                if (textSpan) textSpan.textContent = t.masteryContinueBtn;
            }
            
            const resetBtn = document.getElementById('mastery-reset-btn');
            if (resetBtn) {
                const textSpan = resetBtn.childNodes[2]; // El texto después del span
                if (textSpan) textSpan.textContent = t.masteryResetBtn;
            }
        }

        // Función para actualizar tooltips dinámicamente
        function updateTooltips() {
            const t = translations[currentLanguage];
            
            // Actualizar tooltips de puertos
            const comPort = document.getElementById('port-com');
            if (comPort) comPort.title = t.comPortTooltip;
            
            const vPort = document.getElementById('port-v');
            if (vPort) vPort.title = t.vPortTooltip;
            
            const aPort = document.getElementById('port-a');
            if (aPort) aPort.title = t.aPortTooltip;
            
            // Actualizar tooltips de puntas
            const blackProbe = document.getElementById('probe-black');
            if (blackProbe) blackProbe.title = t.blackProbeTooltip;
            
            const redProbe = document.getElementById('probe-red');
            if (redProbe) redProbe.title = t.redProbeTooltip;
        }

        // Función para actualizar textos de la interfaz
        function updateInterfaceTexts() {
            const t = translations[currentLanguage];
            
            // Actualizar botones del multímetro
            const holdBtn = document.getElementById('hold-btn');
            if (holdBtn) holdBtn.textContent = t.holdButton;
            
            const autoBtn = document.getElementById('auto-btn');
            if (autoBtn) autoBtn.textContent = t.autoButton;
            
            const lightBtn = document.getElementById('light-btn');
            if (lightBtn) lightBtn.textContent = t.lightButton;
            
            const resetBtn = document.getElementById('reset-btn');
            if (resetBtn) resetBtn.textContent = t.resetButton;
            
            // Actualizar botón de seleccionar ejercicio
            const selectExerciseText = document.getElementById('select-exercise-text');
            if (selectExerciseText) selectExerciseText.textContent = t.selectExercise;
            
            // Actualizar etiquetas del ejercicio
            const exerciseLabel = document.getElementById('exercise-label');
            if (exerciseLabel) exerciseLabel.textContent = t.exerciseTitle;
            
            const objectiveLabel = document.getElementById('objective-label');
            if (objectiveLabel) objectiveLabel.textContent = t.objective;
            
            const modeLabel = document.getElementById('mode-label');
            if (modeLabel) modeLabel.textContent = t.modeNeeded;
            
            const connectionLabel = document.getElementById('connection-label');
            if (connectionLabel) connectionLabel.textContent = t.connection;
            
            const hintLabel = document.getElementById('hint-label');
            if (hintLabel) hintLabel.textContent = t.hint;
            
            // Actualizar botón de verificación
            const verifyText = document.getElementById('verify-text');
            if (verifyText) verifyText.textContent = t.verifyMeasurementBtn;
            
            const verifySubtitle = document.getElementById('verify-subtitle');
            if (verifySubtitle) verifySubtitle.textContent = t.checkConnectionBtn;
            
            // Actualizar panel de conexión
            const connectionTitle = document.querySelector('.connection-header h4');
            if (connectionTitle) connectionTitle.textContent = t.connectionTitle;
            
            // Actualizar información de puntas
            const redProbeTitle = document.querySelector('.red-probe-card h5');
            if (redProbeTitle) redProbeTitle.textContent = t.redProbe;
            
            const blackProbeTitle = document.querySelector('.black-probe-card h5');
            if (blackProbeTitle) blackProbeTitle.textContent = t.blackProbe;
            
            const redPort = document.querySelector('.red-probe-card .probe-port');
            if (redPort) redPort.textContent = t.redPort;
            
            const blackPort = document.querySelector('.black-probe-card .probe-port');
            if (blackPort) blackPort.textContent = t.blackPort;
            
            // Actualizar instrucciones
            const instructionsTitle = document.querySelector('.instructions-header h5');
            if (instructionsTitle) instructionsTitle.textContent = t.instructionsTitle;
            
            // Actualizar pasos de instrucciones
            const steps = document.querySelectorAll('.instruction-step');
            if (steps.length >= 4) {
                steps[0].querySelector('strong').textContent = t.step1;
                steps[0].querySelector('p').textContent = t.step1Desc;
                steps[1].querySelector('strong').textContent = t.step2;
                steps[1].querySelector('p').textContent = t.step2Desc;
                steps[2].querySelector('strong').textContent = t.step3;
                steps[2].querySelector('p').textContent = t.step3Desc;
                steps[3].querySelector('strong').textContent = t.step4;
                steps[3].querySelector('p').textContent = t.step4Desc;
            }
            
            // Actualizar botón de ocultar explicación
            const hideExplanationText = document.getElementById('hide-explanation-text');
            if (hideExplanationText) hideExplanationText.textContent = t.hideExplanation;
            
            // Actualizar recursos de aprendizaje
            const learningTitle = document.querySelector('.help-buttons-section h4');
            if (learningTitle) learningTitle.textContent = t.learningResources;
            
            // Actualizar botones de ayuda específicos
            const detailedExplanationTitle = document.getElementById('detailed-explanation-title');
            if (detailedExplanationTitle) detailedExplanationTitle.textContent = t.detailedExplanationBtn;
            
            const conceptsTheorySubtitle = document.getElementById('concepts-theory-subtitle');
            if (conceptsTheorySubtitle) conceptsTheorySubtitle.textContent = t.conceptsTheoryBtn;
            
            const technicalGlossaryTitle = document.getElementById('technical-glossary-title');
            if (technicalGlossaryTitle) technicalGlossaryTitle.textContent = t.technicalGlossaryBtn;
            
            const componentsTermsSubtitle = document.getElementById('components-terms-subtitle');
            if (componentsTermsSubtitle) componentsTermsSubtitle.textContent = t.componentsTermsBtn;
            
            const multimeterPartsTitle = document.getElementById('multimeter-parts-title');
            if (multimeterPartsTitle) multimeterPartsTitle.textContent = t.multimeterPartsBtn;
            
            const functionsComponentsSubtitle = document.getElementById('functions-components-subtitle');
            if (functionsComponentsSubtitle) functionsComponentsSubtitle.textContent = t.functionsComponentsBtn;
            
            // Actualizar botones del modal de maestría
            const masteryContinueText = document.getElementById('mastery-continue-text');
            if (masteryContinueText) masteryContinueText.textContent = t.masteryContinueBtn;
            
            const masteryResetText = document.getElementById('mastery-reset-text');
            if (masteryResetText) masteryResetText.textContent = t.masteryResetBtn;
            
            // Actualizar componentes actuales
            const componentsTitle = document.querySelector('h4[style*="gap: 10px"]');
            if (componentsTitle && (componentsTitle.textContent.includes('Componentes') || componentsTitle.textContent.includes('Components'))) {
                componentsTitle.innerHTML = `<span style="font-size: 1.2rem;">🔧</span> ${t.currentComponents}`;
            }
            
            // Actualizar etiquetas de componentes en el panel de información
            setTimeout(() => {
                const batteryLabel = document.querySelector('div[style*="border-left: 4px solid #3498db"] strong');
                if (batteryLabel) batteryLabel.textContent = t.battery;
                
                const resistorLabel = document.querySelector('div[style*="border-left: 4px solid #e67e22"] strong');
                if (resistorLabel) resistorLabel.textContent = t.resistor;
                
                const ledLabel = document.querySelector('div[style*="border-left: 4px solid #3498db"]:nth-of-type(3) strong');
                if (ledLabel) ledLabel.textContent = t.led;
                
                const capacitorLabel = document.querySelector('div[style*="border-left: 4px solid #9b59b6"] strong');
                if (capacitorLabel) capacitorLabel.textContent = t.capacitor;
            }, 100);
            
            // Actualizar consejo de componentes
            const componentTip = document.querySelector('small[style*="color: #2980b9"]');
            if (componentTip) componentTip.textContent = t.componentTip;
            
            // Actualizar guía visual
            const visualGuideTitle = document.getElementById('visual-guide-title');
            if (visualGuideTitle) visualGuideTitle.textContent = t.visualGuide;
            
            const visualGuideText = document.getElementById('visual-guide-text');
            if (visualGuideText) visualGuideText.textContent = t.visualGuideText;
        }

        // Función para actualizar completamente la interfaz
        function updateCompleteInterface() {
            const t = translations[currentLanguage];
            
            console.log('Actualizando interfaz completa al idioma:', currentLanguage);
            
            // Actualizar todos los elementos de texto estático
            const textElements = {
                'main-title': t.mainTitle,
                'main-subtitle': t.mainSubtitle,
                'language-text': currentLanguage === 'es' ? 'English' : 'Español',
                'exercise-label': t.exerciseTitle,
                'objective-label': t.objective,
                'mode-label': t.modeNeeded,
                'connection-label': t.connection,
                'hint-label': t.hint,
                'select-exercise-text': t.selectExercise,
                'verify-text': t.verifyMeasurement,
                'verify-subtitle': t.checkConnection,
                'hold-btn': t.holdButton,
                'auto-btn': t.autoButton,
                'light-btn': t.lightButton,
                'reset-btn': t.resetButton,
                'detailed-explanation-title': t.detailedExplanation,
                'concepts-theory-subtitle': t.conceptsTheory,
                'technical-glossary-title': t.technicalGlossary,
                'components-terms-subtitle': t.componentsTerms,
                'multimeter-parts-title': t.multimeterParts,
                'functions-components-subtitle': t.functionsComponents,
                'hide-explanation-text': t.hideExplanation
            };
            
            // Aplicar traducciones a elementos existentes
            Object.entries(textElements).forEach(([id, text]) => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = text;
                    console.log(`Actualizado ${id}: ${text}`);
                } else {
                    console.log(`Elemento ${id} no encontrado`);
                }
            });
            
            // Actualizar elementos con selectores específicos
            const selectorUpdates = [
                { selector: '.multimeter-section h2', text: t.multimeterTitle },
                { selector: '.multimeter-brand', text: t.multimeterBrand },
                { selector: '.ports-label', text: t.portsLabel },
                { selector: '.probes-label', text: t.probesLabel },
                { selector: '.connection-header h4', text: t.connectionTitle },
                { selector: '.instructions-header h5', text: t.instructionsTitle },
                { selector: '.help-buttons-section h4', text: t.learningResources }
            ];
            
            selectorUpdates.forEach(update => {
                const element = document.querySelector(update.selector);
                if (element) {
                    element.textContent = update.text;
                    console.log(`Actualizado selector ${update.selector}: ${update.text}`);
                }
            });
            
            // Actualizar pasos de instrucciones
            const steps = document.querySelectorAll('.instruction-step');
            if (steps.length >= 4) {
                const stepTexts = [
                    { title: t.step1, desc: t.step1Desc },
                    { title: t.step2, desc: t.step2Desc },
                    { title: t.step3, desc: t.step3Desc },
                    { title: t.step4, desc: t.step4Desc }
                ];
                
                steps.forEach((step, index) => {
                    if (stepTexts[index]) {
                        const strong = step.querySelector('strong');
                        const p = step.querySelector('p');
                        if (strong) {
                            strong.textContent = stepTexts[index].title;
                            console.log(`Paso ${index + 1} título: ${stepTexts[index].title}`);
                        }
                        if (p) {
                            p.textContent = stepTexts[index].desc;
                            console.log(`Paso ${index + 1} descripción: ${stepTexts[index].desc}`);
                        }
                    }
                });
            }
            
            // Actualizar información de puntas con múltiples estrategias
            const probeUpdates = [
                { selector: '.red-probe-card h5', text: t.redProbe },
                { selector: '.black-probe-card h5', text: t.blackProbe },
                { selector: '.red-probe-card .probe-port', text: t.redPort },
                { selector: '.black-probe-card .probe-port', text: t.blackPort }
            ];
            
            probeUpdates.forEach(update => {
                const element = document.querySelector(update.selector);
                if (element) {
                    element.textContent = update.text;
                    console.log(`Actualizado ${update.selector}: ${update.text}`);
                }
            });
            
            // Actualizar estado de conexión
            const connectionBadge = document.getElementById('connection-badge');
            if (connectionBadge) {
                const statusText = connectionBadge.querySelector('.status-text');
                if (statusText) {
                    // Determinar el estado actual y aplicar la traducción correcta
                    if (probeConnections.red && probeConnections.black) {
                        statusText.textContent = t.fullyConnected;
                    } else if (probeConnections.red || probeConnections.black) {
                        statusText.textContent = t.partiallyConnected;
                    } else {
                        statusText.textContent = t.disconnected;
                    }
                }
            }
            
            // Actualizar tooltips
            updateTooltips();
            
            // Actualizar modales
            updateModalTexts();
            
            // Actualizar componentes actuales y otros elementos dinámicos
            setTimeout(() => {
                // Buscar título de componentes por múltiples estrategias
                const componentsTitleSelectors = [
                    'h4[style*="gap: 10px"]',
                    '.component-info h4',
                    'h4:contains("Componentes")',
                    'h4:contains("Components")'
                ];
                
                let componentsTitle = null;
                for (const selector of componentsTitleSelectors) {
                    componentsTitle = document.querySelector(selector);
                    if (componentsTitle && (componentsTitle.textContent.includes('Componentes') || componentsTitle.textContent.includes('Components'))) {
                        break;
                    }
                }
                
                if (componentsTitle) {
                    componentsTitle.innerHTML = `<span style="font-size: 1.2rem;">🔧</span> ${t.currentComponents}`;
                    console.log(`Título de componentes actualizado: ${t.currentComponents}`);
                }
                
                // Actualizar consejo de componentes
                const componentTip = document.querySelector('small[style*="color: #2980b9"]');
                if (componentTip) {
                    componentTip.textContent = t.componentTip;
                    console.log(`Consejo de componentes actualizado: ${t.componentTip}`);
                }
                
                // Actualizar etiquetas de componentes individuales
                const componentLabels = document.querySelectorAll('strong[style*="color: #2c3e50"]');
                componentLabels.forEach(label => {
                    const text = label.textContent.trim();
                    if (text.includes('Batería') || text.includes('Battery')) {
                        label.textContent = t.battery;
                    } else if (text.includes('Resistor')) {
                        label.textContent = t.resistor;
                    } else if (text.includes('LED')) {
                        label.textContent = t.led;
                    } else if (text.includes('Condensador') || text.includes('Capacitor')) {
                        label.textContent = t.capacitor;
                    }
                });
                
                // Actualizar guía visual
                const visualGuideElements = document.querySelectorAll('.guide-text strong');
                visualGuideElements.forEach(element => {
                    if (element.textContent.includes('Guía Visual') || element.textContent.includes('Visual Guide')) {
                        element.textContent = t.visualGuide;
                    }
                });
                
                const visualGuideText = document.querySelector('.guide-text');
                if (visualGuideText && !visualGuideText.querySelector('strong')) {
                    const text = visualGuideText.textContent;
                    if (text.includes('puntos de medición') || text.includes('measurement points')) {
                        visualGuideText.textContent = t.visualGuideText;
                    }
                }
                
            }, 100);
        }

        // Inicializar la aplicación
        document.addEventListener('DOMContentLoaded', function() {
            loadExercise();
            updateComponentInfo();
            updateCompleteInterface(); // Asegurar que el idioma esté configurado correctamente
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98b034cc121ddc07',t:'MTc1OTg2OTU0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
